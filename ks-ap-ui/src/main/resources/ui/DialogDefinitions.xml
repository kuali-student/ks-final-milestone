<?xml version="1.0" encoding="UTF-8"?>
<!--
Copyright 2007-2009 The Kuali Foundation

Licensed under the Educational Community License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.opensource.org/licenses/ecl2.php

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <!-- ################################ Dialog Pages ############################ -->

    <!-- Base View Bean for all Dialogs-->
    <bean id="PlannedCourse-FormView" parent="PlannedCourse-FormView-parent"/>
    <bean id="PlannedCourse-FormView-parent" abstract="true" parent="MyPlanBaseFormView">
        <property name="id" value="PlannedCourse-FormView"/>
        <property name="entryPageId" value="add_remove_course_popover_page"/>
        <property name="formClass" value="org.kuali.student.myplan.plan.form.PlanForm"/>
        <property name="footer.render" value="false"/>
        <property name="header.render" value="false"/>
        <property name="cssClasses">
            <list merge="true">
                <value>myplan-view</value>
            </list>
        </property>
        <property name="items">
            <list>
                <!-- This page builds the popover with the 3 sliding sections used to view course summary, add to plan and remove from courses list contextually -->
                <ref bean="add_remove_course_popover_page"/>

                <!-- This page contains return status and feedback messages for actions on plan items -->
                <ref bean="plan_action_response_page"/>

                <!--This page is used for the View Course Summary Dialog box -->
                <ref bean="course_summary_dialog_page"/>

                <!-- This page is used for the course add Dialog box-->
                <ref bean="add_dialog_page"/>

                <!--This page is used for the quick add Dialog box -->
                <ref bean="plan_item_add_page"/>

                <!--This page is used for the Move to another quarter Dialog box -->
                <ref bean="move_dialog_page"/>

                <!--This page is used for the Copy to another quarter Dialog box -->
                <ref bean="copy_dialog_page"/>

                <!--This page is used for the Delete plan Item Dialog box -->
                <ref bean="plan_item_delete_page"/>

                <!-- This page is used for editing a plan item -->
                <ref bean="plan_item_edit_page"/>

                <!-- This page is used for editing a term note -->
                <ref bean="term_note_edit_page"/>

            </list>
        </property>
    </bean>

    <!--View Course Summary Dialog Box content -->
    <bean id="course_summary_dialog_page" parent="course_summary_dialog_page-parent"/>
    <bean id="course_summary_dialog_page-parent" abstract="true" parent="KSAP-PopoverPage" p:id="course_summary_dialog_page" p:headerText="View Course Summary">
        <property name="cssClasses">
            <list merge="true">
                <value>@{atpId.replaceAll("\.","-")}</value>
            </list>
        </property>
        <property name="items">
            <list>
                <bean parent="course_title_link"/>
                <bean parent="course_details_summary_info"/>
            </list>
        </property>
        <property name="footer">
            <ref bean="course_details_summary_messages"/>
        </property>
    </bean>

    <!-- Adding courses to the Plan using the quick add -->
    <bean id="plan_item_add_page" parent="plan_item_add_page-parent" p:id="plan_item_add_page" />
    <bean parent="KSAP-PopoverPage" abstract="true" id="plan_item_add_page-parent"
          p:headerText="@{#form.planItemId EQ null ? 'What would you like to add to ':'Edit your course for '} @{#form.termName}@{#form.planItemId EQ null ? '?' : ''}"
          p:width="325px">
        <property name="cssClasses">
            <list merge="true">
                <value>@{atpId.replaceAll("\.","-")}-@{#form.backup ? 'backup' : 'planned'}</value>
            </list>
        </property>
        <property name="items">
            <list>
                <bean parent="KSAP-VerticalBoxGroup">
                    <property name="cssClasses">
                        <list merge="true">
                            <value>myplan-remove-margin</value>
                        </list>
                    </property>
                    <property name="items">
                        <list>
                            <bean parent="KSAP-HorizontalBoxGroup" p:id="courseOptions">
                                <property name="items">
                                    <list>
										<bean parent="Uif-Message" p:messageText="Enter the course code"></bean>
                                        <bean parent="Uif-InputField" p:propertyName="courseCd"
                                              p:id="courseCode_@{atpId.replaceAll('\.','-')}-@{#form.backup ? 'backup' : 'planned'}" p:width="70%">
                                            <property name="control">
                                                <bean parent="Uif-TextControl" p:style="width:180px;">
                                                    <property name="onDocumentReadyScript"
                                                              value="jQuery('#courseCode_@{atpId.replaceAll('\.','-')}-@{#form.backup ? 'backup' : 'planned'}_control').focus();"/>
                                                    <property name="watermarkText" value="e.g. MATH-M 119"/>
                                                    <property name="maxLength" value="10"/>
                                                </bean>
                                            </property>
                                        </bean>
                                        <bean parent="Uif-InputField" p:id="courseCreditsNew_@{atpId.replaceAll('\.','-')}-@{#form.backup ? 'backup' : 'planned'}">
                                            <property name="label" value="Enter Course Credits"/>
                                            <property name="instructionalText" value="Empty and invalid values will default to the minimum credit value."/>
                                            <property name="fieldLabel.render" value="true"/>
                                            <property name="fieldLabel.cssClasses">
                                                <list merge="true">
                                                    <value>myplan-text-normal</value>
                                                </list>
                                            </property>
                                            <property name="propertyName" value="fakeCourseCredit"/>
                                            <property name="defaultValue" value="@{#form.courseCredit NE null ? #form.courseCredit : ''}"/>
                                            <property name="control">
                                                <bean parent="Uif-TextControl">
                                                    <property name="size" value="3"/>
                                                </bean>
                                            </property>
                                        </bean>
                                        <bean parent="planItemNote" p:id="courseNoteNew_@{atpId.replaceAll('\.','-')}-@{#form.backup ? 'backup' : 'planned'}"/>
                                    </list>
                                </property>
                            </bean>
                        </list>
                    </property>
                </bean>
                <bean parent="KSAP-SimpleInputField" p:propertyName="planItemId"
                      p:hidden="true" p:render="@{#form.planItemId NE null}">
                    <property name="control">
                        <bean parent="Uif-HiddenControl"/>
                    </property>
                </bean>
                <bean parent="KSAP-VerticalBoxGroup-NoMargin" p:id="actionButtonsGroup">
                    <property name="items">
                        <list>
                            <bean parent="KSAP-HorizontalBoxGroup-NoMargin">
                                <property name="items">
                                    <list>
                                        <bean id="actionCoursePlaceholder" p:id="actionCoursePlaceholder"
                                              parent="Uif-PrimaryActionButton-Small"
                                              p:actionLabel="@{#form.planItemId EQ null ? 'Add to Plan':'Save'}">
                                            <property name="actionScript" value="
                                                var newNote = jQuery('#courseNoteNew_@{atpId.replaceAll('\.','-')}_control').val();
                                                var newCredit = jQuery('#courseCreditsNew_@{atpId.replaceAll('\.','-')}_control').val();
                                                var additionalFormData = {
                                                    viewId: 'PlannedCourse-FormView',
                                                    methodToCall: 'addUpdatePlanItem',
                                                    atpId: '@{#form.atpId}',
                                                    backup: @{#form.backup},
                                                    pageId: 'plan_item_add_page',
                                                    courseCredit: newCredit,
                                                    courseNote: newNote
                                                };
                                                submitPopupForm(additionalFormData, e, false);
                                            "/>
                                            <property name="onDocumentReadyScript" value="
                                                jQuery('#actionCoursePlaceholder').on('PLAN_ITEM_ADDED PLAN_ITEM_UPDATED', function(event, data){
                                                    fnCloseAllPopups();
                                                }).on('ERROR', function(event, data){
                                                    fnDisplayMessage(data.message, data.cssClass, 'errorPlaceholder', true, false,true,'errorPlaceholder');
                                                });
                                            "/>
                                        </bean>
                                        <bean parent="closePopoverCancel"/>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="errorPlaceholder"/>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <!--Delete confirmation Dialog Box content -->
    <bean id="plan_item_delete_page" parent="plan_item_delete_page-parent"/>
    <bean id="plan_item_delete_page-parent" abstract="true" parent="KSAP-PopoverPage" p:id="plan_item_delete_page"
          p:headerText="Delete @{courseSummaryDetails.code} @{atpId eq null ? 'Bookmark' : 'from the '+shortTerm+' Plan'}">
        <property name="cssClasses">
            <list merge="true">
                <value>@{planItemIdXmlSafe}</value>
            </list>
        </property>
        <property name="items">
            <list>
               <ref bean="plan_item_delete_dialog"/>
            </list>
        </property>
    </bean>
    <bean id="plan_item_delete_dialog" parent="Uif-VerticalBoxSection" p:headerText="Delete From Plan"
          p:style="margin:0;">
        <property name="header">
            <bean parent="Uif-HeaderSix"/>
        </property>
        <property name="items">
            <list>
                <bean parent="Uif-Message" p:cssClasses="ks-Popover-bodyLabel"
                      p:messageText="Are you sure that you want to delete &lt;strong&gt;@{courseSummaryDetails.code}&lt;/strong&gt;? Once deleted, you cannot undo."/>
                <bean parent="KSAP-HorizontalBoxGroup"
                      p:render="@{planActivities ne null AND planActivities.size() gt 0}">
                    <property name="cssClasses">
                        <list merge="true">
                            <value>myplan-status</value>
                            <value>info</value>
                        </list>
                    </property>
                    <property name="items">
                        <list>
                            <bean parent="MyPlanMessagingIcon"/>
                            <bean parent="Uif-DataField" p:propertyName="planActivities"
                                  p:escapeHtmlInPropertyValue="false"
                                  p:render="@{planActivities ne null ? true : false}">
                                <property name="propertyEditor" ref="planned_sections_formatter"/>
                            </bean>
                        </list>
                    </property>
                </bean>
                <bean parent="KSAP-HorizontalBoxGroup">
                    <property name="items">
                        <list>
                            <bean p:id="deletePlannedCourse_@{planItemIdXmlSafe}" parent="Uif-PrimaryActionButton-Small"
                              p:actionLabel="Delete" p:additionalCssClasses="ks-Button ks-Button--primary">
                                <property name="actionScript" value="
                                                var additionalFormData = {
                                                    viewId: 'PlannedCourse-FormView',
                                                    methodToCall: 'removeItem',
                                                    planItemId: '@{planItemIdXmlSafe}',
                                                    atpId: '@{atpId}'
                                                };
                                                submitPopupForm(additionalFormData, e, false);
                                            "/>
                                <property name="onDocumentReadyScript" value="
                                                jQuery('#deletePlannedCourse_@{planItemIdXmlSafe}').on('PLAN_ITEM_DELETED', function(event, data){
                                                    fnDisplayMessage(data.message, data.cssClass, 'deletePlannedCourse_@{planItemIdXmlSafe}', true, true);
                                                }).on('ERROR', function(event, data) {
                                                    fnDisplayMessage(data.message, data.cssClass, 'deletePlannedCourse_@{planItemIdXmlSafe}', true, true);
                                                });
                                            "/>
                            </bean>
                            <bean parent="closePopoverCancel" p:id="closePopoverCancel_delete_@{planItemIdXmlSafe}"/>
                        </list>
                    </property>
                </bean>
            </list>

        </property>
    </bean>

    <!--Move Course to another Quarter Dialog Box Content-->
    <bean id="move_dialog_page" parent="move_dialog_page-parent"/>
    <bean id="move_dialog_page-parent" abstract="true" parent="KSAP-PopoverPage" p:id="move_dialog_page" p:headerText="Move to Another Quarter">
        <property name="cssClasses">
            <list merge="true">
                <value>@{planItemIdXmlSafe}</value>
            </list>
        </property>
        <property name="items">
            <list>
                <bean parent="Uif-Message" p:cssClasses="ks-Popover-bodyLabel"
                      p:messageText="Which quarter would you like to move &lt;strong&gt;@{courseSummaryDetails.code}&lt;/strong&gt; to?"/>

                <bean parent="Uif-DataField" p:propertyName="courseSummaryDetails.scheduledTermsNames"
                      p:label="Scheduled For"
                      p:fieldLabel.cssClasses="fl-text-gray fl-font-size-90 myplan-text-normal ks-Popover-itemLabel"
                      p:labelPlacement="LEFT">
                    <property name="cssClasses">
                        <list merge="true">
                            <value>myplan-data-list</value>
                            <value>ks-Popover-item</value>
                        </list>
                    </property>
                </bean>

                <bean parent="Uif-HorizontalFieldGroup" p:cssClasses="ks-Popover-item"
                      p:label="Quarter &amp; Year" p:labelPlacement="TOP">
                    <property name="fieldLabel.cssClasses" value="myplan-text-normal ks-Popover-itemLabel"/>
                    <property name="items">
                        <list>
                            <bean p:id="atpIdMove_@{atpId.replaceAll('\.','-')}_@{courseSummaryDetails.courseIdXmlSafe}" parent="KSAP-SimpleInputField" p:propertyName="fakeAtpId">
                                <property name="control">
                                    <bean parent="Uif-DropdownControl"/>
                                </property>
                                <property name="optionsFinder">
                                    <bean class="org.kuali.student.myplan.plan.util.TermsListBuilder"/>
                                </property>
                            </bean>
                            <bean parent="KSAP-Message"
                                  p:messageText="Note: This course MAY NOT be offered in your selected quarter. Check back after the Time Schedule is released.">
                                <property name="cssClasses">
                                    <list merge="true">
                                        <value>fl-font-size-80</value>
                                        <value>fl-text-gray</value>
                                        <value>ks-Popover-note</value>
                                    </list>
                                </property>
                            </bean>
                        </list>
                    </property>
                </bean>

                <bean parent="KSAP-HorizontalBoxGroup"
                      p:render="@{planActivities ne null AND planActivities.size() gt 0}">
                    <property name="cssClasses">
                        <list merge="true">
                            <value>myplan-status</value>
                            <value>info</value>
                        </list>
                    </property>
                    <property name="items">
                        <list>
                            <bean parent="MyPlanMessagingIcon"/>
                            <bean parent="Uif-DataField" p:propertyName="planActivities"
                                  p:escapeHtmlInPropertyValue="false"
                                  p:render="@{planActivities ne null ? true : false}">
                                <property name="propertyEditor" ref="planned_sections_formatter"/>
                            </bean>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
        <property name="footer">
                <bean parent="KSAP-VerticalBoxGroup-NoMargin" p:id="actionButtonsGroup">
                    <property name="items">
                        <list>
                            <bean parent="KSAP-HorizontalBoxGroup-NoMargin">
                                <property name="items">
                                    <list>
                                        <bean p:id="movePlannedCourse"
                                              parent="Uif-PrimaryActionButton-Small"
                                          p:actionLabel="Move" p:additionalCssClasses="ks-Button ks-Button--primary">
                                            <property name="actionScript" value="
                                                            var newAtpId = jQuery('#atpIdMove_@{atpId.replaceAll('\.','-')}_@{courseSummaryDetails.courseIdXmlSafe}_control').val();
                                                            var additionalFormData = {viewId:'PlannedCourse-FormView', methodToCall:'movePlanCourse', planItemId:'@{planItemIdXmlSafe}',atpId:newAtpId};
                                                            submitPopupForm(additionalFormData, e, false);
                                                        "/>
                                            <property name="onDocumentReadyScript" value="
                                                            jQuery('#movePlannedCourse').on('PLAN_ITEM_ADDED', function(event, data){
                                                                if (data.planItemType === 'planned' || data.planItemType === 'backup') {
                                                                    fnDisplayMessage(data.message, data.cssClass, 'actionButtonsGroup', true, false);
                                                                }
                                                            }).on('ERROR', function(event, data){
                                                                fnDisplayMessage(data.message, data.cssClass, 'errorPlaceholder', true, false,true, 'errorPlaceholder');
                                                            });
                                                        "/>
                                        </bean>
                                        <bean parent="closePopoverCancel"/>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="errorPlaceholder"/>
                        </list>
                    </property>
                </bean>
        </property>
    </bean>

    <!--Copy Course to another Quarter Dialog Box Content-->
    <bean id="copy_dialog_page" parent="copy_dialog_page-parent"/>
    <bean id="copy_dialog_page-parent" abstract="true" parent="KSAP-PopoverPage" p:id="copy_dialog_page" p:headerText="Copy to Another Quarter">
        <property name="cssClasses">
            <list merge="true">
                <value>@{planItemIdXmlSafe}</value>
            </list>
        </property>
        <property name="items">
            <list>
                <bean parent="Uif-Message" p:cssClasses="ks-Popover-bodyLabel"
                      p:messageText="Which quarter would you like to copy &lt;strong&gt;@{courseSummaryDetails.code}&lt;/strong&gt; to?"/>

                <bean parent="Uif-DataField" p:propertyName="courseSummaryDetails.scheduledTermsNames"
                      p:label="Scheduled For"
                      p:fieldLabel.cssClasses="fl-text-gray fl-font-size-90 myplan-text-normal ks-Popover-itemLabel"
                      p:labelPlacement="LEFT">
                    <property name="cssClasses">
                        <list merge="true">
                            <value>myplan-data-list</value>
                            <value>ks-Popover-item</value>
                        </list>
                    </property>
                </bean>

                <bean parent="Uif-HorizontalFieldGroup" p:cssClasses="ks-Popover-item"
                      p:label="Quarter &amp; Year" p:labelPlacement="TOP">
                    <property name="fieldLabel.cssClasses" value="myplan-text-normal ks-Popover-itemLabel"/>
                    <property name="items">
                        <list>
                            <bean p:id="atpIdCopy_@{atpId.replaceAll('\.','-')}_@{courseSummaryDetails.courseIdXmlSafe}" parent="KSAP-SimpleInputField" p:propertyName="fakeAtpId">
                                <property name="control">
                                    <bean parent="Uif-DropdownControl"/>
                                </property>
                                <property name="optionsFinder">
                                    <bean class="org.kuali.student.myplan.plan.util.TermsListBuilder"/>
                                </property>
                            </bean>
                            <bean parent="KSAP-Message"
                                  p:messageText="Note: This course MAY NOT be offered in your selected quarter. Check back after the Time Schedule is released.">
                                <property name="cssClasses">
                                    <list merge="true">
                                        <value>fl-font-size-80</value>
                                        <value>fl-text-gray</value>
                                        <value>ks-Popover-note</value>
                                    </list>
                                </property>
                            </bean>
                        </list>
                    </property>
                </bean>

                <bean parent="KSAP-HorizontalBoxGroup"
                      p:render="@{planActivities ne null AND planActivities.size() gt 0}">
                    <property name="cssClasses">
                        <list merge="true">
                            <value>myplan-status</value>
                            <value>info</value>
                        </list>
                    </property>
                    <property name="items">
                        <list>
                            <bean parent="MyPlanMessagingIcon"/>
                            <bean parent="Uif-DataField" p:propertyName="planActivities"
                                  p:escapeHtmlInPropertyValue="false"
                                  p:render="@{planActivities ne null ? true : false}">
                                <property name="propertyEditor" ref="planned_sections_formatter"/>
                            </bean>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
        <property name="footer">
                <bean parent="KSAP-VerticalBoxGroup-NoMargin" p:id="actionButtonsGroup">
                    <property name="items">
                        <list>
                            <bean parent="KSAP-HorizontalBoxGroup-NoMargin">
                                <property name="items">
                                    <list>
                                        <bean p:id="copyPlannedCourse"
                                              parent="Uif-PrimaryActionButton-Small"
                                              p:render="@{setToPlanning}"
                                          p:actionLabel="Copy" p:additionalCssClasses="ks-Button ks-Button--primary">
                                            <property name="actionScript" value="
                                                            var newAtpId = jQuery('#atpIdCopy_@{atpId.replaceAll('\.','-')}_@{courseSummaryDetails.courseIdXmlSafe}_control').val();
                                                            var additionalFormData = {viewId:'PlannedCourse-FormView', methodToCall:'copyPlanCourse', planItemId:'@{planItemIdXmlSafe}',atpId:newAtpId};
                                                            submitPopupForm(additionalFormData, e, false);
                                                        "/>
                                            <property name="onDocumentReadyScript" value="
                                                            jQuery('#copyPlannedCourse').on('PLAN_ITEM_ADDED', function(event, data){
                                                                if (data.planItemType === 'planned' || data.planItemType === 'backup') {
                                                                    fnDisplayMessage(data.message, data.cssClass, 'actionButtonsGroup', true, false);
                                                                }
                                                            }).on('ERROR', function(event, data){
                                                                fnDisplayMessage(data.message, data.cssClass, 'errorPlaceholder', true, false,true, 'errorPlaceholder');
                                                            });
                                                        "/>
                                        </bean>
                                        <bean p:id="copyPastPlannedCourse"
                                              parent="Uif-PrimaryActionButton-Small"
                                              p:render="@{setToPlanning eq false and planItemId ne null}"
                                          p:actionLabel="Copy" p:additionalCssClasses="ks-Button ks-Button--primary">
                                            <property name="actionScript" value="
                                                            var newAtpId = jQuery('#atpIdCopy_@{atpId.replaceAll('\.','-')}_@{courseSummaryDetails.courseIdXmlSafe}_control').val();
                                                            var additionalFormData = {viewId:'PlannedCourse-FormView', methodToCall:'copyPlanCourse', planItemId:'@{planItemIdXmlSafe}',atpId:newAtpId};
                                                            submitPopupForm(additionalFormData, e, false);
                                                        "/>
                                            <property name="onDocumentReadyScript" value="
                                                            jQuery('#copyPastPlannedCourse').on('PLAN_ITEM_ADDED', function(event, data){
                                                                if (data.planItemType === 'planned' || data.planItemType === 'backup') {
                                                                    fnDisplayMessage(data.message, data.cssClass, 'actionButtonsGroup', true, false);
                                                                }
                                                            }).on('ERROR', function(event, data){
                                                                fnDisplayMessage(data.message, data.cssClass, 'errorPlaceholder', true, false,true, 'errorPlaceholder');
                                                            });
                                                        "/>
                                        </bean>
                                        <bean p:id="copyAcademicCourse"
                                              parent="Uif-PrimaryActionButton-Small"
                                              p:render="@{setToPlanning eq false and planItemId eq null}"
                                              p:actionLabel="Copy">
                                            <property name="actionScript" value="
                                                            var additionalFormData = {viewId:'PlannedCourse-FormView', methodToCall:'copyPlanCourse', courseId:'@{courseIdXmlSafe}'};
                                                            submitPopupForm(additionalFormData, e, false);
                                                        "/>
                                            <property name="onDocumentReadyScript" value="
                                                            jQuery('#copyAcademicCourse').on('PLAN_ITEM_ADDED', function(event, data){
                                                                if (data.planItemType === 'planned' || data.planItemType === 'backup') {
                                                                    fnDisplayMessage(data.message, data.cssClass, 'actionButtonsGroup', true, false);
                                                                }
                                                            }).on('ERROR', function(event, data){
                                                                fnDisplayMessage(data.message, data.cssClass, 'errorPlaceholder', true, false,true, 'errorPlaceholder');
                                                            });
                                                        "/>
                                        </bean>
                                        <bean parent="closePopoverCancel"/>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="errorPlaceholder"/>
                        </list>
                    </property>
                </bean>
        </property>
    </bean>

    <!--Edit plan item Dialog Box content -->
    <bean id="plan_item_edit_page" parent="plan_item_edit_page-parent"/>
    <bean id="plan_item_edit_page-parent" abstract="true" parent="KSAP-PopoverPage" p:id="plan_item_edit_page"
          p:headerText="Edit @{courseSummaryDetails.code} @{atpId eq null ? 'Bookmark' : 'from the '+shortTerm+' Plan'}">
        <property name="cssClasses">
            <list merge="true">
                <value>@{planItemIdXmlSafe}</value>
            </list>
        </property>
        <property name="items">
            <list>
                <bean parent="Uif-Message"
                      p:messageText="Edit @{courseSummaryDetails.code} @{atpId eq null ? 'Bookmark' : 'from the '+shortTerm+' Plan'}"/>
                <bean parent="Uif-InputField" p:id="courseCredits_@{atpId.replaceAll('\.','-')}_@{courseSummaryDetails.courseIdXmlSafe}">
                    <property name="cssClasses" value="ks-Popover-item ks-Popover-item--divideAfter"/>
                    <property name="label" value="Enter Course Credits"/>
                    <property name="fieldLabel.render" value="true"/>
                    <property name="fieldLabel.cssClasses">
                        <list merge="true">
                            <value>myplan-text-normal</value>
                            <value>ks-Popover-itemLabel</value>
                        </list>
                    </property>
                    <property name="propertyName" value="fakeCourseCredit"/>
                    <property name="defaultValue" value="@{#form.courseCredit NE null ? #form.courseCredit : ''}"/>
                    <property name="instructionalText" value="Empty and invalid values will default to the minimum credit value."/>
                    <property name="control">
                        <bean parent="Uif-TextControl">
                            <property name="size" value="3"/>
                        </bean>
                    </property>
                </bean>
                <bean parent="planItemNote" p:id="courseNote_@{atpId.replaceAll('\.','-')}_@{courseSummaryDetails.courseIdXmlSafe}"/>
            </list>
        </property>
        <property name="footer">
            <bean parent="KSAP-HorizontalBoxGroup" p:additionalCssClasses="ks-Popover-footer">
                    <property name="items">
                        <list>
                            <bean p:id="editPlannedCourse" parent="Uif-PrimaryActionButton-Small"
                                  p:actionLabel="Save">
                            <property name="additionalCssClasses" value="ks-Button ks-Button--primary"/>
                                <property name="actionScript" value="
                                                var newNote = jQuery('#courseNote_@{atpId.replaceAll('\.','-')}_@{courseSummaryDetails.courseIdXmlSafe}_control').val();
                                                var newCredit = jQuery('#courseCredits_@{atpId.replaceAll('\.','-')}_@{courseSummaryDetails.courseIdXmlSafe}_control').val();
                                                var additionalFormData = {
                                                    viewId: 'PlannedCourse-FormView',
                                                    methodToCall: 'editPlanCourse',
                                                    planItemId: '@{planItemIdXmlSafe}',
                                                    atpId: '@{atpId}',
                                                    courseNote: newNote,
                                                    courseCredit: newCredit
                                                };
                                                submitPopupForm(additionalFormData, e, false);
                                            "/>
                                <property name="onDocumentReadyScript" value="
                                                jQuery('#editPlannedCourse').on('PLAN_NOTE_UPDATED', function(event, data){
                                                    fnDisplayMessage(data.message, data.cssClass, 'editPlannedCourse', true, true);
                                                }).on('ERROR', function(event, data) {
                                                    fnDisplayMessage(data.message, data.cssClass, 'editPlannedCourse', true, true);
                                                });
                                            "/>
                            </bean>
                            <bean parent="closePopoverCancel"/>
                        </list>
                    </property>
                </bean>
        </property>
    </bean>

    <!--Edit plan item Dialog Box content -->
    <bean id="term_note_edit_page" parent="term_note_edit_page-parent"/>
    <bean id="term_note_edit_page-parent" abstract="true" parent="KSAP-PopoverPage" p:id="term_note_edit_page"
          p:headerText="Edit @{shortTerm} Term Note">
        <property name="cssClasses">
            <list merge="true">
                <value>@{atpId.replaceAll("\.","-")}</value>
            </list>
        </property>
        <property name="items">
            <list>

                <bean parent="planItemNote" p:id="termNote_@{atpId.replaceAll('\.','-')}" p:propertyName="fakeTermNote"
                      p:defaultValue="@{#form.atpId NE null ? #form.termNote : ''}">
                    <property name="label" value="Edit note for the term"/>

                </bean>
            </list>
        </property>
        <property name="footer">
            <bean parent="KSAP-HorizontalBoxGroup" p:additionalCssClasses="ks-Popover-footer">
                    <property name="items">
                        <list>
                            <bean p:id="editTermNote" parent="Uif-PrimaryActionButton-Small"
                              p:actionLabel="Save" p:additionalCssClasses="ks-Button ks-Button--primary">
                                <property name="actionScript" value="
                                                var newNote = jQuery('#termNote_@{atpId.replaceAll('\.','-')}_control').val();
                                                var additionalFormData = {
                                                    viewId: 'PlannedCourse-FormView',
                                                    methodToCall: 'editTermNote',
                                                    atpId: '@{atpId}',
                                                    termNote: newNote
                                                };
                                                submitPopupForm(additionalFormData, e, false);
                                            "/>
                                <property name="onDocumentReadyScript" value="
                                                jQuery('#editTermNote').on('TERM_NOTE_UPDATED', function(event, data){
                                                    fnDisplayMessage(data.message, data.cssClass, 'editTermNote', true, true);
                                                }).on('ERROR', function(event, data) {
                                                    fnDisplayMessage(data.message, data.cssClass, 'editTermNote', true, true);
                                                });
                                            "/>
                            </bean>
                            <bean parent="closePopoverCancel"/>
                        </list>
                    </property>
                </bean>
        </property>
    </bean>

    <!-- Adding courses to the Plan -->
    <bean id="add_dialog_page" parent="add_dialog_page-parent"/>
    <bean id="add_dialog_page-parent" abstract="true" parent="KSAP-PopoverPage" p:id="add_dialog_page">
        <property name="cssClasses">
            <list merge="true">
                <value>fl-container-300</value>
                <value>@{courseSummaryDetails.courseIdXmlSafe}</value>
            </list>
        </property>
        <property name="items">
            <list>
                <ref bean="course_add_dialog"/>
            </list>
        </property>
    </bean>
    <bean id="course_add_dialog" parent="Uif-VerticalBoxSection" p:headerText="Add to Plan"
          p:style="margin:0;">
        <property name="header">
            <bean parent="Uif-HeaderSix"/>
        </property>
        <property name="items">
            <list>
                <bean parent="KSAP-VerticalBoxGroup">
                    <property name="cssClasses">
                        <list merge="true">
                            <value>myplan-remove-margin</value>
                            <value>fl-container-300</value>
                        </list>
                    </property>
                    <property name="items">
                        <list>
                            <bean parent="KSAP-HorizontalBoxGroup" p:id="courseOptions">
                                <property name="items">
                                    <list>

                                        <bean parent="Uif-Message"
                                              p:messageText="Which quarter would you like to copy &lt;strong&gt;@{courseSummaryDetails.code}&lt;/strong&gt; to?"/>

                                        <bean parent="Uif-DataField" p:propertyName="courseSummaryDetails.scheduledTermsNames"
                                              p:label="Scheduled For"
                                              p:fieldLabel.cssClasses="fl-text-gray fl-font-size-90 myplan-text-normal"
                                              p:labelPlacement="LEFT">
                                            <property name="cssClasses">
                                                <list merge="true">
                                                    <value>myplan-data-list</value>
                                                </list>
                                            </property>
                                        </bean>

                                        <bean parent="Uif-HorizontalFieldGroup"
                                              p:label="Quarter &amp; Year" p:labelPlacement="TOP">
                                            <property name="fieldLabel.cssClasses" value="myplan-text-normal"/>
                                            <property name="items">
                                                <list>
                                                    <bean p:id="courseAtpNew_@{courseSummaryDetails.courseIdXmlSafe}" parent="KSAP-SimpleInputField" p:propertyName="fakeAtpId">
                                                        <property name="control">
                                                            <bean parent="Uif-DropdownControl"/>
                                                        </property>
                                                        <property name="optionsFinder">
                                                            <bean class="org.kuali.student.myplan.plan.util.TermsListBuilder"/>
                                                        </property>
                                                    </bean>
                                                    <bean parent="KSAP-Message"
                                                          p:messageText="Note: This course MAY NOT be offered in your selected quarter. Check back after the Time Schedule is released.">
                                                        <property name="cssClasses">
                                                            <list merge="true">
                                                                <value>fl-font-size-80</value>
                                                                <value>fl-text-gray</value>
                                                            </list>
                                                        </property>
                                                    </bean>
                                                </list>
                                            </property>
                                        </bean>

                                        <!--  Backup checkbox -->
                                        <bean parent="Uif-InputField" p:propertyName="fakeBackup" p:defaultValue="false"
                                              p:label="Mark as &lt;strong&gt;'Backup'&lt;/strong&gt; course. (Optional)"
                                              p:labelPlacement="RIGHT">
                                            <property name="id" value="courseBackupNew_@{courseSummaryDetails.courseIdXmlSafe}"/>
                                            <property name="fieldLabel.cssClasses" value="myplan-text-normal"/>
                                            <property name="fieldLabel.renderColon" value="false"/>
                                            <property name="control">
                                                <bean parent="Uif-CheckboxControl"/>
                                            </property>
                                        </bean>

                                        <bean parent="Uif-InputField" p:id="courseCreditsNew_@{courseSummaryDetails.courseIdXmlSafe}">
                                            <property name="label" value="Enter Course Credits"/>
                                            <property name="instructionalText" value="Empty and invalid values will default to the minimum credit value."/>
                                            <property name="fieldLabel.render" value="true"/>
                                            <property name="fieldLabel.cssClasses">
                                                <list merge="true">
                                                    <value>myplan-text-normal</value>
                                                </list>
                                            </property>
                                            <property name="propertyName" value="fakeCourseCredit"/>
                                            <property name="defaultValue" value="@{#form.courseCredit NE null ? #form.courseCredit : ''}"/>
                                            <property name="control">
                                                <bean parent="Uif-TextControl">
                                                    <property name="size" value="3"/>
                                                </bean>
                                            </property>
                                        </bean>
                                        <bean parent="planItemNote" p:id="courseNoteNew_@{courseSummaryDetails.courseIdXmlSafe}"/>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="KSAP-VerticalBoxGroup-NoMargin" p:id="actionButtonsGroup">
                                <property name="items">
                                    <list>
                                        <bean parent="KSAP-HorizontalBoxGroup-NoMargin">
                                            <property name="items">
                                                <list>
                                                    <bean p:id="actionCoursePlaceholder"
                                                          parent="Uif-PrimaryActionButton-Small"
                                                          p:actionLabel="Add to Plan">
                                                        <property name="actionScript" value="
                                                                        var newNote = jQuery('#courseNoteNew_@{courseSummaryDetails.courseIdXmlSafe}_control').val();
                                                                        var newCredit = jQuery('#courseCreditsNew_@{courseSummaryDetails.courseIdXmlSafe}_control').val();
                                                                        var newBackup = jQuery('#courseBackupNew_@{courseSummaryDetails.courseIdXmlSafe}_control').is(':checked');
                                                                        var newAtp = jQuery('#courseAtpNew_@{courseSummaryDetails.courseIdXmlSafe}_control').val();
                                                                        var newCourseId = '@{courseSummaryDetails.courseId}';
                                                                        var additionalFormData = {
                                                                            viewId: 'PlannedCourse-FormView',
                                                                            methodToCall: 'addPlanCourse',
                                                                            atpId: newAtp,
                                                                            backup: newBackup,
                                                                            pageId: 'add_dialog_page',
                                                                            courseCredit: newCredit,
                                                                            courseNote: newNote,
                                                                            courseId: newCourseId
                                                                        };
                                                                        submitPopupForm(additionalFormData, e, false);
                                                                    "/>
                                                        <property name="onDocumentReadyScript" value="
                                                                        jQuery('#actionCoursePlaceholder').on('COURSE_ADDED', function(event, data){
                                                                            fnClosePopup();
                                                                        }).on('ERROR', function(event, data){
                                                                            fnDisplayMessage(data.message, data.cssClass, 'errorPlaceholder', true, false,true,'errorPlaceholder');
                                                                        });
                                                                    "/>
                                                    </bean>
                                                    <bean parent="closePopoverCancel"/>
                                                </list>
                                            </property>
                                        </bean>
                                        <bean parent="errorPlaceholder"/>
                                    </list>
                                </property>
                            </bean>
                        </list>
                    </property>
                </bean>

            </list>
        </property>
    </bean>

    <!-- ################################ Dialog Response Components ############################ -->

    <!-- Page displaying all plan action response. It passes data base to javascripts on the UI-->
    <bean id="plan_action_response_page" parent="plan_action_response_page-parent"/>
    <bean id="plan_action_response_page-parent" abstract="true" parent="Uif-Page" p:id="plan_item_action_response_page">
        <property name="validationMessages">
            <bean parent="Uif-GroupValidationMessages">
                <property name="displayMessages" value="true"/>
                <property name="displayFieldLabelWithMessages" value="false"/>
            </bean>
        </property>
        <property name="items">
            <list>
                <ref bean="plan_item_actions_response"/>
            </list>
        </property>
    </bean>

    <!-- Content for the plan action response page-->
    <bean id="plan_item_actions_response" parent="plan_item_actions_response-parent"/>
    <bean id="plan_item_actions_response-parent" abstract="true" parent="Uif-VerticalBoxSection">
        <property name="items">
            <list>
                <bean id="request_status_item_key" parent="Uif-DataField" p:propertyName="requestStatus"/>
                <bean id="json_events_item_key" parent="Uif-DataField" p:propertyName="javascriptEventsAsJSON"/>

                <!--  These two can go away once the javascript evening is totally implemented. -->
                <bean id="add_plan_item_key" parent="Uif-DataField" p:propertyName="planItemId"/>
                <bean id="course_id_item_key" parent="Uif-DataField" p:propertyName="courseId"/>

                <!-- New dialog method refresh data from controller -->
                <bean id="requestStatus" parent="KSAP-SimpleDataField" p:propertyName="requestStatus"/>
                <bean id="jsonEvents" parent="KSAP-SimpleDataField"
                      p:propertyName="javascriptEventsAsJSON"/>
            </list>
        </property>
    </bean>


    <!-- ################################ Dialog Page Components ############################ -->
    <!-- Atp/Term Selection for Copy and Move plan items-->
    <bean id="courseTermSelection" parent="courseTermSelection-parent"/>
    <bean id="courseTermSelection-parent" abstract="true" parent="Uif-HorizontalFieldGroup"
          p:label="Quarter &amp; Year" p:labelPlacement="TOP">
        <property name="fieldLabel.cssClasses" value="myplan-text-normal"/>
        <property name="items">
            <list>
                <bean p:id="atpId_@{atpId.replaceAll('\.','-')}_@{courseSummaryDetails.courseIdXmlSafe}" parent="KSAP-SimpleInputField" p:propertyName="atpId">
                    <property name="control">
                        <bean parent="Uif-DropdownControl"/>
                    </property>
                    <property name="optionsFinder">
                        <bean class="org.kuali.student.myplan.plan.util.TermsListBuilder"/>
                    </property>
                </bean>
                <bean parent="KSAP-Message"
                      p:messageText="Note: This course MAY NOT be offered in your selected quarter. Check back after the Time Schedule is released.">
                    <property name="cssClasses">
                        <list merge="true">
                            <value>fl-font-size-80</value>
                            <value>fl-text-gray</value>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <!-- Placeholder DIV for error messages after submission failure -->
    <bean id="errorPlaceholder" parent="errorPlaceholder-parent"/>
    <bean id="errorPlaceholder-parent" abstract="true" parent="KSAP-SimpleInputField" p:id="errorPlaceholder" p:hidden="true"
          p:propertyName="courseSummaryDetails.courseIdXmlSafe">
        <property name="control">
            <bean parent="Uif-HiddenControl"/>
        </property>
    </bean>

    <!-- Cancel button to close popover -->
    <bean id="closePopoverCancel" parent="closePopoverCancel-parent"/>
    <bean id="closePopoverCancel-parent" abstract="true" parent="Uif-SecondaryActionButton-Small" p:id="closePopoverCancel"
          p:actionLabel="Cancel">
        <property name="actionScript"
                  value="fnClosePopup();"/>
    </bean>

    <!-- Text input for plan item notes field -->
    <bean id="planItemNote" parent="planItemNote-parent"/>
    <bean id="planItemNote-parent" abstract="true" parent="KSAP-SimpleInputField" p:propertyName="fakeCourseNote"
          p:defaultValue="@{#form.planItemId NE null ? #form.courseNote : ''}">
        <property name="label" value="Note for course"/>
        <property name="fieldLabel.render" value="true"/>
        <property name="fieldLabel.cssClasses">
            <list merge="true">
                <value>myplan-text-normal</value>
                <value>ks-plan-Note-label</value>
            </list>
        </property>
        <property name="labelPlacement" value="TOP"/>
        <property name="control">
            <bean parent="Uif-TextAreaControl"
                  p:watermarkText="Enter a short note (500 characters max)" p:maxLength="500">
                <property name="cssClasses">
                    <list merge="true">
                        <value>ksap-characterCount</value>
                        <value>ks-plan-Note-input</value>
                    </list>
                </property>
            </bean>
        </property>
        <property name="constraintMessage">
            <bean parent="KSAP-Message" p:messageText="characters remaining">
                <property name="onDocumentReadyScript" value="jQuery('.ksap-characterCount').characterCount({maxLength:500});"/>
                <property name="cssClasses">
                    <list merge="true">
                        <value>counter</value>
                        <value>ks-plan-Note-counter</value>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <!-- ################################ Unsure if Used ############################ -->

    <!--****************************Academic Planned Form View (Unsure if really still used)**********************-->
    <bean id="StudentAcademicPlanner-FormView" parent="StudentAcademicPlanner-FormView-parent"/>
    <bean id="StudentAcademicPlanner-FormView-parent" abstract="true" parent="MyPlanBaseFormView">
        <property name="id" value="StudentAcademicPlanner-FormView"/>
        <property name="footer.render" value="false"/>
        <property name="header.render" value="false"/>
        <property name="entryPageId" value="student_academic_planner"/>
        <property name="formClass" value="org.kuali.student.myplan.plan.form.PlanForm"/>
        <property name="cssClasses">
            <list merge="true">

            </list>
        </property>
        <property name="items">
            <list>
                <bean parent="Uif-Page" p:id="student_academic_planner_page">
                    <property name="validationMessages">
                        <bean parent="Uif-GroupValidationMessages">
                            <property name="displayMessages" value="true"/>
                            <property name="displayFieldLabelWithMessages" value="false"/>
                        </bean>
                    </property>
                    <property name="cssClasses">
                        <list merge="true">
                            <value>fl-container-150</value>
                        </list>
                    </property>
                    <property name="items">
                        <list>
                            <bean parent="Uif-VerticalBoxGroup" p:style="margin:0;">
                                <property name="validationMessages.render" value="false"/>
                                <property name="cssClasses">
                                    <list merge="true">
                                        <value>fl-text-align-left</value>
                                    </list>
                                </property>
                                <property name="items">
                                    <list>
                                        <bean parent="Uif-Link" p:linkText="Messages (@{messagesCount})">
                                            <property name="href"
                                                      value="lookup?methodToCall=search&amp;viewId=MessagesDetail-LookupView"/>
                                            <property name="render" value="@{messagesCount ne 0}"/>
                                        </bean>
                                        <bean parent="Uif-MessageField" p:messageText="Messages (0)"
                                              p:cssClasses="myplan-text-gray">
                                            <property name="render" value="@{messagesCount eq 0}"/>
                                        </bean>
                                        <bean parent="Uif-Link" p:linkText="Bookmarked Courses (@{bookmarkedCount})">
                                            <property name="href"
                                                      value="lookup?methodToCall=search&amp;viewId=SavedCoursesDetail-LookupView"/>
                                        </bean>
                                        <bean parent="Uif-MessageField"
                                              p:style="border-bottom: dotted 1px #cfcfcf;">
                                            <property name="message">
                                                <bean parent="Uif-Message" p:messageText=""/>
                                            </property>
                                        </bean>
                                        <bean parent="Uif-MessageField"
                                              p:cssClasses="fl-font-size-100 fl-text-bold">
                                            <property name="message">
                                                <bean parent="Uif-Message" p:messageText="MyPlan Settings"/>
                                            </property>
                                        </bean>
                                        <bean parent="Uif-MessageField"
                                              p:cssClasses="myplan-text-gray" p:style="font-size:x-small;">
                                            <property name="message">
                                                <bean parent="Uif-Message"
                                                      p:messageText=" &quot;Shared&quot; plans are viewable by all UW advisers. &quot;Private&quot; plans are only viewable by you."/>
                                            </property>
                                        </bean>
                                        <bean id="academic_planner_share" parent="Uif-InputField"
                                              p:propertyName="enableAdviserView" p:width="auto">
                                            <property name="onChangeScript" value="
                                                myplanWriteHiddenToForm('methodToCall', 'academicPlanner', 'student_academic_planner_page_form');
                                                jQuery('#student_academic_planner_page_form').ajaxSubmit();
                                            "/>
                                            <property name="control">
                                                <bean parent="Uif-VerticalRadioControl">
                                                    <property name="options">
                                                        <list>
                                                            <bean parent="Uif-KeyLabelPair" p:key="true"
                                                                  p:value="Shared"/>
                                                            <bean parent="Uif-KeyLabelPair" p:key="false"
                                                                  p:value="Private"/>
                                                        </list>
                                                    </property>
                                                </bean>
                                            </property>
                                        </bean>
                                        <bean parent="Uif-MessageField"
                                              p:style="border-bottom: dotted 1px #cfcfcf;">
                                            <property name="message">
                                                <bean parent="Uif-Message" p:messageText=""/>
                                            </property>
                                        </bean>
                                        <bean parent="Uif-Link" p:linkText="Help">
                                            <property name="href"
                                                      value="javascript:openHelpWindow('http://depts.washington.edu/myplan/help-site/');"/>
                                        </bean>
                                        <bean parent="Uif-Link" p:linkText="Log out">
                                            <property name="href"
                                                      value="/@{#ConfigProperties['app.code']}/logout.do"/>
                                        </bean>
                                    </list>
                                </property>
                                <property name="propertyReplacers">
                                    <list>
                                        <bean parent="Uif-ConditionalBeanPropertyReplacer" p:propertyName="items"
                                              p:condition="T(org.kuali.student.ap.framework.config.KsapFrameworkServiceLocator).getUserSessionHelper().isAdviser()">
                                            <property name="replacement">
                                                <list>
                                                    <bean parent="Uif-Message"
                                                          p:messageText="Adviser Access Restricted"/>
                                                </list>
                                            </property>
                                        </bean>
                                    </list>
                                </property>
                            </bean>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <!-- add remove popover group components (unsure if really still used) -->

    <bean id="course_title_link" parent="course_title_link-parent"/>
    <bean id="course_title_link-parent" abstract="true" parent="Uif-Link" p:target="">
        <property name="cssClasses">
            <list merge="true">
                <value>fl-text-bold</value>
                <value>myplan-text-wrap</value>
                <value>ks-Popover-bodyLabel</value>
            </list>
        </property>
        <property name="linkText"
                  value="@{courseSummaryDetails.code} @{courseSummaryDetails.courseTitle} (@{courseSummaryDetails.credit})"/>
        <property name="title"
                  value="@{courseSummaryDetails.code} @{courseSummaryDetails.courseTitle} (@{courseSummaryDetails.credit})"/>
        <property name="href"
                  value="inquiry?methodToCall=start&amp;viewId=CourseDetails-InquiryView&amp;courseId=@{courseSummaryDetails.courseId}"/>
    </bean>

    <!-- Course details 3 box group (Summary, Add, Delete)  -->
    <bean id="course_popover_group" parent="course_popover_group-parent"/>
    <bean id="course_popover_group-parent" abstract="true" parent="Uif-HorizontalBoxGroup">
        <property name="validationMessages.render" value="false"/>
        <property name="cssClasses">
            <list merge="true">
                <value>fl-container-300</value>
            </list>
        </property>
        <property name="items">
            <list>
                <!-- Course View and Actions -->
                <bean parent="course_details_info"/>
                <!-- Add to Plan Form fields -->
                <bean p:id="course_add_dialog" parent="course_add_dialog" p:style="display:none;"/>
                <!-- Delete from courses list confirmation -->
                <bean p:id="plan_item_delete_dialog" parent="plan_item_delete_dialog"  p:style="display:none;"/>
            </list>
        </property>
    </bean>

    <bean id="course_details_info" parent="course_details_info-parent"/>
    <bean id="course_details_info-parent" abstract="true" parent="Uif-VerticalBoxGroup">
        <property name="validationMessages.render" value="false"/>
        <property name="cssClasses">
            <list merge="true">
                <value>fl-container-300</value>
            </list>
        </property>
        <property name="items">
            <list>
                <ref bean="course_details_summary_info"/>
            </list>
        </property>
    </bean>

    <!-- Course details summary component used in both the popover and dialog box -->
    <bean id="course_details_summary_info" parent="course_details_summary_info-parent"/>
    <bean id="course_details_summary_info-parent" abstract="true" parent="Uif-VerticalBoxGroup">
        <property name="validationMessages.render" value="false"/>
        <property name="items">
            <list>
                <ref bean="course_details_summary_data"/>
                <bean parent="KSAP-SimpleInputField" p:propertyName="fakeCourseNote"
                      p:defaultValue="@{#form.planItemId NE null ? #form.courseNote : ''}" p:additionalCssClasses="ks-plan-Note">
                    <property name="label" value="Note for course"/>
                    <property name="fieldLabel.render" value="true"/>
                    <property name="fieldLabel.cssClasses">
                        <list merge="true">
                            <value>myplan-text-normal</value>
                            <value>ks-plan-Note-label</value>
                        </list>
                    </property>
                    <property name="labelPlacement" value="TOP"/>
                    <property name="control">
                        <bean parent="Uif-TextAreaControl">
                            <property name="disabled" value="true"/>
                            <property name="cssClasses">
                                <list merge="true">
                                    <value>ksap-characterCount</value>
                                    <value>ks-plan-Note-input</value>
                                </list>
                            </property>
                        </bean>
                    </property>
                </bean>
            </list>
        </property>
        <property name="footer">
            <ref bean="course_details_summary_messages"/>
        </property>
    </bean>

    <bean id="course_details_summary_data" parent="course_details_summary_data-parent"/>
    <bean id="course_details_summary_data-parent" abstract="true" parent="Uif-VerticalBoxGroup">
        <property name="validationMessages.render" value="false"/>
        <property name="cssClasses">
            <list merge="true">
                <value>myplan-course-details</value>
                <value>ks-Popover-item</value>
                <value>ks-Popover-item--divideBefore</value>
                <value>ks-Popover-item--divideAfter</value>
                <value>ks-Popover-item--secondary</value>
            </list>
        </property>
        <property name="items">
            <list>
                <!-- Scheduled Terms -->
                <bean parent="Uif-DataField" p:label="Scheduled for"
                      p:propertyName="courseSummaryDetails.scheduledTermsNames"
                      p:fieldLabel.cssClasses="fl-text-gray myplan-text-normal ks-Popover-detailLabel" p:labelPlacement="LEFT">
                    <property name="cssClasses">
                        <list merge="true">
                            <value>myplan-data-list</value>
                            <value>ks-Popover-detail</value>
                        </list>
                    </property>
                    <property name="render"
                              value="@{courseSummaryDetails.scheduledTerms.size() gt 0}"/>
                </bean>
                <bean parent="Uif-MessageField" p:label="Scheduled for"
                      p:fieldLabel.cssClasses="fl-text-gray myplan-text-normal ks-Popover-detailLabel"
                      p:render="@{courseSummaryDetails.scheduledTerms.size() eq 0}">
                    <property name="message">
                        <bean parent="Uif-Message" p:messageText="Not currently scheduled"/>
                    </property>
                </bean>
                <!-- Last Offered -->
                <bean parent="Uif-DataField" p:label="Last Offered" p:propertyName="courseSummaryDetails.lastOffered"
                      p:labelPlacement="LEFT">
                    <property name="fieldLabel.cssClasses" value="fl-text-gray myplan-text-normal ks-Popover-detailLabel"/>
                    <property name="render" value="@{courseSummaryDetails.lastOffered ne null and courseSummaryDetails.scheduledTerms.size() eq 0}"/>
                </bean>
                <!-- Projected Terms -->
                <bean parent="Uif-DataField" p:label="Projected for" p:propertyName="courseSummaryDetails.termsOffered"
                      p:labelPlacement="LEFT" p:escapeHtmlInPropertyValue="false">
                    <property name="fieldLabel.cssClasses" value="fl-text-gray myplan-text-normal ks-Popover-detailLabel"/>
                    <property name="propertyEditor" ref="terms_formatter"/>
                    <property name="cssClasses">
                        <list merge="true">
                            <value>myplan-data-list</value>
                            <value>ks-Popover-detail</value>
                        </list>
                    </property>
                    <property name="render"
                              value="@{courseSummaryDetails.scheduledTerms.size() gt 0 ? false : true}"/>
                </bean>
                <!-- Requisites -->
                <bean id="course_details_popup_requisites_testing" parent="Uif-DataField" p:label="Course Requisites"
                      p:propertyName="courseSummaryDetails.requisites"
                      p:labelPlacement="LEFT" p:escapeHtmlInPropertyValue="false">
                    <property name="fieldLabel.cssClasses" value="fl-text-gray myplan-text-normal ks-Popover-detailLabel"/>
                    <property name="propertyEditor" ref="data_list_formatter"/>
                    <property name="cssClasses">
                        <list merge="true">
                            <value>myplan-data-list</value>
                            <value>myplan-multiline-ellipsis</value>
                            <value>ks-Popover-detail</value>
                        </list>
                    </property>
                </bean>
                <bean parent="Uif-Link" p:target="">
                    <property name="linkText" value="View more details"/>
                    <property name="title" value="View more details about @{courseSummaryDetails.code}"/>
                    <property name="href"
                              value="inquiry?methodToCall=start&amp;viewId=CourseDetails-InquiryView&amp;courseId=@{courseSummaryDetails.courseId}"/>
                </bean>
            </list>
        </property>
    </bean>

    <bean id="course_details_summary_messages" parent="course_details_summary_messages-parent"/>
    <bean id="course_details_summary_messages-parent" abstract="true" parent="Uif-VerticalBoxGroup">
        <property name="validationMessages.render" value="false"/>
        <property name="items">
            <list>
                <bean id="course_details_popup_buttons" parent="Uif-HorizontalBoxGroup">
                    <property name="validationMessages.render" value="false"/>
                    <property name="items">
                        <list>
                            <!-- If not in plan and not in saved courses and not in academic record list -->
                            <bean parent="Uif-HorizontalFieldGroup"
                                  p:render="@{(plannedCourseSummary.backupList.size() eq 0 and plannedCourseSummary.plannedList.size() eq 0 and plannedCourseSummary.savedItemId eq null and plannedCourseSummary.academicTerms.size() eq 0)}">
                                <property name="fieldLabel.render" value="false"/>
                                <property name="group.validationMessages.render" value="false"/>
                                <property name="items">
                                    <list>
                                        <ref bean="addToPlanButton"/>
                                        <ref bean="addSavedCourseButton"/>
                                    </list>
                                </property>
                                <property name="propertyReplacers">
                                    <list>
                                        <bean parent="Uif-ConditionalBeanPropertyReplacer" p:propertyName="items"
                                              p:condition="T(org.kuali.student.ap.framework.config.KsapFrameworkServiceLocator).getUserSessionHelper().isAdviser()">
                                            <property name="replacement">
                                                <list>
                                                    <bean parent="Uif-Message" p:messageText=""/>
                                                </list>
                                            </property>
                                        </bean>
                                    </list>
                                </property>
                            </bean>
                            <!-- If not in plan and in saved courses and not in academic list-->
                            <bean parent="Uif-HorizontalFieldGroup"
                                  p:render="@{(plannedCourseSummary.backupList.size() eq 0 and plannedCourseSummary.plannedList.size() eq 0 and plannedCourseSummary.savedItemId ne null and plannedCourseSummary.academicTerms.size() eq 0)}">
                                <property name="fieldLabel.render" value="false"/>
                                <property name="group.validationMessages.render" value="false"/>
                                <property name="items">
                                    <list>
                                        <ref bean="addToPlanButton"/>
                                        <ref bean="removeSavedCourseButton"/>
                                    </list>
                                </property>
                                <property name="propertyReplacers">
                                    <list>
                                        <bean parent="Uif-ConditionalBeanPropertyReplacer" p:propertyName="items"
                                              p:condition="T(org.kuali.student.ap.framework.config.KsapFrameworkServiceLocator).getUserSessionHelper().isAdviser()">
                                            <property name="replacement">
                                                <list>
                                                    <bean parent="Uif-Message" p:messageText=""/>
                                                </list>
                                            </property>
                                        </bean>
                                    </list>
                                </property>
                            </bean>

                            <!-- If in plan and in saved courses and not in academic record list -->
                            <!-- <bean parent="Uif-HorizontalFieldGroup"
                                   p:render="@{((plannedCourseSummary.backupList.size() gt 0 or plannedCourseSummary.plannedList.size() gt 0) and plannedCourseSummary.savedItemId ne null and plannedCourseSummary.academicTerms.size() eq 0)}">
                                 <property name="fieldLabel.render" value="false"/>
                                 <property name="group.validationMessages.render" value="false"/>
                                 <property name="items">
                                     <list>
                                         <ref bean="addToPlanButton"/>
                                         <ref bean="removeSavedCourseButton"/>
                                     </list>
                                 </property>
                                 <property name="propertyReplacers">
                                     <list>
                                         <bean parent="Uif-ConditionalBeanPropertyReplacer" p:propertyName="items"
                                               p:condition="T(org.kuali.student.ap.framework.config.KsapFrameworkServiceLocator).getUserSessionHelper().isAdviser()">
                                             <property name="replacement">
                                                 <list>
                                                     <bean parent="Uif-Message" p:messageText=""/>
                                                 </list>
                                             </property>
                                         </bean>
                                     </list>
                                 </property>
                             </bean>-->
                        </list>
                    </property>
                </bean>
                <bean id="course_details_popup_messaging" parent="Uif-VerticalBoxGroup"
                      p:render="@{(plannedCourseSummary.backupList.size() gt 0 or plannedCourseSummary.plannedList.size() gt 0 or plannedCourseSummary.savedItemId ne null or plannedCourseSummary.academicTerms.size() gt 0)}">
                    <property name="validationMessages.render" value="false"/>
                    <property name="cssClasses">
                        <list merge="true">
                            <value>myplan-status</value>
                            <value>info</value>
                        </list>
                    </property>
                    <property name="items">
                        <list>
                            <bean parent="Uif-HorizontalFieldGroup" p:style="margin:0px;">
                                <property name="fieldLabel.render" value="false"/>
                                <property name="group.validationMessages.render" value="false"/>
                                <property name="items">
                                    <list>
                                        <bean parent="MyPlanMessagingIcon"/>
                                        <bean parent="Uif-DataField"
                                              p:propertyName="courseAndPlanSummary"
                                              p:labelPlacement="LEFT" p:escapeHtmlInPropertyValue="false">
                                            <property name="fieldLabel.cssClasses"
                                                      value="fl-text-gray myplan-text-normal"/>
                                            <property name="propertyEditor" ref="crud_message_matrix_formatter"/>
                                            <property name="cssClasses">
                                                <list merge="true">
                                                    <value>myplan-data-list</value>
                                                    <value>message</value>
                                                </list>
                                            </property>
                                        </bean>
                                    </list>
                                </property>
                            </bean>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <!--  Add to plan button. Used contextually in course details popup actions -->
    <bean id="addToPlanButton" parent="addToPlanButton-parent"/>
    <bean id="addToPlanButton-parent" abstract="true" p:id="addToPlanButton" parent="Uif-PrimaryActionButton-Small" p:actionLabel="Add to Plan"
          p:actionImagePlacement="RIGHT">
        <property name="actionScript"
                  value="fnPopoverSlider('course_add_dialog', 'course_popover_group', 'left');"/>
        <property name="actionImage">
            <bean parent="Uif-Image" p:source="@{#ConfigProperties['ks.myplan.externalizable.images.url']}pixel.gif">
                <property name="cssClasses">
                    <list merge="true">
                        <value>rightArrowSmall</value>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <!--  Add to saved courses. Used contextually in course details popup actions -->
    <bean id="addSavedCourseButton" parent="addSavedCourseButton-parent"/>
    <bean id="addSavedCourseButton-parent" abstract="true" p:id="addSavedCourseButton" parent="Uif-SecondaryActionButton-Small"
          p:actionLabel="Bookmark Course">
        <property name="onDocumentReadyScript"
                  value="jQuery('#addSavedCourseButton').on('PLAN_ITEM_ADDED', function(data){
                      if (data.planItemType === 'wishlist') {
                          fnDisplayMessage(data.message, data.cssClass, 'addSavedCourseButton', true);
                      }
                  });"/>
        <property name="actionScript" value="
            var additionalFormData = {viewId:'PlannedCourse-FormView', methodToCall:'addSavedCourse', courseId:'@{courseSummaryDetails.courseId}'};
            submitPopupForm(additionalFormData, e, false);
        "/>
    </bean>

    <!-- Remove from saved courses list button. -->
    <bean id="removeSavedCourseButton" parent="removeSavedCourseButton-parent"/>
    <bean id="removeSavedCourseButton-parent" abstract="true" p:id="removeSavedCourseButton" parent="Uif-SecondaryActionButton-Small"
          p:actionLabel="Delete">
        <property name="actionScript"
                  value="fnPopoverSlider('plan_item_delete_dialog','course_popover_group','left');"/>
    </bean>

    <bean parent="KSAP-PopoverPage" id="add_remove_course_popover_page">
        <property name="cssClasses">
            <list merge="true">
                <value>fl-container-300</value>
                <value>@{planItemId.replaceAll("\.","-")}</value>
            </list>
        </property>
        <property name="items">
            <list>
                <ref bean="course_title_link"/>
                <ref bean="course_popover_group"/>
            </list>
        </property>
    </bean>
</beans>
