<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright 2010 The Kuali Foundation Licensed under the Educational Community License, Version 2.0 (the "License"); you
  may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.osedu.org/licenses/ECL-2.0
  Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS
  IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language
  governing permissions and limitations under the License. -->

<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
                           http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd
                           http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.0.xsd
                           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd">

    <!-- This context requires that a spring Transaction Manager named 'transactionManager' be defined -->
    <import resource="classpath:ks-core-api-data-dictionary-validator-configuration.xml" />

    <import resource="classpath:enrollDao.xml" />
    <import resource="classpath:statement-context.xml" />
    <import resource="classpath:ks-enroll-mq-context.xml" />
    <import resource="classpath:ks-enroll-batch-context.xml" />
    <import resource="classpath:ks-enroll-mock-academic-service.xml" />
    <!-- import resource="classpath:ks-enroll-mock-room-data-context.xml"/ -->

    <!-- Top Level Alias -->
    <alias name="socServiceAft" alias="CourseOfferingSetService" />
    <alias name="coServiceValidation" alias="CourseOfferingService" />
    <alias name="courseOfferingServiceCache" alias="CourseOfferingServiceCached" />
    <alias name="luiServiceValidationDecorator" alias="LuiService" />
    <alias name="lprServiceValidationDecorator" alias="LprService"/>
    <alias name="lrcServiceValidation" alias="LRCService" />
    <alias name="populationServiceValidation" alias="PopulationService" />
    <alias name="roomServiceValidation" alias="RoomService"/>
    <alias name="holdServiceValidation" alias="HoldService" />
    <alias name="courseRegistrationServiceProcessCheckDecorator" alias="CourseRegistrationService" />
    <alias name="processServiceValidationDecorator" alias="ProcessService" />
    <alias name="exemptionServiceMapImpl" alias="ExemptionService" />
    <alias name="gesServiceRolloverEvaluationDecorator" alias="GesService" />
    <alias name="schedulingServiceValidationDecorator" alias="SchedulingService" />
    <alias name="courseWaitListServiceImpl" alias="courseWaitListService" />
    <alias name="examServiceImpl" alias="ExamService" />
    <alias name="examOfferingServiceImpl" alias="ExamOfferingService" />

    <bean id="enrollDataSource" class="org.kuali.rice.student.core.database.DerbyXAPoolDataSource">
        <property name="transactionManager" ref="userTransaction" />
        <property name="driverClassName" value="${ks.enroll.datasource.driver.name}" />
        <property name="maxSize" value="${ks.enroll.datasource.maxSize}" />
        <property name="minSize" value="${ks.enroll.datasource.minSize}" />
        <property name="maxWait" value="${ks.enroll.datasource.maxWait}" />
        <property name="validationQuery" value="${ks.enroll.datasource.validationQuery}" />
        <property name="url" value="${ks.enroll.datasource.url}" />
        <property name="username" value="${ks.enroll.datasource.username}" />
        <property name="password" value="${ks.enroll.datasource.password}" />
    </bean>

    <bean id="gradeRosterAssembler" class="org.kuali.student.enrollment.class2.grading.service.assembler.GradeRosterAssembler"></bean>
    <bean id="gradeRosterEntryAssembler" class="org.kuali.student.enrollment.class2.grading.service.assembler.GradeRosterEntryAssembler"></bean>

    <bean id="gradingService" class="org.kuali.student.enrollment.class2.grading.service.impl.GradingServiceImpl"
          scope="singleton">
        <property name="lprService" ref="LprService" />
        <property name="courseOfferingService" ref="CourseOfferingService" />
        <property name="gradeRosterAssembler" ref="gradeRosterAssembler" />
        <property name="gradeRosterEntryAssembler" ref="gradeRosterEntryAssembler" />
        <property name="lrrService" ref="lrrPersistenceService" />
        <property name="gradeValuesGroupAssembler" ref="gradeValuesGroupAssembler" />
        <property name="lrcService" ref="lrcServiceCache" />
        <property name="courseRegistrationService" ref="CourseRegistrationService" />
    </bean>

    <bean id="ks.exp.gradingService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="gradingService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.grading.service.GradingService" />
                <property name="localServiceName" value="GradingService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/grading" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- Seat count service START -->
    <bean id="courseSeatCountService" class="org.kuali.student.enrollment.class2.courseseatcount.service.impl.CourseSeatCountServiceImpl"
          scope="singleton">
    </bean>

    <bean id="ks.exp.courseSeatCountService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="courseSeatCountService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.courseseatcount.service.CourseSeatCountService" />
                <property name="localServiceName" value="CourseSeatCountService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseSeatCount" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>
    <!-- Seat count service END -->

    <bean id="coCriteriaLookupService" parent="defaultCriteriaLookupService">
        <property name="predicateTransforms">
            <list>
                <bean id="coCodeTransform" class="org.kuali.student.enrollment.class2.courseoffering.service.criteria.transform.CourseOfferingCriteriaTransform"/>
            </list>
        </property>
    </bean>
    <bean id="foCriteriaLookupService" parent="defaultCriteriaLookupService"/>
    <bean id="aoCriteriaLookupService" parent="defaultCriteriaLookupService"/>
    <bean id="rgCriteriaLookupService" parent="defaultCriteriaLookupService">
        <property name="predicateTransforms">
            <list merge="true">
                <bean id="regGroupTransform" class="org.kuali.student.r2.common.criteria.transform.RenameTransform">
                    <property name="renameAttributes">
                        <map>
                            <entry key="formatOfferingId" value="lui.id"/>
                            <entry key="name" value="relatedLui.name"/>
                        </map>
                    </property>
                </bean>
            </list>
        </property>
    </bean>
    <bean id="spCriteriaLookupService" parent="defaultCriteriaLookupService"/>


    <!--    THIS SHOULD BE USED FOR ALL Info objects that extend ID or KeyEntity becuase they have name, descr, meta and attributes-->
    <bean id="defaultCriteriaLookupService" class="org.kuali.student.r2.common.criteria.impl.CriteriaLookupServiceImpl">
        <property name="criteriaLookupDao" ref="criterialookupDaoJpa"/>
        <property name="predicateTransforms">
            <list>
                <ref bean="keyword2LikeTransform"/>
                <ref bean="descrTransform"/>
                <ref bean="metaTransform"/>
                <ref bean="attributeTransform"/>
            </list>
        </property>
    </bean>

    <!--     THIS SHOULD BE USED FOR ALL RELATIONSHIP OBJECTS-->
    <bean id="defaultRelationCriteriaLookupService" class="org.kuali.student.r2.common.criteria.impl.CriteriaLookupServiceImpl">
        <property name="criteriaLookupDao" ref="criterialookupDaoJpa"/>
        <property name="predicateTransforms">
            <list>
                <ref bean="metaTransform"/>
                <ref bean="attributeTransform"/>
            </list>
        </property>
    </bean>


    <bean id="stateService" class="org.kuali.student.r2.core.class1.state.service.impl.StateServiceImpl">
        <property name="stateDao" ref="stateDao" />
        <property name="lifecycleDao" ref="lifecycleDao" />
        <property name="stateChangeDao" ref="stateChangeDao" />
        <property name="stateConstraintDao" ref="stateConstraintDao" />
        <property name="statePropagationDao" ref="statePropagationDao"/>
        <property name="stateCriteriaLookupService">
            <bean parent="defaultCriteriaLookupService">
                <property name="predicateTransforms">
                    <list merge="false">
                        <bean parent="keyword2LikeTransform">
                            <property name="likeAttributes">
                                <!--                            Also scan the key and the lifecyle key when doing a keyword search-->
                                <list merge="true">
                                    <value>key</value>
                                    <value>lifecycleKey</value>
                                </list>
                            </property>
                        </bean>
                        <ref bean="key2IdTransform"/>
                        <ref bean="descrTransform"/>
                        <ref bean="metaTransform"/>
                        <ref bean="attributeTransform"/>
                    </list>
                </property>
            </bean>
        </property>
        <property name="lifecycleCriteriaLookupService">
            <bean parent="defaultCriteriaLookupService">
                <property name="predicateTransforms">
                    <list merge="false">
                        <bean parent="keyword2LikeTransform">
                            <property name="likeAttributes">
                                <!--                            Also scan the key and the refObjectUri when doing a keyword search-->
                                <list merge="true">
                                    <value>key</value>
                                    <value>refObjectUri</value>
                                </list>
                            </property>
                        </bean>
                        <ref bean="key2IdTransform"/>
                        <ref bean="descrTransform"/>
                        <ref bean="metaTransform"/>
                        <ref bean="attributeTransform"/>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <bean id="typeService" class="org.kuali.student.r2.common.class1.type.service.TypeServiceImpl">
        <property name="typeDao" ref="typeDao" />
        <property name="typeTypeRelationDao" ref="typeTypeRelationDao" />
        <property name="typeCriteriaLookupService">
            <bean parent="defaultCriteriaLookupService">
                <property name="predicateTransforms">
                    <list merge="false">
                        <bean parent="keyword2LikeTransform">
                            <property name="likeAttributes">
                                <!--                            Also scan the key when doing a keyword search-->
                                <list merge="true">
                                    <value>key</value>
                                    <value>refObjectURI</value>
                                    <value>serviceUri</value>
                                </list>
                            </property>
                        </bean>
                        <bean class="org.kuali.student.r2.common.criteria.transform.RenameTransform">
                            <property name="renameAttributes">
                                <map>
                                    <entry key="refObjectUri" value="refObjectURI"/>
                                </map>
                            </property>
                        </bean>
                        <ref bean="key2IdTransform"/>
                        <ref bean="descrTransform"/>
                        <ref bean="metaTransform"/>
                        <ref bean="attributeTransform"/>
                    </list>
                </property>
            </bean>
        </property>
        <property name="typeTypeRelationCriteriaLookupService">
            <bean parent="defaultRelationCriteriaLookupService">
                <property name="predicateTransforms">
                    <list merge="false">
                        <bean parent="keyword2LikeTransform">
                            <property name="likeAttributes">
                                <!--                            scan the keys when doing a keyword search-->
                                <list merge="false">
                                    <value>typeKey</value>
                                    <value>stateKey</value>
                                    <value>ownerTypeKey</value>
                                    <value>relatedTypeKey</value>
                                </list>
                            </property>
                        </bean>
                        <bean class="org.kuali.student.r2.common.criteria.transform.RenameTransform">
                            <property name="renameAttributes">
                                <map>
                                    <entry key="typeKey" value="type"/>
                                    <entry key="stateKey" value="state"/>
                                    <entry key="ownerTypeKey" value="ownerTypeId"/>
                                    <entry key="relatedTypeKey" value="relatedTypeId"/>
                                </map>
                            </property>
                        </bean>
                        <ref bean="metaTransform"/>
                        <ref bean="attributeTransform"/>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <!--- Fee Service -->
    <bean id="feeService" class="org.kuali.student.r2.core.fee.service.impl.FeeServiceImpl">
        <property name="enrollmentFeeDao" ref="enrollmentFeeDao" />
    </bean>

    <bean id="ks.exp.feeService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="feeService" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.fee.service.FeeService" />
                <property name="localServiceName" value="FeeService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/fee" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="socBusinessLogic" class="org.kuali.student.enrollment.class2.courseofferingset.service.impl.CourseOfferingSetServiceBusinessLogicImpl">
        <property name="socDao" ref="socDao" />
        <property name="courseService" ref="CourseService" />
        <property name="acalService" ref="AcademicCalendarService" />
        <property name="coService" ref="CourseOfferingService" />
        <property name="schedulingService" ref="SchedulingService"/>
        <property name="rolloverAssist" ref="rolloverAssist"/>
        <property name="examOfferingServiceFacade" ref="examOfferingServiceFacade" />
        <property name="generateExamOfferings" value="${ks.enroll.examoffering.generateOnSocSchedule.defaultvalue}" />
    </bean>


    <!-- courseofferingset beans -->

    <bean id="socServiceAft"
          class="org.kuali.student.enrollment.class2.courseofferingset.service.decorators.CourseOfferingSetServiceAftDecorator">
        <property name="nextDecorator" ref="socServiceValidation" />
        <property name="socDao" ref="socDao" />
    </bean>

    <bean id="socServiceValidation"
          class="org.kuali.student.enrollment.class2.courseofferingset.service.decorators.CourseOfferingSetServiceValidationDecorator">
        <property name="nextDecorator" ref="socServiceImpl" />
        <property name="validator" ref="validator" />
    </bean>


    <bean id="socServiceImpl" class="org.kuali.student.enrollment.class2.courseofferingset.service.impl.CourseOfferingSetServiceImpl">
        <property name="socDao" ref="socDao" />
        <property name="socRorDao" ref="socRolloverResultDao" />
        <property name="socRorItemDao" ref="socRolloverResultItemDao"/>
        <property name="criteriaLookupService" ref="defaultCriteriaLookupService" />
        <property name="businessLogic" ref="socBusinessLogic" />
        <property name="stateTransitionsHelper" ref="stateTransitionsHelper"/>
        <property name="stateService" ref="stateService"/>
        <property name="acalService" ref="AcademicCalendarService" />
    </bean>

    <bean id="ks.exp.socService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="CourseOfferingSetService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.courseofferingset.service.CourseOfferingSetService" />
                <property name="localServiceName" value="CourseOfferingSetService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseOfferingSet" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- socService mock implementation -->
    <!-- socService1 is new service created for testing and for havin mock data from CourseOfferingSetSericeMockImpl service.
         I just created it when there's no actual data and I just used this mock service implementation for testing my code functionality.
         In future, it can be removed but, its not affecting the actual CourseOfferingSetService anyways.
         TODO: remove this bean
    -->
    <bean id="socService1" class="org.kuali.student.enrollment.class2.courseofferingset.service.impl.CourseOfferingSetServiceMockImplWithDataLoaded"/>

    <bean id="ks.exp.socService1" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="socService1" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.courseofferingset.service.CourseOfferingSetService" />
                <property name="localServiceName" value="socService1" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseOfferingSet" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>
    <!-- course offering beans -->

    <!-- Note: this is not a decorator -->
    <bean id="coBusinessLogic" class="org.kuali.student.enrollment.class2.courseoffering.service.impl.CourseOfferingServiceBusinessLogicImpl">
        <property name="courseService" ref="CourseService" />
        <property name="acalService" ref="AcademicCalendarService" />
        <property name="registrationCodeGeneratorFactory" ref="regGroupCodeGeneratorFactory" />
        <property name="courseOfferingTransformer" ref="courseOfferingTransformer" />
        <property name="activityOfferingTransformer" ref="activityTransformer" />
        <property name="acalServiceFacade" ref="acalServiceFacade"/>
        <property name="courseWaitListService" ref="courseWaitListServiceImpl"/>
        <property name="roomService" ref="RoomService"/>
        <property name="courseOfferingServiceExtender" ref="courseOfferingServiceExtender"/>
        <property name="generateExamOfferings" value="${ks.enroll.examoffering.generateOnRollover.defaultvalue}" />
        <property name="gesService" ref="GesService"/>
        <!--The coService property is looked up in the service bus to prevent a circular spring reference-->
    </bean>

    <bean id="courseOfferingServiceCache" class="org.kuali.student.enrollment.class2.courseoffering.service.decorators.CourseOfferingServiceCacheDecorator">
        <property name="cacheManager" ref="ksCacheManager"/>
        <property name="nextDecorator" ref="coServiceValidation"/>
    </bean>

    <bean id="coServiceValidation" class="org.kuali.student.enrollment.class2.courseoffering.service.decorators.CourseOfferingServiceValidationDecorator">
        <property name="nextDecorator" ref="coServicePerformanceImpl" />
        <property name="validator" ref="validator" />
        <property name="searchService" ref="searchService" />
    </bean>

    <!-- This performance impl goes directly against the database layer. If you are implementing your own database for course offering
         please do not use this decorator. ie. take it out of the decorator chain. -->
    <bean id="coServicePerformanceImpl" class="org.kuali.student.enrollment.class2.courseoffering.service.decorators.CourseOfferingServicePerformanceDecorator">
        <property name="nextDecorator" ref="coServiceImpl" />
        <property name="searchService" ref="searchService" />
    </bean>

    <bean id="coServiceImpl" class="org.kuali.student.enrollment.class2.courseoffering.service.impl.CourseOfferingServiceImpl">
        <property name="luiService" ref="LuiService" />
        <property name="rgAssembler" ref="rgAssembler" />
        <property name="courseService" ref="CourseService" />
        <property name="acalService" ref="AcademicCalendarService" />
        <property name="stateService" ref="stateServiceCacheDecorator" />
        <property name="lprService" ref="lprPersistenceServiceCache"/>
        <property name="typeService" ref="typeServiceCacheDecorator" />
        <property name="businessLogic" ref="coBusinessLogic" />
        <property name="offeringCodeGenerator" ref="offeringCodeGenerator" />
        <property name="courseOfferingTransformer" ref="courseOfferingTransformer" />
        <property name="activityOfferingTransformer" ref="activityTransformer" />
        <property name="seatPoolDefinitionDao" ref="seatPoolDefinitionDao" />
        <property name="activityOfferingClusterDao" ref="activityOfferingClusterDao" />
        <property name="registrationGroupTransformer" ref="registrationGroupTransformer" />
        <property name="schedulingService" ref="SchedulingService"/>
        <property name="lrcService" ref="lrcServiceCache"/>
        <property name="stateTransitionsHelper" ref="stateTransitionsHelper"/>
        <property name="searchService" ref="searchService" />
        <property name="atpService" ref="AtpService" />
        <property name="roomService" ref="RoomService"/>
        <property name="courseWaitListService" ref="courseWaitListServiceImpl"/>
        <property name="examOfferingService" ref="examOfferingServiceImpl"/>
        <property name="courseOfferingServiceExtender" ref="courseOfferingServiceExtender"/>
        <property name="coCriteriaLookupService" ref="coCriteriaLookupService" />
        <property name="foCriteriaLookupService" ref="foCriteriaLookupService" />
        <property name="aoCriteriaLookupService" ref="aoCriteriaLookupService" />
        <property name="rgCriteriaLookupService" ref="rgCriteriaLookupService" />
        <property name="spCriteriaLookupService" ref="spCriteriaLookupService" />
    </bean>

    <bean id="courseWaitListServiceImpl" class="org.kuali.student.enrollment.class2.coursewaitlist.service.impl.CourseWaitListServiceImpl">
        <property name="courseWaitListDao" ref="courseWaitListDao" />
    </bean>

    <bean id="ks.exp.courseWaitListService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="courseWaitListService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.coursewaitlist.service.CourseWaitListService" />
                <property name="localServiceName" value="CourseWaitListService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseWaitList" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="courseWaitListServiceFacade" class="org.kuali.student.enrollment.class2.coursewaitlist.service.facade.CourseWaitListServiceFacadeImpl">
        <property name="coService" ref="CourseOfferingService"/>
        <property name="courseWaitListService" ref="courseWaitListService" />
        <property name="automaticallyProcessed" value="${ks.enroll.coursewaitlist.automaticallyProcessed.defaultvalue}" />
        <property name="confirmationRequired" value="${ks.enroll.coursewaitlist.confirmationRequired.defaultvalue}" />
        <property name="allowHoldUntilEntries" value="${ks.enroll.coursewaitlist.allowHoldUntilEntries.defaultvalue}" />
        <property name="checkInRequired" value="${ks.enroll.coursewaitlist.checkInRequired.defaultvalue}" />
        <!--Default value for COInfo.hasWaitlist -->
        <property name="hasWaitlist" value="${ks.enroll.coursewaitlist.forCourseOffering.hasWaitlist.defaultvalue}" />
    </bean>

    <!-- Put facade on the bus -->
    <bean id="ks.exp.courseWaitListServiceFacade" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.JavaServiceDefinition">
                <property name="service" ref="courseWaitListServiceFacade" /> <!-- Must match id in the bean -->
                <property name="serviceInterface" value="org.kuali.student.enrollment.class2.coursewaitlist.service.facade.CourseWaitListServiceFacade" />
                <property name="localServiceName" value="courseWaitListServiceFacade" /> <!-- Part of the QName -->
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseWaitListServiceFacade" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="stateTransitionsHelper" class="org.kuali.student.r2.core.class1.state.service.impl.StateTransitionsHelperImpl">
        <property name="stateService" ref="stateService"/>
        <property name="stateHelperMap" ref="stateHelperMap" />
        <property name="relatedObjectHelperMap" ref="relatedObjectHelperMap"/>
    </bean>

    <util:map id="stateHelperMap" map-class="java.util.HashMap">
        <entry key="kuali.lui.activity.offering" value-ref="aoStateHelper"/>
        <entry key="kuali.lui.format.offering" value-ref="foStateHelper"/>
        <entry key="kuali.lui.course.offering" value-ref="coStateHelper"/>
        <entry key="kuali.lui.registration.group" value-ref="rgStateHelperImpl"/>
        <entry key="kuali.soc" value-ref="socStateHelper"/>
        <entry key="kuali.soc.scheduling" value-ref="socSchedStateHelper"/>
        <entry key="kuali.lui.exam.offering" value-ref="eoStateHelper"/>
    </util:map>

    <util:map id="relatedObjectHelperMap" map-class="java.util.HashMap">
        <entry key="kuali.lui.activity.offering:kuali.lui.format.offering" value-ref="aoToFoRelatedObjHelper"/>
        <entry key="kuali.lui.format.offering:kuali.lui.course.offering" value-ref="foToCoRelatedObjHelper"/>
        <entry key="kuali.lui.course.offering:kuali.lui.format.offering" value-ref="coToFoRelatedObjHelper"/>
        <entry key="kuali.lui.format.offering:kuali.lui.activity.offering" value-ref="foToAoRelatedObjHelper"/>
        <entry key="kuali.lui.activity.offering:kuali.lui.registration.group" value-ref="aoToRgRelatedObjHelper"/>
        <entry key="kuali.lui.registration.group:kuali.lui.activity.offering" value-ref="rgToAoRelatedObjHelper"/>
        <entry key="kuali.lui.activity.offering:kuali.lui.activity.offering.scheduling" value-ref="aoToAoSchedRelatedObjHelper"/>
        <entry key="kuali.soc:kuali.lui.activity.offering" value-ref="socToAORelatedObjHelper"/>
        <entry key="kuali.lui.activity.offering:kuali.soc" value-ref="aotoSOCRelatedObjHelper"/>
        <entry key="kuali.lui.activity.offering:kuali.lui.exam.offering" value-ref="aoToEoRelatedObjHelper"/>
        <entry key="kuali.lui.course.offering:kuali.lui.exam.offering" value-ref="coToEoRelatedObjHelper"/>
        <entry key="kuali.lui.exam.offering:kuali.lui.activity.offering" value-ref="eoToAoRelatedObjHelper"/>
        <entry key="kuali.lui.format.offering:kuali.lui.exam.offering" value-ref="foToEoRelatedObjHelper"/>
    </util:map>

    <bean id="aoStateHelper" class="org.kuali.student.enrollment.class1.state.impl.AOStateHelperImpl"/>

    <bean id="foStateHelper" class="org.kuali.student.enrollment.class1.state.impl.FOStateHelperImpl"/>

    <bean id="coStateHelper" class="org.kuali.student.enrollment.class1.state.impl.COStateHelperImpl" />

    <bean id="eoStateHelper" class="org.kuali.student.enrollment.class1.state.impl.EOStateHelperImpl" />

    <bean id="rgStateHelperImpl" class="org.kuali.student.enrollment.class1.state.impl.RGStateHelperImpl" />

    <bean id="socStateHelper" class="org.kuali.student.enrollment.class1.state.impl.SOCStateHelperImpl" />

    <bean id="socSchedStateHelper" class="org.kuali.student.enrollment.class1.state.impl.SOCSchedStateHelperImpl" />

    <bean id="aoToFoRelatedObjHelper"  class="org.kuali.student.enrollment.class1.state.impl.RelatedObjectHelperAOtoFOImpl"/>

    <bean id="foToCoRelatedObjHelper"  class="org.kuali.student.enrollment.class1.state.impl.RelatedObjectHelperFOtoCOImpl"/>

    <bean id="coToFoRelatedObjHelper"  class="org.kuali.student.enrollment.class1.state.impl.RelatedObjectHelperCOtoFOImpl"/>

    <bean id="foToAoRelatedObjHelper" class="org.kuali.student.enrollment.class1.state.impl.RelatedObjectHelperFOtoAOImpl"/>

    <bean id="aoToRgRelatedObjHelper" class="org.kuali.student.enrollment.class1.state.impl.RelatedObjectHelperAOtoRGImpl"/>

    <bean id="rgToAoRelatedObjHelper" class="org.kuali.student.enrollment.class1.state.impl.RelatedObjectHelperRGtoAOImpl"/>

    <bean id="aoToEoRelatedObjHelper"  class="org.kuali.student.enrollment.class1.state.impl.RelatedObjectHelperAOtoEOImpl"/>

    <bean id="coToEoRelatedObjHelper"  class="org.kuali.student.enrollment.class1.state.impl.RelatedObjectHelperCOtoEOImpl"/>

    <bean id="eoToAoRelatedObjHelper"  class="org.kuali.student.enrollment.class1.state.impl.RelatedObjectHelperEOtoAOImpl"/>

    <bean id="foToEoRelatedObjHelper"  class="org.kuali.student.enrollment.class1.state.impl.RelatedObjectHelperFOtoEOImpl"/>

    <bean id="aoToAoSchedRelatedObjHelper" class="org.kuali.student.enrollment.class1.state.impl.RelatedObjectHelperAOtoAOSchedImpl"/>

    <bean id="socToAORelatedObjHelper" class="org.kuali.student.enrollment.class1.state.impl.RelatedObjectHelperSOCtoAOImpl"/>
    <bean id="aotoSOCRelatedObjHelper" class="org.kuali.student.enrollment.class1.state.impl.RelatedObjectHelperAOtoSOCImpl"/>

    <bean id="ks.exp.courseOfferingService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="CourseOfferingService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.courseoffering.service.CourseOfferingService" />
                <property name="localServiceName" value="CourseOfferingService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseOffering" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="ks.exp.courseOfferingServiceCached" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="CourseOfferingServiceCached" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.courseoffering.service.CourseOfferingService" />
                <property name="localServiceName" value="CourseOfferingServiceCached" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseOffering" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="offeringCodeGenerator" class="org.kuali.student.enrollment.class2.courseoffering.service.impl.CourseOfferingCodeGeneratorDBImpl">
        <property name="codeGeneratorLocksDao" ref="codeGeneratorLocksDao" />
    </bean>

    <bean id="timeSlotCodeGenerator" class="org.kuali.student.r2.core.scheduling.util.impl.TimeSlotCodeGeneratorImpl">
        <property name="timeSlotDao" ref="timeSlotDao" />
    </bean>

    <bean id="krmsRuleManagementCopyMethods" class="org.kuali.rice.krms.impl.util.KrmsRuleManagementCopyMethodsImpl">
        <!--       If I uncomment this next one it fails because ruleManagementService is not defined but if I have it commented out
the program will get the rule management service by calling the global resource locator-->
        <!--<property name="ruleManagementService" ref="ruleManagementService" />-->
    </bean>

    <bean id="courseOfferingTransformer" class="org.kuali.student.enrollment.class2.courseoffering.service.transformer.CourseOfferingTransformer">
        <property name="lprService" ref="lprPersistenceServiceCache" />
        <property name="lrcService" ref="lrcServiceCache" />
        <property name="cluService" ref="CluService"/>
        <property name="luiService" ref="LuiService" />
        <property name="krmsRuleManagementCopyMethods" ref="krmsRuleManagementCopyMethods" />
    </bean>

    <bean id="regGroupCodeGeneratorFactory" class="org.kuali.student.enrollment.class2.courseoffering.service.impl.FourDigitRegistrationGroupCodeGeneratorFactory" />

    <bean id="coMockService" class="org.kuali.student.enrollment.class2.courseoffering.service.impl.CourseOfferingServiceImpl">
        <property name="courseService" ref="CourseService" />
        <property name="courseOfferingTransformer" ref="courseOfferingTransformer" />
        <property name="activityOfferingTransformer" ref="activityTransformer" />
        <property name="registrationGroupTransformer" ref="registrationGroupTransformer" />
    </bean>

    <!--<bean id="ks.exp.courseOfferingMockService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">-->
    <!--<property name="serviceDefinition">-->
    <!--<bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">-->
    <!--<property name="jaxWsService" value="true" />-->
    <!--<property name="service" ref="coMockService" />-->
    <!--<property name="serviceInterface" value="org.kuali.student.enrollment.courseoffering.service.CourseOfferingService" />-->
    <!--<property name="localServiceName" value="CourseOfferingMockService" />-->
    <!--<property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseOffering" />-->
    <!--<property name="busSecurity" value="${ks.enroll.bus.security}" />-->
    <!--</bean>-->
    <!--</property>-->
    <!--</bean>-->


    <bean id="rgAssembler" class="org.kuali.student.enrollment.class2.courseoffering.service.assembler.RegistrationGroupAssembler">
        <property name="luiService" ref="LuiService" />
        <property name="registrationGroupTransformer" ref="registrationGroupTransformer" />
    </bean>

    <bean id="registrationGroupTransformer" class="org.kuali.student.enrollment.class2.courseoffering.service.transformer.RegistrationGroupTransformer">
        <property name="luiService" ref="LuiService" />
    </bean>

    <!--<bean id="ks.exp.courseOfferingValidationService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">-->
    <!--<property name="serviceDefinition">-->
    <!--<bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">-->
    <!--<property name="jaxWsService" value="true" />-->
    <!--<property name="service" ref="coServiceValidation" />-->
    <!--<property name="serviceInterface" value="org.kuali.student.enrollment.courseoffering.service.CourseOfferingService" />-->
    <!--<property name="localServiceName" value="CourseOfferingService" />-->
    <!--<property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseOffering" />-->
    <!--<property name="busSecurity" value="${ks.enroll.bus.security}" />-->
    <!--</bean>-->
    <!--</property>-->
    <!--</bean>-->


    <!-- Setup natural language template information service -->
    <import resource="classpath:org/kuali/student/enrollment/krms/PropositionTypeTemplateData.xml"/>

    <bean id="templateResolverService" class="org.kuali.rice.krms.service.impl.TemplateRegistryImpl">
        <property name="templatesMap" ref="templatesMap"/>
    </bean>

    <bean id="ks.exp.templateResolverService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.JavaServiceDefinition">
                <property name="service" ref="templateResolverService" /> <!-- Must match id in the bean -->
                <property name="serviceInterface" value="org.kuali.rice.krms.service.TemplateRegistry" />
                <property name="localServiceName" value="templateResolverService" /> <!-- Part of the QName -->
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/templateResolverService" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- Exam Service beans -->
    <bean id="examServiceImpl" class="org.kuali.student.enrollment.class2.exam.service.impl.ExamServiceImpl">
        <property name="cluService" ref="CluService"/>
        <property name="examTransformer" ref="examTransformer"/>
    </bean>

    <bean id="examTransformer" class="org.kuali.student.enrollment.class2.exam.service.transformer.ExamTransformer">
        <property name="cluService" ref="CluService"/>
    </bean>

    <bean id="ks.exp.examService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="ExamService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.exam.service.ExamService" />
                <property name="localServiceName" value="ExamService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/exam" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- Exam Offering Service beans -->
    <bean id="examOfferingServiceImpl" class="org.kuali.student.enrollment.class2.examoffering.service.impl.ExamOfferingServiceImpl">
        <property name="luiService" ref="LuiService"/>
        <property name="schedulingService" ref="SchedulingService"/>
        <property name="typeService" ref="typeServiceCacheDecorator" />
        <property name="acalService" ref="AcademicCalendarService" />
        <property name="examOfferingTransformer" ref="examOfferingTransformer"/>
        <property name="stateTransitionsHelper" ref="stateTransitionsHelper"/>
    </bean>

    <bean id="examOfferingTransformer" class="org.kuali.student.enrollment.class2.examoffering.service.transformer.ExamOfferingTransformer">
        <property name="luiService" ref="LuiService"/>
    </bean>

    <bean id="ks.exp.examOfferingService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="ExamOfferingService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.examoffering.service.ExamOfferingService" />
                <property name="localServiceName" value="ExamOfferingService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/examOffering" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="examOfferingServiceFacade" class="org.kuali.student.enrollment.class2.examoffering.service.facade.ExamOfferingServiceFacadeImpl">
        <property name="atpService" ref="AtpService" />
        <property name="examService" ref="ExamService"/>
        <property name="courseOfferingService" ref="CourseOfferingService"/>
        <property name="examOfferingService" ref="ExamOfferingService"/>
        <property name="socService" ref="CourseOfferingSetService" />
        <property name="typeService" ref="typeServiceCacheDecorator" />
        <property name="scheduleEvaluator" ref="examOfferingScheduleEvaluator" />
        <property name="schedulingService" ref="SchedulingService"/>
        <property name="setLocation" value="${ks.enroll.examoffering.useAoLocation.defaultvalue}" />
        <property name="useFinalExamMatrix" value="${ks.enroll.examoffering.useFinalExamMatrix.defaultvalue}"/>
        <property name="generateEODynamically" value="${ks.enroll.examoffering.generateDynamic.defaultvalue}"/>
    </bean>

    <bean id="examOfferingScheduleEvaluator" class="org.kuali.student.enrollment.class2.examoffering.krms.evaluator.ExamOfferingSlottingEvaluatorImpl">
        <property name="schedulingService" ref="SchedulingService"/>
        <property name="courseService" ref="CourseService"/>
    </bean>

    <!-- Put facade on the bus -->
    <bean id="ks.exp.examOfferingServiceFacade" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.JavaServiceDefinition">
                <property name="service" ref="examOfferingServiceFacade" /> <!-- Must match id in the bean -->
                <property name="serviceInterface" value="org.kuali.student.enrollment.class2.examoffering.service.facade.ExamOfferingServiceFacade" />
                <property name="localServiceName" value="examOfferingServiceFacade" /> <!-- Part of the QName -->
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/examOfferingServiceFacade" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>


    <!-- Lui Service beans -->

    <bean id="luiServiceValidationDecorator" class=" org.kuali.student.enrollment.class1.lui.service.decorators.LuiServiceValidationDecorator">
        <property name="nextDecorator" ref="luiServiceCache" />
        <property name="validator" ref="validator" />
        <property name="typeService" ref="typeServiceCacheDecorator" />
    </bean>

    <bean id="luiServiceCache" class="org.kuali.student.enrollment.class1.lui.service.decorators.LuiServiceCacheDecorator">
        <property name="cacheManager" ref="ksCacheManager"/>
        <property name="nextDecorator" ref="luiServiceImpl"/>
    </bean>



    <bean id="luiServiceImpl" class="org.kuali.student.enrollment.class1.lui.service.impl.LuiServiceImpl">
        <property name="luiDao" ref="luiDao" />
        <property name="luiSetDao" ref="luiSetDao" />
        <property name="luiLuiRelationDao" ref="luiLuiRelationDao" />
        <property name="criteriaLookupService" ref="defaultCriteriaLookupService" />
    </bean>

    <bean id="ks.exp.luiService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="LuiService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.lui.service.LuiService" />
                <property name="localServiceName" value="LuiService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/lui" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="statementServiceImpl" class="org.kuali.student.r1.core.statement.service.impl.StatementServiceImpl">
        <property name="statementDao" ref="statementDao" />
        <property name="searchManager" ref="statementSearchManager" />
        <property name="dictionaryServiceDelegate" ref="dictionaryService" />
        <property name="naturalLanguageTranslator" ref="naturalLanguageTranslator" />
        <property name="statementAssembler" ref="statementAssembler" />
        <property name="validatorFactory" ref="validatorFactory" />
    </bean>

    <bean id="dictionaryService" class="org.kuali.student.r1.common.dictionary.service.impl.DictionaryServiceImpl">
        <constructor-arg index="0" value="classpath:ks-courseInfo-dictionary-context.xml" />
    </bean>

    <bean id="validatorFactory" class="org.kuali.student.r2.common.validator.ValidatorFactory">
        <property name="defaultValidator" ref="businessServiceValidator" />
    </bean>

    <bean id="businessServiceValidator" class="org.kuali.student.r2.common.service.impl.NoOpDefaultValidatorImpl" />

    <bean id="statementDao" class="org.kuali.student.r1.core.statement.dao.impl.StatementDaoImpl">
        <property name="em" ref="enrollEntityManager" />
    </bean>

    <bean id="statementSearchManager" class="org.kuali.student.r2.common.class1.search.SearchManagerImpl">
        <constructor-arg index="0" value="classpath:statement-search-config.xml" />
        <property name="dao" ref="enrollSearchableDao"/>
    </bean>

    <bean id="lprPersistenceService" class="org.kuali.student.enrollment.class1.lpr.service.impl.LprServiceImpl">
        <property name="lprDao" ref="lprDao" />
        <property name="lprTransactionDao" ref="lprTrasactionDao" />
        <property name="lprTransactionItemDao" ref="lprTrasactionItemDao" />
        <property name="criteriaLookupService" ref="defaultCriteriaLookupService" />
    </bean>

    <bean id="lprPersistenceServiceCache"
          class="org.kuali.student.enrollment.class1.lpr.service.decorators.LprServiceCacheDecorator">
        <property name="nextDecorator" ref="lprPersistenceService"/>
        <property name="cacheManager" ref="ksCacheManager"/>
    </bean>

    <bean id="lprServiceValidationDecorator"
          class="org.kuali.student.enrollment.class1.lpr.service.decorators.LprServiceValidationDecorator">
        <property name="nextDecorator" ref="lprPersistenceServiceCache"/>
        <property name="validator" ref="validator"/>
    </bean>

    <bean id="ks.exp.LprService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true"/>
                <property name="service" ref="LprService"/>
                <property name="serviceInterface" value="org.kuali.student.enrollment.lpr.service.LprService"/>
                <property name="localServiceName" value="LprService"/>
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/lpr"/>
                <property name="busSecurity" value="${ks.enroll.bus.security}"/>
            </bean>
        </property>
    </bean>

    <bean id="lrrPersistenceService" class="org.kuali.student.enrollment.class1.lrr.service.impl.LearningResultRecordServiceImpl">
        <property name="lrrDao" ref="lrrDao" />
        <property name="resultSourceDao" ref="resultSourceDao" />
    </bean>

    <bean id="lrcServiceValidation"
          class="org.kuali.student.r2.lum.lrc.service.impl.LRCServiceValidationDecorator">
        <property name="nextDecorator" ref="lrcServiceCache" />
        <property name="validator" ref="validator" />
    </bean>

    <bean id="lrcServiceCache" class="org.kuali.student.r2.lum.lrc.service.impl.LRCServiceCacheDecorator">
        <property name="nextDecorator" ref="lrcPersistenceService" />
        <property name="cacheManager" ref="ksCacheManager"/>
    </bean>

    <bean id="lrcPersistenceService" class="org.kuali.student.r2.lum.lrc.service.impl.LRCServiceImpl">
        <property name="resultValuesGroupDao" ref="resultValuesGroupDao" />
        <property name="resultValueDao" ref="resultValueDao" />
        <property name="resultScaleDao" ref="resultScaleDao" />
        <property name="lrcServiceBusinessLogic" ref="lrcServiceBusinessLogic" />
        <property name="resultScaleCriteriaLookupService">
            <bean parent="defaultCriteriaLookupService">
                <property name="predicateTransforms">
                    <list merge="false">
                        <bean parent="keyword2LikeTransform">
                            <property name="likeAttributes">
                                <!--                            Also scan the key when doing a keyword search-->
                                <list merge="true">
                                    <value>key</value>
                                    <value>typeKey</value>
                                    <value>stateKey</value>
                                </list>
                            </property>
                        </bean>
                        <bean class="org.kuali.student.r2.common.criteria.transform.RenameTransform">
                            <property name="renameAttributes">
                                <map>
                                    <entry key="typeKey" value="type"/>
                                    <entry key="stateKey" value="state"/>
                                    <entry key="resultValueRange.minValue" value="minValue"/>
                                    <entry key="resultValueRange.maxValue" value="maxValue"/>
                                    <entry key="resultValueRange.increment" value="increment"/>
                                </map>
                            </property>
                        </bean>
                        <ref bean="key2IdTransform"/>
                        <ref bean="descrTransform"/>
                        <ref bean="metaTransform"/>
                        <ref bean="attributeTransform"/>
                    </list>
                </property>
            </bean>
        </property>
        <property name="resultValueCriteriaLookupService">
            <bean parent="defaultCriteriaLookupService">
                <property name="predicateTransforms">
                    <list merge="false">
                        <bean parent="keyword2LikeTransform">
                            <property name="likeAttributes">
                                <!--                            Also scan the key when doing a keyword search-->
                                <list merge="true">
                                    <value>key</value>
                                    <value>resultScaleKey</value>
                                </list>
                            </property>
                        </bean>
                        <bean class="org.kuali.student.r2.common.criteria.transform.RenameTransform">
                            <property name="renameAttributes">
                                <map>
                                    <entry key="typeKey" value="type"/>
                                    <entry key="stateKey" value="state"/>
                                    <entry key="resultScaleKey" value="resultScaleId"/>
                                </map>
                            </property>
                        </bean>
                        <ref bean="key2IdTransform"/>
                        <ref bean="descrTransform"/>
                        <ref bean="metaTransform"/>
                        <ref bean="attributeTransform"/>
                    </list>
                </property>
            </bean>
        </property>
        <property name="resultValuesGroupCriteriaLookupService">
            <bean parent="defaultCriteriaLookupService">
                <property name="predicateTransforms">
                    <list merge="false">
                        <bean parent="keyword2LikeTransform">
                            <property name="likeAttributes">
                                <!--                                Also scan the key when doing a keyword search-->
                                <list merge="true">
                                    <value>key</value>
                                    <value>resultScaleKey</value>
                                </list>
                            </property>
                        </bean>
                        <bean class="org.kuali.student.r2.common.criteria.transform.RenameTransform">
                            <property name="renameAttributes">
                                <map>
                                    <entry key="typeKey" value="type"/>
                                    <entry key="stateKey" value="state"/>
                                    <entry key="resultScaleKey" value="resultScaleId"/>
                                    <entry key="resultValueRange.minValue" value="minValue"/>
                                    <entry key="resultValueRange.maxValue" value="maxValue"/>
                                    <entry key="resultValueRange.increment" value="increment"/>
                                </map>
                            </property>
                        </bean>
                        <ref bean="key2IdTransform"/>
                        <ref bean="descrTransform"/>
                        <ref bean="metaTransform"/>
                        <ref bean="attributeTransform"/>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <bean id="ks.exp.LRCService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="lrcServiceCache" />
                <property name="serviceInterface" value="org.kuali.student.r2.lum.lrc.service.LRCService" />
                <property name="localServiceName" value="LrcService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/lrc" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="gradeValuesGroupAssembler" class="org.kuali.student.enrollment.class2.grading.assembler.GradeValuesGroupAssembler" />

    <bean id="courseRegistrationServiceValidator"
          class="org.kuali.student.enrollment.class2.courseregistration.service.decorators.CourseRegistrationServiceValidationDecorator">
        <property name="validator" ref="validator" />
        <property name="nextDecorator" ref="courseRegistrationImpl" />
    </bean>

    <bean id="courseRegistrationImpl" class="org.kuali.student.enrollment.class2.courseregistration.service.impl.CourseRegistrationServiceImpl">
        <property name="lprService" ref="LprService" />
        <property name="courseOfferingService" ref="CourseOfferingService" />
        <property name="jmsTemplate" ref="jmsTemplate"/>
        <property name="registrationRequestTransformer" ref="registrationRequestTransformer"/>
    </bean>

    <bean id="registrationRequestTransformer" class="org.kuali.student.enrollment.class2.courseregistration.service.transformer.RegistrationRequestTransformer">
        <property name="lrcService" ref="LRCService"/>
    </bean>
    <bean id="completedCoursesResolver" class="org.kuali.student.enrollment.class1.lrr.termresolver.CompletedCoursesResolver">
        <property name="lprService" ref="LprService" />
        <property name="lrrService" ref="lrrPersistenceService" />
        <property name="luiService" ref="LuiService" />
    </bean>

    <bean id="rulesEvaluationUtil" class="org.kuali.student.r2.core.statement.util.RulesEvaluationUtil">
        <property name="termResolvers">
            <list>
                <ref bean="completedCoursesResolver" />
            </list>
        </property>
    </bean>

    <bean id="propositionBuilder" class="org.kuali.student.r2.core.statement.util.PropositionBuilder" />

    <bean id="ks.exp.courseRegistrationService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="CourseRegistrationService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.courseregistration.service.CourseRegistrationService" />
                <property name="localServiceName" value="CourseRegistrationService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseRegistrationService" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>


    <!-- Academic Record Service -->

    <!-- caching decorator -->
    <bean id="academicRecordService" class="org.kuali.student.enrollment.academicrecord.service.decorators.AcademicRecordServiceCachingDecorator">
        <property name="nextDecorator" ref="academicRecordServiceImpl" />
        <property name="cacheManager" ref="ksCacheManager" />
    </bean>

    <!-- federate history and current -->
    <bean id="academicRecordServiceImpl" class="org.kuali.student.enrollment.class2.academicrecord.service.impl.AcademicRecordServiceImpl">
        <property name="academicRecordServiceHistory" ref="academicRecordServiceHistory" />
        <property name="academicRecordServiceCurrent" ref="academicRecordServiceCurrent" />
    </bean>

    <bean id="academicRecordServiceHistory" class="org.kuali.student.enrollment.class2.academicrecord.service.impl.AcademicRecordServicePersistenceImpl">
        <property name="studentCourseRecordDao" ref="studentCourseRecordDao"/>
    </bean>

    <!-- current -->
    <bean id="academicRecordServiceCurrent" class="org.kuali.student.enrollment.class2.academicrecord.service.impl.AcademicRecordServiceCurrentImpl">
        <property name="courseRegService" ref="CourseRegistrationService" />
        <property name="courseRecordAssembler" ref="courseRecordAssembler" />
        <property name="courseOfferingService" ref="CourseOfferingService" />
        <property name="cluService" ref="CluService" />
    </bean>

    <!-- publish to the bus -->
    <bean id="ks.exp.academicRecordService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="academicRecordService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.academicrecord.service.AcademicRecordService" />
                <property name="localServiceName" value="AcademicRecordService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/academicrecord" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="courseRecordAssembler" class="org.kuali.student.enrollment.class2.academicrecord.service.assembler.StudentCourseRecordAssembler">
        <property name="atpService" ref="AtpService" />
        <property name="gradingService" ref="gradingService" />
        <property name="lrcService" ref="lrcServiceCache" />
        <property name="luiService" ref="LuiService" />
    </bean>

    <bean id="activityTransformer" class="org.kuali.student.enrollment.class2.courseoffering.service.transformer.ActivityOfferingTransformer" >
        <property name="krmsRuleManagementCopyMethods" ref="krmsRuleManagementCopyMethods" />
    </bean>

    <!-- Process Service -->
    <bean id="processService" class="org.kuali.student.r2.core.process.impl.ProcessServiceImpl">
        <property name="processDao" ref="processDao" />
        <property name="checkDao" ref="checkDao" />
        <property name="instructionDao" ref="instructionDao" />
        <property name="stateService" ref="stateServiceCacheDecorator" />
        <property name="criteriaLookupService" ref="defaultCriteriaLookupService"/>
    </bean>

    <bean id="processServiceValidationDecorator"
          class="org.kuali.student.r2.core.process.service.decorators.ProcessServiceValidationDecorator">
        <property name="nextDecorator" ref="processService"/>
        <property name="validator" ref="validator"/>
    </bean>

    <bean id="ks.exp.processService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="ProcessService" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.process.service.ProcessService" />
                <property name="localServiceName" value="ProcessService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/process" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- Appointment Service -->
    <bean id="appointmentWindowService" class="org.kuali.student.r2.core.class1.appointment.service.impl.AppointmentServiceImpl">
        <property name="appointmentWindowDao" ref="appointmentWindowDao"/>
        <property name="appointmentSlotDao" ref="appointmentSlotDao"/>
        <property name="appointmentDao" ref="appointmentDao"/>
        <property name="populationService" ref="populationServiceMock"/>
        <property name="criteriaLookupService" ref="defaultCriteriaLookupService"/>
    </bean>

    <bean id="ks.exp.appointmentWindowService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="appointmentWindowService" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.appointment.service.AppointmentService" />
                <property name="localServiceName" value="AppointmentService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/appointment" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- Population Mock service (currently used by AppointmentService (see below for PopulationService) -->
    <!--TODO: KSENROLL-12397 Remove PopulationServiceMockImpl from configuration for Appt Windows-->
    <bean id="populationServiceMock" class="org.kuali.student.r2.core.population.service.impl.mock.PopulationServiceMockImpl">
        <property name="populationDao" ref="populationDao" />
        <property name="populationRuleDao" ref="populationRuleDao" />
        <property name="criteriaLookupService" ref="defaultCriteriaLookupService" />
    </bean>

    <bean id="ks.exp.populationServiceMock" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="populationServiceMock" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.population.service.PopulationService" />
                <property name="localServiceName" value="PopulationMockService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/population" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>


    <!--- Population Service -->
    <bean id="populationServiceValidation" class="org.kuali.student.core.population.service.decorators.PopulationServiceValidatorDecorator">
        <property name="nextDecorator" ref="populationServiceEvaluationDecorator" />
        <property name="validator" ref="validator" />
    </bean>

    <bean id="populationServiceImpl" class="org.kuali.student.r2.core.population.service.impl.PopulationServiceImpl">
        <property name="populationDao" ref="populationDao" />
        <property name="populationRuleDao" ref="populationRuleDao" />
        <property name="criteriaLookupService" ref="defaultCriteriaLookupService" />
    </bean>

    <bean id="ks.exp.populationService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="PopulationService" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.population.service.PopulationService" />
                <property name="localServiceName" value="PopulationService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/population" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- enumeration service for Appt Rule Types -->
    <bean id="enumerationService" class="org.kuali.student.r2.core.class1.enumerationmanagement.service.impl.EnumerationManagementServiceImpl">
        <property name="enumDao" ref="enumDao"/>
        <property name="enumValueDao" ref="enumValueDao"/>
        <property name="enumContextValueDao" ref="enumContextValueDao"/>
        <property name="searchManager" ref="enumSearchManager" />
    </bean>

    <bean id="enumSearchManager"
          class="org.kuali.student.r2.common.class1.search.SearchManagerImpl">
        <constructor-arg index="0" value="classpath:em-search-config.xml" />
        <property name="dao" ref="enrollSearchableDao"/>
    </bean>

    <!-- Search service -->
    <bean id="apptWindowCountsSearchImpl" class="org.kuali.student.r2.common.class1.search.ApptWindowCountsSearchImpl">
        <property name="genericEntityDao" ref="searchDao"/>
    </bean>

    <bean id="courseOfferingHistorySearchImpl" class="org.kuali.student.r2.core.class1.search.CourseOfferingHistorySearchImpl">
        <property name="genericEntityDao" ref="searchDao"/>
        <property name="noOfYears" value="5"/>
    </bean>

    <bean id="CourseOfferingManagementSearchImpl" class="org.kuali.student.r2.core.class1.search.CourseOfferingManagementSearchImpl">
        <property name="entityManager" ref="enrollEntityManager"/>
    </bean>

    <!-- autoGen -->
    <bean id="AutogenCountSearchServiceImpl" class="org.kuali.student.enrollment.class2.courseoffering.service.search.CourseOfferingServiceAutogenCountSearchServiceImpl" autowire="autodetect">
    </bean>
    <!-- KSENROLL-9244 Create Course Offering Service Facade -->
    <bean id="courseOfferingServiceFacade" class="org.kuali.student.enrollment.class2.courseoffering.service.facade.CourseOfferingServiceFacadeImpl">
        <property name="coService" ref="CourseOfferingService" />
        <property name="activityOfferingClusterDao" ref="activityOfferingClusterDao" />
        <property name="typeService" ref="typeService" />
        <property name="courseService" ref="CourseService" />
        <property name="courseWaitListService" ref="courseWaitListService" />
        <property name="waitListServiceFacade" ref="courseWaitListServiceFacade" />
        <property name="examOfferingServiceFacade" ref="examOfferingServiceFacade" />
        <property name="searchService" ref="searchService" />
        <property name="courseOfferingServiceExtender" ref="courseOfferingServiceExtender"/>
    </bean>
    <!-- Export facade to bus -->
    <bean id="ks.exp.courseOfferingServiceFacade" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.JavaServiceDefinition">
                <property name="service" ref="courseOfferingServiceFacade" /> <!-- refers to bean id-->
                <property name="serviceInterface" value="org.kuali.student.enrollment.class2.courseoffering.service.facade.CourseOfferingServiceFacade" />
                <property name="localServiceName" value="CourseOfferingServiceFacade" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseOfferingServiceFacade" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- KSENROLL-10834 -->
    <bean id="courseOfferingServiceExtender" class="org.kuali.student.enrollment.class2.courseoffering.service.extender.CourseOfferingServiceExtenderImpl">
        <property name="activityOfferingTransformer" ref="activityTransformer" />
        <property name="registrationGroupTransformer" ref="registrationGroupTransformer" />
        <property name="searchService" ref="searchService" />
        <property name="schedulingService" ref="SchedulingService"/>
        <property name="roomService" ref="RoomService"/>
        <property name="socService" ref="CourseOfferingSetService"/>
    </bean>

    <!-- Export extender to bus -->
    <bean id="ks.exp.courseOfferingServiceExtender" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.JavaServiceDefinition">
                <property name="service" ref="courseOfferingServiceExtender" /> <!-- refers to bean id-->
                <property name="serviceInterface" value="org.kuali.student.enrollment.class2.courseoffering.service.extender.CourseOfferingServiceExtender" />
                <property name="localServiceName" value="CourseOfferingServiceExtender" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseOfferingServiceExtender" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- For now, acal KSENROLL-7384 -->
    <bean id="acalServiceFacade" class="org.kuali.student.r2.core.acal.service.facade.AcademicCalendarServiceFacadeImpl">
        <property name="acalService" ref="AcademicCalendarService" />
        <property name="atpService" ref="AtpService" />
        <property name="typeService" ref="typeService" />
    </bean>

    <!-- Put facade on the bus KSENROLL-7384 -->
    <bean id="ks.exp.acalServiceFacade" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.JavaServiceDefinition">
                <property name="service" ref="acalServiceFacade" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.acal.service.facade.AcademicCalendarServiceFacade" />
                <property name="localServiceName" value="AcademicCalendarServiceFacade" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/acalServiceFacade" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- For now, acal KSENROLL-8609 -->
    <bean id="csrServiceFacade" class="org.kuali.student.enrollment.class2.courseoffering.service.facade.CSRServiceFacadeImpl">
        <property name="coService" ref="CourseOfferingService"/>
        <property name="typeService" ref="typeService" />
        <property name="socService" ref="CourseOfferingSetService" />
    </bean>

    <!-- Put facade on the bus KSENROLL-8609 -->
    <bean id="ks.exp.csrServiceFacade" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.JavaServiceDefinition">
                <property name="service" ref="csrServiceFacade" /> <!-- Must match id in the bean -->
                <property name="serviceInterface" value="org.kuali.student.enrollment.class2.courseoffering.service.facade.CSRServiceFacade" />
                <property name="localServiceName" value="CSRServiceFacade" /> <!-- Part of the QName -->
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/csrServiceFacade" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="ksEventProcessor" class="org.kuali.student.poc.eventproc.KSEventProcessorImpl">
        <property name="coService" ref="CourseOfferingService"/>
        <property name="luiService" ref="LuiService" />
        <property name="socService" ref="CourseOfferingSetService" />
        <property name="stateService" ref="stateService" />
        <property name="schedulingService" ref="SchedulingService"/>
    </bean>

    <bean id="ks.exp.ksEventProcessor" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.JavaServiceDefinition">
                <property name="service" ref="ksEventProcessor" />
                <property name="serviceInterface" value="org.kuali.student.poc.eventproc.api.KSEventProcessor" />
                <property name="localServiceName" value="KSEventProcessor" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/ksEventProcessor" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- For rolling over, colocation, provides mapping from source ScheduleRequestSet to target ScheduleRequestSet -->
    <bean id="rolloverAssist" class="org.kuali.student.enrollment.class2.courseofferingset.service.facade.RolloverAssistImpl">
    </bean>

    <bean id="ks.exp.rolloverAssist" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.JavaServiceDefinition">
                <property name="service" ref="rolloverAssist" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.class2.courseofferingset.service.facade.RolloverAssist" />
                <property name="localServiceName" value="RolloverAssist" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/rolloverAssist" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="ActivityOfferingSearchServiceImpl" class="org.kuali.student.r2.core.class1.search.ActivityOfferingSearchServiceImpl">
        <property name="entityManager" ref="enrollEntityManager"/>
    </bean>
    <bean id="InstructorSearchServiceImpl" class="org.kuali.student.r2.core.class1.search.InstructorSearchServiceImpl">
        <property name="entityManager" ref="enrollEntityManager"/>
    </bean>
    <bean id="CourseRegistrationSearchServiceImpl" class="org.kuali.student.enrollment.registration.search.service.impl.CourseRegistrationSearchServiceImpl">
        <property name="entityManager" ref="enrollEntityManager"/>
    </bean>

    <!-- KSENROLL-9340 Overriding this to use the same EM as the services that change the db
     This was causing problems since scheduling service was using enroll EM and changing things,
     but the search was using core EM and not picking up the changes -->
    <bean id="CoreSearchServiceImpl" class="org.kuali.student.r2.core.class1.search.CoreSearchServiceImpl">
        <property name="entityManager" ref="enrollEntityManager"/>
    </bean>

    <bean id="searchService" class="org.kuali.student.r2.common.class1.search.SearchServiceDispatcherImpl">
        <property name="searchServices">
            <list>
                <ref bean="apptWindowCountsSearchImpl" />
                <ref bean="courseOfferingHistorySearchImpl"/>
                <ref bean="CourseOfferingManagementSearchImpl"/>
                <ref bean="AutogenCountSearchServiceImpl"/>
                <ref bean="ActivityOfferingSearchServiceImpl"/>
                <ref bean="CoreSearchServiceImpl"/> <!-- This bean lives in ks-core-no-tx-context.xml  -->
                <ref bean="InstructorSearchServiceImpl"/>
                <ref bean="CourseRegistrationSearchServiceImpl"/>
            </list>
        </property>
    </bean>


    <bean id="ks.exp.searchService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="searchService" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.search.service.SearchService" />
                <property name="localServiceName" value="SearchService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/search" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- Hold Service -->
    <bean id="holdService" class="org.kuali.student.enrollment.class1.hold.service.impl.HoldServiceImpl">
        <property name="holdIssueDao" ref="holdIssueDao"/>
        <property name="appliedHoldDao" ref="appliedHoldDao"/>
        <property name="criteriaLookupService" ref="holdCriteriaLookupService"/>
    </bean>

    <bean id="holdCriteriaLookupService" parent="defaultCriteriaLookupService">
        <property name="predicateTransforms">
            <list merge="true">
                <bean class="org.kuali.student.r2.common.criteria.transform.RenameTransform">
                    <property name="renameAttributes">
                        <map>
                            <entry key="descr.plain" value="plain"/>
                            <entry key="descr.formatted" value="formatted"/>
                            <entry key="typeKey" value="holdIssueType"/>
                            <entry key="stateKey" value="holdIssueState"/>
                        </map>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <bean id="holdServiceDerivedState" class="org.kuali.student.enrollment.class1.hold.service.decorators.HoldServiceDerivedStateDecorator">
        <property name="nextDecorator" ref="holdService"/>
        <property name="academicCalendarService" ref="AcademicCalendarService"/>
    </bean>

    <bean id="holdServiceValidation" class="org.kuali.student.enrollment.class1.hold.service.decorators.HoldServiceValidationDecorator">
        <property name="nextDecorator" ref="holdServiceDerivedState"/>
        <property name="validator" ref="validator"/>
    </bean>

    <bean id="ks.exp.holdService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="HoldService" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.hold.service.HoldService" />
                <property name="localServiceName" value="HoldService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/hold" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- Org Service -->
    <bean id="orgServiceImplNew" class="org.kuali.student.r2.core.class1.organization.service.impl.OrganizationServiceImpl">
        <property name="organizationDao" ref="orgDao" />
        <property name="extendedOrgDao" ref="extendedOrgDao" />
        <property name="searchManager" ref="orgSearchManager" />
        <property name="dictionaryServiceDelegate" ref="dictionaryService"/>
        <property name="criteriaLookupService" ref="defaultCriteriaLookupService"/>
        <property name="searchOperations">
            <map>
                <entry key="org.search.orgQuickViewByRelationTypeOrgTypeRelatedOrgIds" value-ref="organizationHierarchySearch"/>
            </map>
        </property>
    </bean>

    <bean id="organizationHierarchySearch"
          class="org.kuali.student.r1.core.organizationsearch.service.impl.OrganizationHierarchySearch">
        <property name="organizationDao" ref="orgDao"/>
    </bean>

    <bean id="orgSearchManager"
          class="org.kuali.student.r2.common.class1.search.SearchManagerImpl">
        <constructor-arg index="0" value="classpath:organization-search-config.xml" />
        <property name="dao" ref="enrollSearchableDao"/>
    </bean>

    <bean id="ks.exp.organizationService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="orgServiceImplNew" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.organization.service.OrganizationService" />
                <property name="localServiceName" value="OrganizationService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/organization" />
                <property name="busSecurity" value="${ks.core.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- Scheduling Service -->
    <bean id="schedulingServiceImpl" class="org.kuali.student.r2.core.scheduling.service.impl.SchedulingServiceImpl">
        <property name="atpService" ref="AtpService"/>
        <property name="typeService" ref="typeService"/>
        <property name="roomService" ref="RoomService"/>
        <property name="scheduleRequestSetDao" ref="scheduleRequestSetDao"/>
        <property name="scheduleRequestDao" ref="scheduleRequestDao"/>
        <property name="timeSlotDao" ref="timeSlotDao"/>
        <property name="scheduleDao" ref="scheduleDao"/>
        <property name="criteriaLookupService">
            <bean parent="defaultCriteriaLookupService">
                <property name="predicateTransforms">
                    <list merge="false">
                        <!-- Don't include the keyword2like transformer -->
                        <ref bean="descrTransform"/>
                        <ref bean="metaTransform"/>
                        <ref bean="attributeTransform"/>
                    </list>
                </property>
            </bean>
        </property>

        <property name="timeSlotCodeGenerator" ref="timeSlotCodeGenerator" />
    </bean>

    <bean id="schedulingServiceValidationDecorator" class="org.kuali.student.r2.core.scheduling.service.decorators.SchedulingServiceValidationDecorator">
        <property name="nextDecorator" ref="schedulingServiceCache"/>
        <property name="validator" ref="validator"/>
    </bean>

    <bean id="schedulingServiceCache" class="org.kuali.student.r2.core.scheduling.service.decorators.SchedulingServiceCacheDecorator">
        <property name="cacheManager" ref="ksCacheManager"/>
        <property name="nextDecorator" ref="schedulingServiceImpl"/>
    </bean>

    <bean id="ks.exp.schedulingService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="SchedulingService" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.scheduling.service.SchedulingService" />
                <property name="localServiceName" value="SchedulingService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/scheduling" />
                <property name="busSecurity" value="${ks.core.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="roomServiceValidation"
          class="org.kuali.student.r2.core.room.service.decorators.RoomServiceValidationDecorator">
        <property name="nextDecorator" ref="roomServiceCache" />
        <property name="validator" ref="validator" />
    </bean>

    <bean id="roomServiceCache" class="org.kuali.student.r2.core.room.service.decorators.RoomServiceCacheDecorator">
        <property name="cacheManager" ref="ksCacheManager"/>
        <property name="nextDecorator" ref="roomServiceImpl"/>
    </bean>

    <bean id="roomServiceImpl" class="org.kuali.student.r2.core.room.service.impl.RoomServiceImpl">
        <property name="buildingServiceDao" ref="buildingServiceDao" />
        <property name="roomServiceDao" ref="roomServiceDao" />
        <property name="roomResponsibleOrgDao" ref="roomResponsibleOrgDao" />
        <property name="criteriaLookupService" ref="defaultCriteriaLookupService"/>
    </bean>

    <bean id="roomSearchManager"
          class="org.kuali.student.r2.common.class1.search.SearchManagerImpl">
        <constructor-arg index="0" value="classpath:em-search-config.xml" />
        <property name="dao" ref="enrollSearchableDao"/>
    </bean>

    <bean id="ks.exp.roomService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="RoomService" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.room.service.RoomService" />
                <property name="localServiceName" value="RoomService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/room" />
                <property name="busSecurity" value="${ks.core.bus.security}" />
            </bean>
        </property>
    </bean>


    <!-- End Room Service Mock Impl -->


    <!--This is a ref data utility that should be removed in the future -->
    <bean id="CluFixer" class="org.kuali.student.enrollment.class2.courseoffering.refdata.CluFixerImpl">
        <property name="coService" ref="CourseOfferingService"/>
        <property name="courseService" ref="CourseService"/>
    </bean>

    <bean id="ks.exp.cluFixer" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.JavaServiceDefinition">
                <property name="service" ref="CluFixer" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.class2.courseoffering.refdata.CluFixer"/>
                <property name="localServiceName" value="CluFixer" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/cluFixer" />
                <property name="busSecurity" value="${ks.core.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- This class is needed to create a different transactional boundary for the ActivityOfferingController class-->
    <bean id="controllerTransactionHelper" class="org.kuali.student.enrollment.class2.courseoffering.controller.ControllerTransactionHelperImpl"/>
    <bean id="ks.exp.controllerTransactionHelper" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.JavaServiceDefinition">
                <property name="service" ref="controllerTransactionHelper" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.class2.courseoffering.controller.ControllerTransactionHelper"/>
                <property name="localServiceName" value="ControllerTransactionHelper" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/controllerTransactionHelper" />
                <property name="busSecurity" value="${ks.core.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="scheduleOfClassesService" class="org.kuali.student.enrollment.registration.client.service.impl.ScheduleOfClassesServiceImpl">
        <property name="entityManager" ref="enrollEntityManager" />
        <property name="atpService" ref="AtpService"/>
        <property name="luiService" ref="LuiService"/>
        <property name="lrcService" ref="lrcServiceCache" />
        <property name="ksIdentityServiceHelper" ref="ksIdentityServiceHelper"/>
    </bean>

    <bean id="scheduleOfClassesServiceCache" class="org.kuali.student.enrollment.registration.client.service.impl.ScheduleOfClassesServiceCacheImpl">
        <property name="entityManager" ref="enrollEntityManager" />
        <property name="luiService" ref="LuiService"/>
        <property name="atpService" ref="AtpService"/>
        <property name="lrcService" ref="lrcServiceCache" />
        <property name="ksIdentityServiceHelper" ref="ksIdentityServiceHelper"/>
        <property name="cacheManager" ref="ksCacheManager" />
    </bean>

    <bean id="scheduleOfClassesServiceElastic" class="org.kuali.student.enrollment.registration.client.service.impl.ScheduleOfClassesServiceElasticImpl">
        <property name="entityManager" ref="enrollEntityManager" />
        <property name="luiService" ref="LuiService"/>
        <property name="atpService" ref="AtpService"/>
        <property name="lrcService" ref="lrcServiceCache" />
        <property name="ksIdentityServiceHelper" ref="ksIdentityServiceHelper"/>
        <property name="elasticEmbedded" ref="elasticEmbedded"/>
        <property name="cacheManager" ref="ksCacheManager" />
    </bean>

    <bean id="ks.exp.scheduleOfClassesService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.JavaServiceDefinition">
                <property name="service" ref="scheduleOfClassesService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.registration.client.service.ScheduleOfClassesService"/>
                <property name="localServiceName" value="ScheduleOfClassesService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/scheduleOfClasses" />
                <property name="busSecurity" value="${ks.core.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="scheduleOfClassesClientService" class="org.kuali.student.enrollment.registration.client.service.impl.ScheduleOfClassesClientServiceImpl">
        <property name="elasticEmbedded" ref="elasticEmbedded"/>
        <property name="cacheManager" ref="ksCacheManager" />
        <property name="atpService" ref="AtpService"/>
        <property name="ksIdentityServiceHelper" ref="ksIdentityServiceHelper"/>
    </bean>

    <bean id="ks.exp.scheduleOfClassesClientService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.RestServiceDefinition">
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/scheduleOfClassesClient" />
                <property name="service" ref="scheduleOfClassesClientService" />
                <property name="resourceClass" value="org.kuali.student.enrollment.registration.client.service.ScheduleOfClassesClientService" />
                <property name="localServiceName" value="ScheduleOfClassesClientService" />
                <property name="providers">
                    <list>
                        <bean class="org.kuali.student.enrollment.registration.client.service.impl.CustomHeaderJacksonJsonProvider">
                            <property name="headers">
                                <map>
                                    <entry key="Access-Control-Allow-Origin" value="http://127.0.0.1:9000"/>
                                    <entry key="Access-Control-Allow-Methods" value="POST, GET, OPTIONS"/>
                                    <entry key="Access-Control-Allow-Header" value="Content-Type"/>
                                </map>
                            </property>
                        </bean>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <bean id="courseRegistrationClientService" class="org.kuali.student.enrollment.registration.client.service.impl.CourseRegistrationClientServiceImpl">
        <property name="scheduleOfClassesService" ref="scheduleOfClassesServiceElastic"/>
        <property name="ksIdentityServiceHelper"   ref="ksIdentityServiceHelper"/>
    </bean>

    <bean id="ks.exp.courseRegistrationClientService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.RestServiceDefinition">
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseRegistrationClient" />
                <property name="service" ref="courseRegistrationClientService" />
                <property name="resourceClass" value="org.kuali.student.enrollment.registration.client.service.CourseRegistrationClientService" />
                <property name="localServiceName" value="CourseRegistrationClientService" />
                <property name="providers">
                    <list>
                        <bean class="org.kuali.student.enrollment.registration.client.service.impl.CustomHeaderJacksonJsonProvider">
                            <property name="headers">
                                <map>
                                    <entry key="Access-Control-Allow-Origin" value="http://127.0.0.1:9000"/>
                                    <entry key="Access-Control-Allow-Methods" value="POST, GET, OPTIONS"/>
                                    <entry key="Access-Control-Allow-Header" value="Content-Type"/>
                                </map>
                            </property>
                        </bean>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <bean id="courseRegistrationCartService" class="org.kuali.student.enrollment.registration.client.service.impl.CourseRegistrationCartServiceImpl">
        <property name="courseRegistrationService" ref="CourseRegistrationService"/>
        <property name="lprService" ref="LprService"/>
        <property name="ksIdentityServiceHelper"   ref="ksIdentityServiceHelper"/>
    </bean>

    <bean id="ks.exp.courseRegistrationCartService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.JavaServiceDefinition">
                <property name="service" ref="courseRegistrationCartService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.registration.client.service.CourseRegistrationCartService"/>
                <property name="localServiceName" value="CourseRegistrationCartClientService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseRegistrationCart" />
                <property name="busSecurity" value="${ks.core.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- the rest clients should be using the elastic impls where possible -->
    <bean id="courseRegistrationCartClientService" class="org.kuali.student.enrollment.registration.client.service.impl.CourseRegistrationCartClientServiceImpl" >
        <property name="scheduleOfClassesService" ref="scheduleOfClassesServiceElastic" />
        <property name="ksIdentityServiceHelper"   ref="ksIdentityServiceHelper"/>
    </bean>

    <bean id="ks.exp.courseRegistrationCartClientService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.RestServiceDefinition">
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseRegistrationCartClient" />
                <property name="service" ref="courseRegistrationCartClientService" />
                <property name="resourceClass" value="org.kuali.student.enrollment.registration.client.service.CourseRegistrationCartClientService" />
                <property name="localServiceName" value="CourseRegistrationCartClientService" />
                <property name="providers">
                    <list>
                        <bean class="org.kuali.student.enrollment.registration.client.service.impl.CustomHeaderJacksonJsonProvider">
                            <property name="headers">
                                <map>
                                    <entry key="Access-Control-Allow-Origin" value="http://127.0.0.1:9000"/>
                                    <entry key="Access-Control-Allow-Methods" value="POST, GET, OPTIONS"/>
                                    <entry key="Access-Control-Allow-Header" value="Content-Type"/>
                                </map>
                            </property>
                        </bean>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <bean id="courseRegistrationAdminClientService" class="org.kuali.student.enrollment.registration.client.service.impl.CourseRegistrationAdminClientServiceImpl">
    </bean>

    <bean id="ks.exp.courseRegistrationAdminClientService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.RestServiceDefinition">
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseRegistrationAdminClient" />
                <property name="service" ref="courseRegistrationAdminClientService" />
                <property name="resourceClass" value="org.kuali.student.enrollment.registration.client.service.CourseRegistrationAdminClientService" />
                <property name="localServiceName" value="CourseRegistrationAdminClientService" />
                <property name="providers">
                    <list>
                        <bean class="org.kuali.student.enrollment.registration.client.service.impl.CustomHeaderJacksonJsonProvider">
                            <property name="headers">
                                <map>
                                    <entry key="Access-Control-Allow-Origin" value="http://127.0.0.1:9000"/>
                                    <entry key="Access-Control-Allow-Methods" value="POST, GET, OPTIONS"/>
                                    <entry key="Access-Control-Allow-Header" value="Content-Type"/>
                                </map>
                            </property>
                        </bean>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <bean id="developerLoginClientService" class="org.kuali.student.enrollment.registration.client.service.impl.DevelopmentLoginClientServiceImpl">
    </bean>

    <bean id="ks.exp.developerLoginClientService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.RestServiceDefinition">
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/developerLoginClient" />
                <property name="service" ref="developerLoginClientService" />
                <property name="resourceClass" value="org.kuali.student.enrollment.registration.client.service.DevelopmentLoginClientService" />
                <property name="localServiceName" value="DevelopmentLoginClientService" />
                <property name="providers">
                    <list>
                        <bean class="org.kuali.student.enrollment.registration.client.service.impl.CustomHeaderJacksonJsonProvider">
                            <property name="headers">
                                <map>
                                    <entry key="Access-Control-Allow-Origin" value="http://127.0.0.1:9000"/>
                                    <entry key="Access-Control-Allow-Methods" value="POST, GET, OPTIONS"/>
                                    <entry key="Access-Control-Allow-Header" value="Content-Type"/>
                                </map>
                            </property>
                        </bean>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <!--
        StaticUserDateClientService

        This is a RESTful service used in conjunction with the registration cart. It allows
        a static date to be set (in memory) for a user for reg cart date testing purposes.
    -->
    <bean id="staticUserDateClientService" class="org.kuali.student.enrollment.registration.client.service.impl.StaticUserDateClientServiceImpl" />
    <bean id="ks.exp.staticUserDateClientService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.RestServiceDefinition">
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/staticUserDateClient" />
                <property name="service" ref="staticUserDateClientService" />
                <property name="resourceClass" value="org.kuali.student.enrollment.registration.client.service.StaticUserDateClientService" />
                <property name="localServiceName" value="StaticUserDateClientService" />
                <property name="providers">
                    <list>
                        <bean class="org.kuali.student.enrollment.registration.client.service.impl.CustomHeaderJacksonJsonProvider">
                            <property name="headers">
                                <map>
                                    <entry key="Access-Control-Allow-Origin" value="http://127.0.0.1:9000"/>
                                    <entry key="Access-Control-Allow-Methods" value="POST, GET, OPTIONS"/>
                                    <entry key="Access-Control-Allow-Header" value="Content-Type"/>
                                </map>
                            </property>
                        </bean>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <!--
        StaticUserDateUtil

        This is a util used to pre-set static dates on specific users for functional testing.
        Adding them here prevents the need for having to manually set them every time we test.
    -->
    <bean id="staticUserDateUtil" class="org.kuali.student.enrollment.registration.client.service.impl.util.StaticUserDateUtil">
        <property name="userDateMap" ref="regUserMap" />
        <property name="useStaticDates" value="true" />
    </bean>

    <util:map id="regUserMap">
        <!-- Registration Open window -->
        <entry key="admin" value="2012-09-05@00:01" />
        <entry key="martha" value="2012-09-05@00:01" />
        <entry key="carol" value="2012-09-05@00:01" />
        <entry key="student" value="2012-09-05@00:01" />
        <entry key="R.AARONE" value="2012-09-05@00:01" />
        <entry key="B.EILEENB" value="2012-09-05@00:01" />
        <entry key="B.EILEENL" value="2012-09-05@00:01" />
        <entry key="E.DMITRYL" value="2012-09-05@00:01" />
        <entry key="B.ELEANORB" value="2012-09-05@00:01" />
        <entry key="E.SOOB" value="2012-09-05@00:01" />
        <entry key="B.JANEK" value="2012-09-05@00:01" />
        <entry key="R.NELSONV" value="2012-09-05@00:01" />
        <entry key="B.CORAB" value="2012-09-05@00:01" />
        <entry key="B.EMILYC" value="2012-09-05@00:01" />
        <entry key="B.JASMINK" value="2012-09-05@00:01" />
        <entry key="B.JEFFREYG" value="2012-09-05@00:01" />
        <entry key="B.HUGOS" value="2012-09-05@00:01" />
        <entry key="B.PHILIPB" value="2012-09-05@00:01" />
        <entry key="E.SONALIK" value="2012-03-05@00:01" />
        <entry key="E.STEVENJ" value="2012-10-22@00:01" />
        <entry key="e.monicaf" value="2011-09-05@00:01" />
        <entry key="e.nancyf" value="2013-09-05@00:01" />
        <entry key="TestStudent" value="2014-06-23@09:05" />
        <entry key="student1" value="2012-09-05@00:01" />
        <entry key="student2" value="2012-09-05@00:01" />
        <entry key="student3" value="2012-09-05@00:01" />
        <entry key="student4" value="2012-09-05@00:01" />
        <entry key="student5" value="2012-09-05@00:01" />
        <entry key="student6" value="2012-09-05@00:01" />
        <entry key="student7" value="2012-09-05@00:01" />
        <entry key="student8" value="2012-09-05@00:01" />
        <entry key="student9" value="2012-09-05@00:01" />
        <entry key="L.RYANA" value="2012-09-05@00:01" />
        <entry key="L.SARAK" value="2012-09-05@00:01" />
        <entry key="L.SONIAN" value="2012-09-05@00:01" />
        <entry key="L.VICTORP" value="2012-09-05@00:01" />
        <entry key="R.JESSEA" value="2012-09-05@00:01" />
        <entry key="R.JESSICAL" value="2012-09-05@00:01" />
        <entry key="R.JESSICAR" value="2012-09-05@00:01" />
        <entry key="R.JOANL" value="2012-09-05@00:01" />
        <entry key="R.JODIT" value="2012-09-05@00:01" />
        <entry key="R.JODYB" value="2012-09-05@00:01" />
        <entry key="R.JOEL-FRANCOISD" value="2012-09-05@00:01" />
        <entry key="R.JOEM" value="2012-09-05@00:01" />
        <entry key="R.JOER" value="2012-09-05@00:01" />
        <entry key="R.JOHANNAC" value="2012-09-05@00:01" />
        <entry key="R.JOHNG" value="2012-09-05@00:01" />
        <entry key="R.JOHNL" value="2012-09-05@00:01" />
        <entry key="R.JOHNM" value="2012-09-05@00:01" />
        <entry key="R.JONATHANT" value="2012-09-05@00:01" />
        <entry key="SYSTEM" value="2012-09-05@00:01" />
        <!-- Drop Period window: student can drop courses, but not add or edit -->
        <entry key="R.IANK" value="2012-09-14@00:01" />
        <!-- Drop Period window closed: student cannot drop, add, or edit -->
        <entry key="R.IANP" value="2012-11-10@00:01" />

        <!-- Appointments -->
        <!-- Student with appointment with system date prior to Early reg period -
             Has appointment at 2012-03-14 15:15:00 -->
        <entry key="a.timothyg" value="2012-03-01@00:01" />

        <!-- Student with appointment with a system date prior to appointment time but within the appointment reg period -
             Has appointment at 2012-04-14 15:30:00 -->
        <entry key="a.tobiasj" value="2012-04-10@00:01" />

        <!-- Student with appointment with a system date on or after appointment but within the appointment reg period -
             Has appointment at 2012-05-04 15:45:00 -->
        <entry key="a.travisc" value="2012-05-05@00:01" />

        <!-- Student without appointment with a system date within the appointment reg period -->
        <entry key="a.terrym" value="2012-04-10@00:01" />

        <!-- Student without appointment with a system date during non appointment reg period -->
        <entry key="a.susanh" value="2012-06-10@00:01" />

        <!-- KSAP users -->
        <!-- Registration Open window for Spring 2014-->
        <entry key="b.joels" value="2014-01-31@00:01" />
        <entry key="b.nanal" value="2014-01-31@00:01" />
        <!-- Registration is closed for Spring 2014 -->
        <entry key="b.julil" value="2014-02-08@00:01" />
        <!-- Registration Open window for Summer1 2014-->
        <entry key="b.amandak" value="2014-05-24@00:01" />

        <!-- student with hold for fall 2012 -->
        <entry key="A.JANED" value="2012-09-05@00:01" />
    </util:map>

    <!-- Batch Scheduler: the bean is defined in ks-enroll-batch-context.xml. -->
    <bean id="ks.exp.batchScheduler" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.JavaServiceDefinition">
                <property name="service" ref="batchScheduler" /> <!-- Must match id in the bean -->
                <property name="serviceInterface" value="org.kuali.student.enrollment.batch.BatchScheduler" />
                <property name="localServiceName" value="BatchScheduler" /> <!-- Part of the QName -->
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/batch" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>


    <bean id="courseRegistrationServiceProcessCheckDecorator" class="org.kuali.student.enrollment.class2.courseregistration.service.decorators.CourseRegistrationServiceProcessCheckDecorator" >
        <property name="nextDecorator" ref="courseRegistrationImpl"/>
        <property name="krmsEvaluator" ref="krmsEvaluator"/>
        <property name="waitlistService" ref="courseWaitListServiceImpl"/>
        <property name="courseOfferingService" ref="CourseOfferingService"/>
    </bean>


    <bean id="krmsEvaluator" class="org.kuali.student.core.process.evaluator.KRMSEvaluator" >
        <property name="defaultFacts">
            <map>
                <!--needed services-->
                <entry key="processService" value-ref="processService"/>
                <entry key="populationService" value-ref="PopulationService"/>
                <entry key="atpService" value-ref="AtpService"/>
                <entry key="holdService" value-ref="holdService"/>
                <entry key="ruleFactory" value-ref="ruleFactoryImpl"/>
                <entry key="gesService" value-ref="GesService"/>
                <entry key="courseOfferingService" value-ref="CourseOfferingService"/>
                <entry key="exemptionService" value-ref="ExemptionService"/>
                <entry key="courseRegistrationService" value-ref="CourseRegistrationService"/>
                <entry key="courseWaitListService" value-ref="courseWaitListService"/>
                <entry key="schedulingService" value-ref="SchedulingService"/>
                <entry key="requisitesService" value-ref="requisitesServiceCachedImpl"/>
                <!--flag to tell if should log sucesses as well as failures-->
                <entry key="shouldRecordInstructionSuccesses" >
                    <bean class="java.lang.Boolean">
                        <constructor-arg value="true" />
                    </bean>
                </entry>
            </map>
        </property>
        <property name="termResolvers">
            <list>
                <bean class="org.kuali.student.core.krms.termresolver.PersonId2DeceasedDateTermResolver">
                    <property name="identityService" ref="coreIdentityServiceClient" />
                </bean>
                <bean class="org.kuali.student.core.krms.termresolver.ContextInfo2AsOfDateTermResolver" />
                <bean class="org.kuali.student.core.krms.termresolver.AtpId2AtpTermResolver">
                    <property name="atpService" ref="AtpService" />
                </bean>
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.DateInKeyDateRangeTermResolver">
                    <property name="atpService" ref="AtpService" />
                </bean>
                <bean class="org.kuali.student.enrollment.krms.termresolver.CluId2CluInfoTermResolver">
                    <property name="cluService" ref="CluService"/>
                </bean>
                <bean class="org.kuali.student.enrollment.krms.termresolver.CluId2CluVersionIndIdTermResolver">
                    <property name="cluService" ref="CluService"/>
                </bean>
                <bean class="org.kuali.student.enrollment.krms.termresolver.RegistrationGroup2CluIdTermResolver">
                    <property name="luiService" ref="LuiService"/>
                </bean>
                <bean class="org.kuali.student.enrollment.krms.termresolver.RegistrationRequest2PersonIdTermResolver" />
                <bean class="org.kuali.student.enrollment.krms.termresolver.RegistrationRequest2AtpIdTermResolver" />
                <bean class="org.kuali.student.enrollment.krms.termresolver.RegistrationRequestId2RegistrationRequestTermResolver">
                    <property name="courseRegistrationService" ref="CourseRegistrationService" />
                </bean>
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.RegistrationGroupStateTermResolver" />
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.StudentWithGradeForCourseTermResolver" />
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.CourseTotalAttemptsTermResolver" />
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.CourseRecordForStudentTermResolver">
                    <property name="academicRecordService" ref="academicRecordService"/>
                </bean>
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.MaxRepeatabilityTermResolver">
                    <property name="gesService" ref="GesService"/>
                </bean>
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.CourseRepeatabilityTermResolver" />
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.CourseRegistrationKeyDateTermResolver">
                    <property name="atpService" ref="AtpService"/>
                    <property name="luiService" ref="LuiService"/>
                    <property name="cacheManager" ref="ksCacheManager" />
                </bean>
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.ScheduleAdjustmentEndTermResolver">
                    <property name="atpService" ref="AtpService"/>
                    <property name="luiService" ref="LuiService"/>
                    <property name="cacheManager" ref="ksCacheManager" />
                </bean>
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.DropPeriodEndTermResolver">
                    <property name="atpService" ref="AtpService"/>
                    <property name="luiService" ref="LuiService"/>
                    <property name="cacheManager" ref="ksCacheManager" />
                </bean>
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.UserActionDateTermResolver" />
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.CourseWaitlistedAttemptsTermResolver">
                    <property name="cluService" ref="CluService" />
                    <property name="courseOfferingService" ref="CourseOfferingService" />
                </bean>
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.CourseSimulatedAttemptsTermResolver">
                    <property name="cluService" ref="CluService" />
                    <property name="courseOfferingService" ref="CourseOfferingService" />
                </bean>
                <bean class="org.kuali.student.enrollment.krms.termresolver.BestEffortCreditLoadTermResolver">
                    <property name="countWaitlistedCoursesTowardsCreditLimit" value="true"/>
                </bean>
                <bean class="org.kuali.student.enrollment.krms.termresolver.BestEffortTimeConflictTermResolver">
                    <property name="courseOfferingService" ref="CourseOfferingServiceCached" />
                    <property name="scheduleOfClassesService" ref="scheduleOfClassesServiceCache" />
                    <property name="countWaitlistedCoursesTowardsTimeConflict" value="true"/>
                </bean>
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.MaxCreditsTermResolver">
                    <property name="gesService" ref="GesService" />
                </bean>
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.AppointmentWindowTermResolver">
                    <property name="appointmentService" ref="appointmentWindowService" />
                    <property name="atpService" ref="AtpService" />
                </bean>
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.NumberOfCompletedCoursesTermResolver">
                    <property name="cluService" ref="CluService" />
                    <property name="academicRecordService" ref="academicRecordService" />
                </bean>
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.CreditsEarnedFromCoursesTermResolver">
                    <property name="cluService" ref="CluService" />
                    <property name="academicRecordService" ref="academicRecordService" />
                </bean>
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.CompletedCourseTermResolver">
                    <property name="cluService" ref="CluService" />
                    <property name="academicRecordService" ref="academicRecordService" />
                </bean>
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.CourseAddDatesTermResolver">
                    <property name="appointmentService" ref="appointmentWindowService" />
                    <property name="atpService" ref="AtpService" />
                </bean>
                <bean class="org.kuali.student.enrollment.class2.courseoffering.krms.termresolver.CourseRegisteredCountTermResolver">
                    <property name="courseOfferingService" ref="CourseOfferingService" />
                </bean>
            </list>
        </property>
    </bean>
    <bean id="ruleFactoryImpl" class="org.kuali.student.core.krms.rule.RuleFactoryImpl" >
    </bean>

    <bean id="requisitesServiceCachedImpl" class="org.kuali.student.enrollment.class2.courseoffering.krms.service.impl.RequisitesServiceCachedImpl">
        <property name="cacheManager" ref="ksCacheManager"/>
    </bean>

    <bean id="populationServiceEvaluationDecorator" class="org.kuali.student.core.population.service.decorators.PopulationServiceIsMemberEvaluatorDecorator">
        <property name="nextDecorator" ref="populationServiceImpl"/>
    </bean>

    <!--TODO: KSENROLL-12393 Replace wiring to ExemptionServiceMapImpl once JPA impl is done-->
    <bean id="exemptionServiceMapImpl" class="org.kuali.student.core.exemption.service.impl.ExemptionServiceMapImpl" />

    <bean id="gesServiceCacheDecorator" class="org.kuali.student.core.ges.service.decorators.GesServiceCacheDecorator">
        <property name="nextDecorator" ref="gesServiceEvaluationDecorator" />
        <property name="cacheManager" ref="ksCacheManager" />
    </bean>

    <bean id="gesServiceEvaluationDecorator" class="org.kuali.student.core.ges.service.decorators.GesServiceEvaluationDecorator" >
        <property name="populationService" ref="PopulationService" />
        <property name="atpService" ref="AtpService" />
        <property name="nextDecorator" ref="gesServiceImpl" />
    </bean>

    <bean id="gesServiceRolloverEvaluationDecorator" class="org.kuali.student.enrollment.ges.service.decorators.GesServiceRolloverEvaluationDecorator" >
        <property name="courseService" ref="CourseService" />
        <property name="nextDecorator" ref="gesServiceCacheDecorator" />
    </bean>

    <bean id="gesServiceImpl" class="org.kuali.student.core.ges.service.impl.GesServiceImpl" >
        <property name="atpService" ref="AtpService" />
        <property name="parameterDao" ref="parameterDao" />
        <property name="valueDao" ref="valueDao" />
    </bean>

    <bean id="elasticEmbedded" class="org.kuali.student.enrollment.registration.search.elastic.ElasticEmbedded" init-method="init" destroy-method="shutdown"
          depends-on="LRCService, searchService">
        <property name="lrcService" ref="LRCService"/>
        <property name="scheduleOfClassesService"  ref="scheduleOfClassesService"/>
        <property name="searchService" ref="searchService"/>
        <property name="indexOnStartup" value="${ks.index.elastic.onstartup}"/>
    </bean>


    <bean id="HoldIssueAuthorizingOrgServiceFacade" class="org.kuali.student.enrollment.class1.hold.service.facade.HoldIssueAuthorizingOrgServiceFacadeImpl">
        <property name="organizationService" ref="orgServiceImplNew"/>
    </bean>

    <!-- Put facade on the bus -->
    <bean id="ks.exp.HoldIssueAuthorizingOrgServiceFacade" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.JavaServiceDefinition">
                <property name="service" ref="HoldIssueAuthorizingOrgServiceFacade" /> <!-- Must match id in the bean -->
                <property name="serviceInterface" value="org.kuali.student.enrollment.class1.hold.service.facade.HoldIssueAuthorizingOrgFacade" />
                <property name="localServiceName" value="HoldIssueAuthorizingOrgFacade" /> <!-- Part of the QName -->
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/HoldIssueAuthorizingOrgFacade" />
                <property name="busSecurity" value="${ks.enroll.bus.security}" />
            </bean>
        </property>
    </bean>



    <!-- camel routes for event processing. This isn't in the ks-enroll-mq-context.xml because we need access
         to the elasticEmbedded client. -->
    <camelContext xmlns="http://camel.apache.org/schema/spring">
        <route>
            <from uri="activemq:org.kuali.student.enrollment.registration.elastic.courseoffering.updateQueue"/>
            <aggregate strategyRef="eventMessageIdAggregator" completionTimeout="5000">
                <correlationExpression>
                    <simple>body.type</simple>
                </correlationExpression>
                <bean ref="elasticEmbedded" method="updateCourseOfferingCache"/>
            </aggregate>
        </route>
        <route>
            <from uri="activemq:org.kuali.student.enrollment.registration.elastic.registrationgroup.deleteQueue"/>
            <aggregate strategyRef="eventMessageIdAggregator" completionTimeout="5000">
                <correlationExpression>
                    <simple>body.type</simple>
                </correlationExpression>
                <bean ref="elasticEmbedded" method="removeRegistrationGroupCache"/>
            </aggregate>
        </route>
    </camelContext>

    <bean id="ksIdentityServiceHelper" class="org.kuali.student.enrollment.util.KSIdentityServiceHelper">
        <property name="cacheManager" ref="ksCacheManager"/>
        <property name="identityService" ref="coreIdentityServiceClient" />
    </bean>

    <!-- AOP of LUI Service. Needed for Eventing -->
    <bean id="luiBroadcastAspect" class="org.kuali.student.enrollment.class1.lui.aop.LuiBroadcastAspect">
        <property name="jmsTemplate" ref="jmsTopicTemplate"/> <!-- send messages to the topic, not queue -->
        <property name="jmsDestination" value="org.kuali.student.enrollment.lui.service.LuiEventTopic"/>
    </bean>
    <bean id="courseOfferingBroadcastAspect" class="org.kuali.student.enrollment.class2.courseoffering.aop.CourseOfferingBroadcastAspect">
        <property name="jmsTemplate" ref="jmsTopicTemplate"/> <!-- send messages to the topic, not queue -->
        <property name="jmsDestination" value="org.kuali.student.enrollment.class2.courseoffering.service.CourseOfferingEventTopic"/>
    </bean>


    <!-- The following AOP is used to trigger events like: processing people from waitlist when class size changes -->
    <aop:config proxy-target-class="false">
        <aop:aspect ref="luiBroadcastAspect">
            <aop:pointcut id="luiUpdate" expression="execution(* org.kuali.student.enrollment.class1.lui.service.impl.LuiServiceImpl.updateLui(..))" />
            <aop:after-returning pointcut-ref="luiUpdate" method="updateLuiAdvice" returning="retVal"  />
            <aop:pointcut id="luiCreate" expression="execution(* org.kuali.student.enrollment.class1.lui.service.impl.LuiServiceImpl.createLui(..))" />
            <aop:after-returning pointcut-ref="luiCreate" method="createLuiAdvise" returning="retVal" />
        </aop:aspect>
        <aop:aspect ref="courseOfferingBroadcastAspect">
            <aop:pointcut id="registrationGroupDelete" expression="execution(* org.kuali.student.enrollment.class2.courseoffering.service.impl.CourseOfferingServiceImpl.deleteRegistrationGroup(..))" />
            <aop:after-returning pointcut-ref="registrationGroupDelete" method="deleteRegistrationGroupAdvise" />
        </aop:aspect>
    </aop:config>

</beans>


