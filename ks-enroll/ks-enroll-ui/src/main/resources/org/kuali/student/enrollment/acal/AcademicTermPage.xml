<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p" xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/util
                           http://www.springframework.org/schema/util/spring-util-2.0.xsd">

   <bean id="KS-AcademicTerm-EditSection" parent="Uif-Disclosure-StackedCollectionSection" p:id="acal-term" p:style="min-width:70em;" p:readOnly="@{#view.readOnly}">
     <property name="title" value="Terms" />
     <property name="collectionObjectClass" value="org.kuali.student.enrollment.class2.acal.dto.AcademicTermWrapper" />
     <property name="layoutManager.lineGroupPrototype.disclosure.render" value="true"/>
     <property name="layoutManager.lineGroupPrototype.header.headerText" value="@{#line.termNameForUI}"/>
     <property name="propertyName" value="termWrapperList" />
     <property name="layoutManager.lineGroupPrototype.instructionalText" value="@{#line.termNameForUI} Term Information"/>
     <property name="layoutManager.lineGroupPrototype.readOnly" value="@{#line.readOnly}"/>
     <property name="addLineLabelField.labelText" value=""/>
     <property name="layoutManager.lineGroupPrototype.instructionalMessageField.styleClasses">
      <list merge="true">
        <value>ks-header-boldWithLine</value>
      </list>
     </property>
     <property name="layoutManager.addLineGroup.style" value="margin-top:1em;"/>
     <property name="header.group">
         <bean parent="Uif-VerticalBoxGroup">
             <property name="items">
                <list>
                   <bean parent="Uif-ActionLink" p:methodToCall="cancelAddingTerm" p:actionLabel="Cancel Adding Term" p:clientSideJs="performCollectionAction('acal-term');" p:render="@{!#view.readOnly}"/>
                </list>
             </property>
         </bean>
      </property>
     <property name="actionFields">
      <list>
        <bean parent="Uif-SecondaryActionButton" p:actionLabel="Set as Official"  p:methodToCall="setTermOfficial" p:render="@{!#line.readOnly and #form.academicCalendarInfo.stateKey eq 'kuali.atp.state.Official'}"/>
        <bean parent="Uif-ActionLink" p:methodToCall="deleteTerm" p:actionLabel="Delete"/>
      </list>
    </property>
     <property name="items">
       <list>
         <bean parent="Uif-InputField" p:propertyName="termType" p:label="Term" p:required="true" p:render="@{#isAddLine}">
             <property name="control">
                <bean parent="Uif-DropdownControl"/>
             </property>
             <property name="optionsFinder">
                <bean class="org.kuali.student.enrollment.class2.acal.keyvalue.AcademicTermTypeKeyValues"/>
             </property>
         </bean>
         <bean parent="Uif-InputField" p:propertyName="name" p:render="@{!#isAddLine}" p:label="Name" p:required="true">
            <property name="control">
                <bean parent="Uif-TextControl" p:size="30" />
            </property>
        </bean>
        <bean parent="Uif-InputField" p:propertyName="startDate" p:label="Start Date" p:required="true">
            <property name="control">
                <bean parent="Uif-DateControl" p:size="9" p:watermarkText="mm/dd/yyyy"/>
            </property>
            <property name="validCharactersConstraint">
                <bean parent="BasicDatePatternConstraint" />
            </property>
        </bean>
        <bean parent="Uif-InputField" p:propertyName="endDate" p:label="End Date" p:required="true">
            <property name="control">
                <bean parent="Uif-DateControl" p:size="9" p:watermarkText="mm/dd/yyyy"/>
            </property>
            <property name="validCharactersConstraint">
                <bean parent="BasicDatePatternConstraint" />
            </property>
        </bean>
        <bean parent="Uif-InputField" p:propertyName="instructionalDays" p:label="Instructional Days" p:render="@{!#isAddLine}">
            <property name="control">
                <bean parent="Uif-TextControl" p:size="5" p:disabled="true"/>
            </property>
        </bean>
       </list>
     </property>
     <property name="subCollections">
       <list>
         <ref bean="KS-KeyDatesGroup-EditSubSection" />
       </list>
     </property>
   </bean>

    <bean id="KS-KeyDatesGroup-EditSubSection" parent="Uif-Disclosure-StackedCollectionSection" p:id="acal-term-keydatesgroup" p:readOnly="@{#view.readOnly}">
     <property name="title" value="Key Dates Group" />
     <property name="layoutManager.lineGroupPrototype.disclosure.render" value="true"/>
     <property name="collectionObjectClass" value="org.kuali.student.enrollment.class2.acal.dto.KeyDatesGroupWrapper" />
     <property name="propertyName" value="keyDatesGroupWrappers" />
     <property name="layoutManager.lineGroupPrototype.header.headerText" value="@{#line.keyDateGroupNameUI} Key Dates"/>
     <property name="actionFields">
      <list>
        <bean parent="Uif-SecondaryActionButton-Small" p:methodToCall="deleteKeyDateGroup" p:actionLabel="delete keydate group"/>
      </list>
    </property>
     <property name="header.render" value="@{!#view.readOnly}"/>
     <property name="header.styleClasses">
      <list merge="true">
        <value>ks-borderBottom2</value>
      </list>
    </property>
    <property name="addLineLabelField.labelText" value=""/>

     <property name="items">
       <list>
         <bean parent="Uif-InputField" p:propertyName="keyDateGroupType" p:label="Key Date Group Type" p:required="true" p:render="@{#isAddLine}" p:finalizeMethodToCall="populateKeyDateGroupTypes" >
             <property name="control">
                <bean parent="Uif-DropdownControl"/>
             </property>
         </bean>
       </list>
     </property>
     <property name="subCollections">
       <list>
         <ref bean="KS-KeyDates-EditSubSection" />
       </list>
     </property>
   </bean>

   <bean id="KS-KeyDates-EditSubSection" parent="Uif-Disclosure-TableSubCollection-WithinSection"
         p:id="acal-term-keydates" p:readOnly="@{#view.readOnly}"
         p:layoutManager.numberOfColumns="@{#view.readOnly ? 5 : 9}">
     <property name="title" value="" />
     <property name="collectionObjectClass" value="org.kuali.student.enrollment.class2.acal.dto.KeyDateWrapper" />
     <property name="layoutManager.style" value="margin-top:1em; width:100%;"/>
     <property name="layoutManager.applyDefaultCellWidths" value="false" />
     <property name="layoutManager.applyAlternatingRowStyles" value="false" />
     <property name="disclosure.render" value="false"/>
     <property name="propertyName" value="keydates" />
     <property name="header.styleClasses">
         <list merge="true">
             <value>ks-borderBottom1</value>
         </list>
     </property>
     <property name="layoutManager.styleClasses">
         <list merge="true">
             <value>ks-tablecollection-table</value>
         </list>
     </property>
     <property name="layoutManager.renderSequenceField" value="false" />
     <property name="layoutManager.generateAutoSequence" value="false" />
     <property name="layoutManager.separateAddLine" value="false" />
     <property name="layoutManager.richTable.disableTableSort" value="true" />
     <property name="layoutManager.richTable.render" value="false" />
     <property name="items">
       <list>
         <bean parent="Uif-InputField" p:propertyName="keyDateType"
               p:readOnly="@{!#isAddLine}" p:alternateDisplayPropertyName="keyDateNameUI"
               p:label="Key Date Type" p:required="true"
               p:finalizeMethodToCall="populateKeyDateTypes" p:style="font-weight:bold;">
             <property name="control">
                <bean parent="Uif-DropdownControl"/>
             </property>
         </bean>
         <bean parent="Uif-InputField" p:propertyName="startDate" p:alternateDisplayPropertyName="startDateUI"
               p:label="Start Date" p:required="true">
            <property name="control">
                <bean parent="Uif-DateControl" p:size="9" p:watermarkText="mm/dd/yyyy"/>
            </property>
             <property name="validCharactersConstraint">
                 <bean parent="BasicDatePatternConstraint" />
             </property>
         </bean>
        <bean parent="Uif-InputField" p:propertyName="startTime" p:render="@{!#view.readOnly}"
              p:label="Start Time" p:progressiveRender="@{#lp.allDay eq false}">
            <property name="control">
                <bean parent="Uif-TextControl" p:size="4"  p:watermarkText="hh:mm"/>
            </property>
            <property name="validCharactersConstraint">
                <bean parent="TimePatternConstraint" />
            </property>
        </bean>
        <bean parent="Uif-InputField" p:propertyName="startTimeAmPm" p:render="@{!#view.readOnly}"
              p:required="@{!#empty(#lp.startTime)}" p:refreshWhenChanged="#lp.startTime"
              p:progressiveRender="@{#lp.allDay eq false}">
             <property name="control">
                <bean parent="Uif-DropdownControl" p:options-ref="hctime-options"/>
                      <!-- expression causes runtime exc on refresh
                      p:disabled="@{#empty(#lp|#line.startTime)}"/>
                      -->
             </property>
        </bean>
        <!-- NOTE: for progressiveRender condition below, "dateRange eq true" DOESN'T WORK -->
        <bean parent="Uif-InputField" p:propertyName="endDate" p:render="@{!#view.readOnly}"
              p:label="End Date" p:required="@{#lp.dateRange}"
              p:progressiveRender="@{#lp.dateRange}">
            <!-- BUG ALERT:
                Without the conditional readOnly property, a "delete" action will
                cause the endDate field ON THE NEXT LINE to be cleared.  Weird.
            -->
            <property name="readOnly" value="@{#lp.dateRange eq false}"/>
            <!-- END OF BUG ALERT -->
            <property name="control">
                <bean parent="Uif-DateControl" p:size="9" p:watermarkText="mm/dd/yyyy"/>
            </property>
            <property name="validCharactersConstraint">
                <bean parent="BasicDatePatternConstraint" />
            </property>
        </bean>
        <bean parent="Uif-DataField" p:propertyName="endDateUI" p:render="@{#view.readOnly}"
              p:label="End Date"/>
        <bean parent="Uif-InputField" p:propertyName="endTime" p:render="@{!#view.readOnly}"
              p:label="End Time" p:progressiveRender="@{#lp.allDay eq false}">
            <property name="control">
                <bean parent="Uif-TextControl" p:size="4"  p:watermarkText="hh:mm"/>
            </property>
            <property name="validCharactersConstraint">
                <bean parent="TimePatternConstraint" />
            </property>
        </bean>
        <bean parent="Uif-InputField" p:propertyName="endTimeAmPm" p:render="@{!#view.readOnly}"
              p:required="@{!#empty(#lp.endTime)}" p:refreshWhenChanged="#lp.endTime"
              p:progressiveRender="@{#lp.allDay eq false}">
            <property name="control">
                <bean parent="Uif-DropdownControl" p:options-ref="hctime-options"/>
                      <!-- expression causes runtime exc on refresh
                      p:disabled="@{#empty(#lp.startTime)}"/>
                      -->
            </property>
        </bean>
        <bean parent="Uif-InputField" p:propertyName="allDay" p:alternateDisplayPropertyName="isAllDayUI"
              p:label="All Day">
            <property name="control">
                <bean parent="Uif-CheckboxControl"/>
            </property>
        </bean>
        <bean parent="Uif-InputField" p:propertyName="dateRange" p:alternateDisplayPropertyName="isDateRangeUI"
              p:label="Date Range">
            <property name="control">
                <bean parent="Uif-CheckboxControl"/>
            </property>
        </bean>
       </list>
     </property>
     <property name="actionFields">
          <list>
              <bean parent="Uif-PrimaryActionButton-Small" p:methodToCall="deleteKeyDate" p:actionLabel="delete"/>
          </list>
    </property>
   </bean>

</beans>
