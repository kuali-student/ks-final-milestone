<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright 2010 The Kuali Foundation Licensed under the Educational Community License, Version 2.0 (the "License"); you
  may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.osedu.org/licenses/ECL-2.0
  Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS
  IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language
  governing permissions and limitations under the License. -->

<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p" xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:tx="http://www.springframework.org/schema/tx" xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
                           http://www.springframework.org/schema/tx
                           http://www.springframework.org/schema/tx/spring-tx-2.0.xsd
                           http://www.springframework.org/schema/aop
                           http://www.springframework.org/schema/aop/spring-aop-2.0.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">

    <import resource="classpath:ks-enroll-api-data-dictionary-validator-configuration.xml" />
    <import resource="classpath:ks-enroll-mock-room-data-context.xml"/>

    <!-- enroll entity manager -->
    <bean id="enrollEntityManager" class="org.springframework.orm.jpa.support.SharedEntityManagerBean">
        <property name="entityManagerFactory" ref="enrollEntityManagerFactory"/>
    </bean>

    <bean id="enrollEntityManagerFactory" parent="coreDefaultEntityManagerFactory">
        <property name="persistenceUnitName" value="Enr"/>
        <property name="persistenceXmlLocation" value="classpath:META-INF/enroll-persistence.xml"/>
        <property name="dataSource" ref="coreDataSource"/>
    </bean>

    <!-- DAOS -->
    <bean id="lifecycleDao" class="org.kuali.student.r2.core.class1.state.dao.LifecycleDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="lprDao" class="org.kuali.student.enrollment.class1.lpr.dao.LprDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="appliedHoldDao" class="org.kuali.student.enrollment.class1.hold.dao.AppliedHoldDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="holdIssueDao" class="org.kuali.student.enrollment.class1.hold.dao.HoldIssueDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="luiDao" class="org.kuali.student.enrollment.class1.lui.dao.LuiDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="luiLuiRelationDao" class="org.kuali.student.enrollment.class1.lui.dao.LuiLuiRelationDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="lprRosterDao" class="org.kuali.student.enrollment.class1.lpr.dao.LprRosterDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="lprRosterEntryDao" class="org.kuali.student.enrollment.class1.lpr.dao.LprRosterEntryDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="resultValuesGroupDao" class="org.kuali.student.r2.lum.lrc.dao.ResultValuesGroupDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="resultValueDao" class="org.kuali.student.r2.lum.lrc.dao.ResultValueDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="resultScaleDao" class="org.kuali.student.r2.lum.lrc.dao.ResultScaleDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="lprTrasactionDao" class="org.kuali.student.enrollment.class1.lpr.dao.LprTransactionDao">
        <property name="em" ref="enrollEntityManager" />
    </bean>

    <bean id="lprTrasactionItemDao" class="org.kuali.student.enrollment.class1.lpr.dao.LprTransactionItemDao">
        <property name="em" ref="enrollEntityManager" />
    </bean>


    <bean id="lrrDao" class="org.kuali.student.enrollment.class1.lrr.dao.LrrDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="resultSourceDao" class="org.kuali.student.enrollment.class1.lrr.dao.ResultSourceDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="processDao" class="org.kuali.student.r2.core.process.dao.ProcessDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="instructionDao" class="org.kuali.student.r2.core.process.dao.InstructionDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="checkDao" class="org.kuali.student.r2.core.process.dao.CheckDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="appointmentWindowDao" class="org.kuali.student.r2.core.class1.appointment.dao.AppointmentWindowDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="appointmentSlotDao" class="org.kuali.student.r2.core.class1.appointment.dao.AppointmentSlotDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="appointmentDao" class="org.kuali.student.r2.core.class1.appointment.dao.AppointmentDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="enrollmentFeeDao" class="org.kuali.student.r2.core.fee.dao.EnrollmentFeeDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="socDao" class="org.kuali.student.enrollment.class2.courseofferingset.dao.SocDao">
        <property name="em" ref="enrollEntityManager" />
    </bean>
    <bean id="socRolloverResultDao" class="org.kuali.student.enrollment.class2.courseofferingset.dao.SocRolloverResultDao">
        <property name="em" ref="enrollEntityManager" />
    </bean>
    <bean id="socRolloverResultItemDao" class="org.kuali.student.enrollment.class2.courseofferingset.dao.SocRolloverResultItemDao">
        <property name="em" ref="enrollEntityManager" />
    </bean>

    <!-- Population Dao -->
    <bean id="populationDao" class="org.kuali.student.r2.core.population.dao.PopulationDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="populationRuleDao" class="org.kuali.student.r2.core.population.dao.PopulationRuleDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <!-- Search Dao needs an implementation at some point -->
    <bean id="searchDao" class="org.kuali.student.r2.core.class1.appointment.dao.AppointmentDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="activityOfferingClusterDao" class="org.kuali.student.enrollment.class2.courseoffering.dao.ActivityOfferingClusterDao" >
        <property name="em" ref="enrollEntityManager" />
    </bean>

    <bean id="seatPoolDefinitionDao" class="org.kuali.student.enrollment.class2.courseoffering.dao.SeatPoolDefinitionDao">
        <property name="em" ref="enrollEntityManager" />
    </bean>

    <bean id="scheduleRequestDao" class="org.kuali.student.r2.core.scheduling.dao.ScheduleRequestDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="scheduleDao" class="org.kuali.student.r2.core.scheduling.dao.ScheduleDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <bean id="timeSlotDao" class="org.kuali.student.r2.core.scheduling.dao.TimeSlotDao">
        <property name="em" ref="enrollEntityManager"/>
    </bean>

    <!-- END DAOs -->

    <!-- Criteria lookup config -->
    <bean id="criterialookupDaoJpaEnroll" class="org.kuali.student.r2.common.criteria.impl.CriteriaLookupDaoJpaImpl">
        <property name="entityManager" ref="enrollEntityManager"/>
    </bean>

    <bean id="enrollCriteriaLookupService" parent="coreCriteriaLookupService">
        <property name="criteriaLookupDao" ref="criterialookupDaoJpaEnroll"/>
    </bean>

    <!-- End Criteria Lookup config -->


    <!-- ACal Beans -->

    <!-- necessary to use ACSCalculationDecorator's copyHolidayCalendar() -->
    <bean id="acalService" class="org.kuali.student.r2.core.acal.service.decorators.AcademicCalendarServiceCalculationDecorator">
        <property name="atpService" ref="atpServiceClient" />
        <property name="nextDecorator" ref="acalServiceImpl" />
    </bean>

    <bean id="acalServiceImpl" class="org.kuali.student.r2.core.acal.service.impl.AcademicCalendarServiceImpl">
        <property name="atpService" ref="atpServiceClient" />
        <property name="stateService" ref="stateServiceCacheDecorator" />
        <property name="typeService" ref="typeServiceCacheDecorator" />
        <property name="acalAssembler" ref="acalAssembler" />
        <property name="termAssembler" ref="termAssembler" />
        <property name="holidayCalendarAssembler" ref="holidayCalendarAssembler" />
        <property name="holidayAssembler" ref="holidayAssembler" />
        <property name="keyDateAssembler" ref="keyDateAssembler" />
        <property name="acalEventAssembler" ref = "acalEventAssembler" />
    </bean>

    <bean id="ks.exp.acalService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="acalService" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.acal.service.AcademicCalendarService" />
                <property name="localServiceName" value="AcademicCalendarService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/acal" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="acalAssembler" class="org.kuali.student.r2.core.acal.service.assembler.AcademicCalendarAssembler">
        <property name="atpService" ref="atpServiceClient" />
    </bean>

    <bean id="termAssembler" class="org.kuali.student.r2.core.acal.service.assembler.TermAssembler">
        <property name="termCodeGenerator" ref = "termCodeGenerator" />
    </bean>

    <bean id="termCodeGenerator" class="org.kuali.student.r2.core.acal.service.impl.TermCodeGeneratorImpl"/>

    <bean id="holidayCalendarAssembler" class="org.kuali.student.r2.core.acal.service.assembler.HolidayCalendarAssembler" />

    <bean id="holidayAssembler" class="org.kuali.student.r2.core.acal.service.assembler.HolidayAssembler" />

    <bean id="keyDateAssembler" class="org.kuali.student.r2.core.acal.service.assembler.KeyDateAssembler" />

    <bean id="roleService" class="org.kuali.student.kim.permission.mock.RoleServiceMockImpl " />

    <bean id="permissionService" class="org.kuali.student.kim.permission.mock.PermissionServiceMockImpl" />

    <bean id="acalEventAssembler" class="org.kuali.student.r2.core.acal.service.assembler.AcalEventAssembler"/>

    <!-- end ACal beans -->

    <!--- FeeService -->
    <bean id="feeService" class="org.kuali.student.r2.core.fee.service.impl.FeeServiceImpl">
        <property name="enrollmentFeeDao" ref="enrollmentFeeDao" />
    </bean>

    <bean id="ks.exp.feeService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="feeService" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.fee.service.FeeService" />
                <property name="localServiceName" value="FeeService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/fee" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- end FeeService -->

    <!-- courseofferingset beans -->
    <bean id="socService" class="org.kuali.student.enrollment.class2.courseofferingset.service.impl.CourseOfferingSetServiceImpl">
        <property name="socDao" ref="socDao" />
        <property name="socRorDao" ref="socRolloverResultDao" />
        <property name="socRorItemDao" ref="socRolloverResultItemDao"/>
        <property name="criteriaLookupService" ref="enrollCriteriaLookupService" />
        <property name="businessLogic" ref="socBusinessLogic" />
    </bean>

    <bean id="socBusinessLogic" class="org.kuali.student.enrollment.class2.courseofferingset.service.impl.CourseOfferingSetServiceBusinessLogicImpl">
        <property name="socDao" ref="socDao" />
        <property name="courseService" ref="courseServiceImpl" />
        <property name="acalService" ref="acalService" />
        <property name="coService" ref="coService" />
        <property name="schedulingService" ref="schedulingServiceValidationDecorator"/>
    </bean>

    <bean id="ks.exp.socService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="socService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.courseofferingset.service.CourseOfferingSetService" />
                <property name="localServiceName" value="CourseOfferingSetService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseOfferingSet" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- end Soc Service beans -->

    <!-- course offering beans -->

    <bean id="coServiceValidation"
          class="org.kuali.student.enrollment.class2.courseoffering.service.decorators.CourseOfferingServiceValidationDecorator">
        <property name="nextDecorator" ref="coService" />
        <property name="validator" ref="validator" />
    </bean>

    <bean id="coService" class="org.kuali.student.enrollment.class2.courseoffering.service.impl.CourseOfferingServiceImpl">
        <property name="luiService" ref="LuiService" />
        <property name="rgAssembler" ref="rgAssembler" />
        <property name="courseService" ref="courseServiceImpl" />
        <property name="acalService" ref="acalService" />
        <property name="stateService" ref="stateServiceCacheDecorator" />
        <property name="lprService" ref="lprPersistenceService" />
        <property name="criteriaLookupService" ref="coCriteriaLookupService" />
        <property name="typeService" ref="typeServiceCacheDecorator" />
        <property name="businessLogic" ref="coBusinessLogic" />
        <property name="offeringCodeGenerator" ref="offeringCodeGenerator" />
        <property name="courseOfferingTransformer" ref="courseOfferingTransformer" />
        <property name="seatPoolDefinitionDao" ref="seatPoolDefinitionDao" />
        <property name="activityOfferingClusterDao" ref="activityOfferingClusterDao" />
        <property name="registrationGroupTransformer" ref="registrationGroupTransformer" />
        <property name="schedulingService" ref="schedulingServiceImpl"/>
        <property name="lrcService" ref="lrcServiceCache"/>
    </bean>

    <bean id="offeringCodeGenerator" class="org.kuali.student.enrollment.class2.courseoffering.service.impl.CourseOfferingCodeGeneratorImpl"/>

    <bean id="activityTransformer" class="org.kuali.student.enrollment.class2.courseoffering.service.transformer.ActivityOfferingTransformer" />

    <bean id="coCriteriaLookupService" class="org.kuali.student.r2.common.criteria.impl.CriteriaLookupServiceImpl">
        <property name="criteriaLookupDao" ref="criterialookupDaoJpaEnroll"/>
        <property name="predicateTransforms">
            <list>
                <ref bean="coCodeTransform"/>
            </list>
        </property>
    </bean>

    <bean id="coCodeTransform" class="org.kuali.student.enrollment.class2.courseoffering.service.criteria.transform.CourseOfferingCriteriaTransform"/>

    <bean id="courseOfferingTransformer" class="org.kuali.student.enrollment.class2.courseoffering.service.transformer.CourseOfferingTransformer">
        <property name="lprService" ref="lprPersistenceService" />
        <property name="lrcService" ref="lrcServiceCache" />
        <property name="cluService" ref="cluClient"/>
    </bean>

    <bean id="coBusinessLogic" class="org.kuali.student.enrollment.class2.courseoffering.service.impl.CourseOfferingServiceBusinessLogicImpl">
        <property name="courseService" ref="courseServiceImpl" />
        <property name="acalService" ref="acalService" />
        <property name="registrationCodeGeneratorFactory" ref="regGroupCodeGeneratorFactory" />
    </bean>

    <bean id="regGroupCodeGeneratorFactory" class="org.kuali.student.enrollment.class2.courseoffering.service.impl.FourDigitRegistrationGroupCodeGeneratorFactory" />

    <bean id="ks.exp.courseOfferingService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="coServiceValidation" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.courseoffering.service.CourseOfferingService" />
                <property name="localServiceName" value="CourseOfferingService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseOffering" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- end co service beans -->

    <!-- Lui Service beans -->

    <bean id="rgAssembler" class="org.kuali.student.enrollment.class2.courseoffering.service.assembler.RegistrationGroupAssembler">
        <property name="luiService" ref="LuiService" />
        <property name="registrationGroupTransformer" ref="registrationGroupTransformer" />
    </bean>

    <bean id="registrationGroupTransformer" class="org.kuali.student.enrollment.class2.courseoffering.service.transformer.RegistrationGroupTransformer">
        <property name="luiService" ref="LuiService" />
    </bean>

    <alias name="luiServiceValidationDecorator" alias="LuiService" />

    <bean id="luiServiceValidationDecorator" class=" org.kuali.student.enrollment.class1.lui.service.decorators.LuiServiceValidationDecorator">
        <property name="nextDecorator" ref="luiServiceImpl" />
        <property name="validator" ref="validator" />
        <property name="typeService" ref="typeServiceCacheDecorator" />
    </bean>

    <bean id="luiServiceImpl" class="org.kuali.student.enrollment.class1.lui.service.impl.LuiServiceImpl">
        <property name="luiDao" ref="luiDao" />
        <property name="luiLuiRelationDao" ref="luiLuiRelationDao" />
    </bean>

    <bean id="ks.exp.luiService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="LuiService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.lui.service.LuiService" />
                <property name="localServiceName" value="LuiService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/lui" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- End Lui Service beans -->

    <!-- LPR Service related beans (LRR, LRC) -->
    <bean id="lprPersistenceService" class="org.kuali.student.enrollment.class1.lpr.service.impl.LprServiceImpl">
        <property name="lprDao" ref="lprDao" />
        <property name="lprTransactionDao" ref="lprTrasactionDao" />
        <property name="lprTransactionItemDao" ref="lprTrasactionItemDao" />
    </bean>

    <bean id="lprServiceValidation" class="org.kuali.student.enrollment.class1.lpr.service.decorators.LprServiceValidationDecorator">
        <property name="nextDecorator" ref="lprPersistenceService" />
        <property name="validator" ref="validator" />
    </bean>

    <bean id="ks.exp.LprService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="lprServiceValidation" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.lpr.service.LprService" />
                <property name="localServiceName" value="LprService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/lpr" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="lrrPersistenceService" class="org.kuali.student.enrollment.class1.lrr.service.impl.LearningResultRecordServiceImpl">
        <property name="lrrDao" ref="lrrDao" />
        <property name="resultSourceDao" ref="resultSourceDao" />
    </bean>

    <bean id="ksCacheManager" class="net.sf.ehcache.CacheManager">
        <constructor-arg index="0" type="java.net.URL" value="${ks.cache.config.file}" />
    </bean>

    <bean id="lrcServiceBusinessLogic" class="org.kuali.student.r2.lum.lrc.service.impl.LrcServiceBusinessLogicImpl" />

    <bean id="lrcServiceCache" class="org.kuali.student.r2.lum.lrc.service.impl.LRCServiceCacheDecorator">
        <property name="nextDecorator" ref="lrcPersistenceService" />
        <property name="cacheManager" ref="ksCacheManager"/>
    </bean>

    <bean id="lrcPersistenceService" class="org.kuali.student.r2.lum.lrc.service.impl.LRCServiceImpl">
        <property name="resultValuesGroupDao" ref="resultValuesGroupDao" />
        <property name="resultValueDao" ref="resultValueDao" />
        <property name="resultScaleDao" ref="resultScaleDao" />
        <property name="lrcServiceBusinessLogic" ref="lrcServiceBusinessLogic" />
        <property name="resultScaleCriteriaLookupService">
            <bean parent="enrollCriteriaLookupService">
                <property name="predicateTransforms">
                    <list merge="false">
                        <bean parent="keyword2LikeTransform">
                            <property name="likeAttributes">
                                <!--                            Also scan the key when doing a keyword search-->
                                <list merge="true">
                                    <value>key</value>
                                    <value>typeKey</value>
                                    <value>stateKey</value>
                                </list>
                            </property>
                        </bean>
                        <bean class="org.kuali.student.r2.common.criteria.transform.RenameTransform">
                            <property name="renameAttributes">
                                <map>
                                    <entry key="typeKey" value="type"/>
                                    <entry key="stateKey" value="state"/>
                                    <entry key="resultValueRange.minValue" value="minValue"/>
                                    <entry key="resultValueRange.maxValue" value="maxValue"/>
                                    <entry key="resultValueRange.increment" value="increment"/>
                                </map>
                            </property>
                        </bean>
                        <ref bean="key2IdTransform"/>
                        <ref bean="descrTransform"/>
                        <ref bean="metaTransform"/>
                        <ref bean="attributeTransform"/>
                    </list>
                </property>
            </bean>
        </property>
        <property name="resultValueCriteriaLookupService">
            <bean parent="enrollCriteriaLookupService">
                <property name="predicateTransforms">
                    <list merge="false">
                        <bean parent="keyword2LikeTransform">
                            <property name="likeAttributes">
                                <!--                            Also scan the key when doing a keyword search-->
                                <list merge="true">
                                    <value>key</value>
                                    <value>resultScaleKey</value>
                                </list>
                            </property>
                        </bean>
                        <bean class="org.kuali.student.r2.common.criteria.transform.RenameTransform">
                            <property name="renameAttributes">
                                <map>
                                    <entry key="typeKey" value="type"/>
                                    <entry key="stateKey" value="state"/>
                                    <entry key="resultScaleKey" value="resultScaleId"/>
                                </map>
                            </property>
                        </bean>
                        <ref bean="key2IdTransform"/>
                        <ref bean="descrTransform"/>
                        <ref bean="metaTransform"/>
                        <ref bean="attributeTransform"/>
                    </list>
                </property>
            </bean>
        </property>
        <property name="resultValuesGroupCriteriaLookupService">
            <bean parent="enrollCriteriaLookupService">
                <property name="predicateTransforms">
                    <list merge="false">
                        <bean parent="keyword2LikeTransform">
                            <property name="likeAttributes">
                                <!--                                Also scan the key when doing a keyword search-->
                                <list merge="true">
                                    <value>key</value>
                                    <value>resultScaleKey</value>
                                </list>
                            </property>
                        </bean>
                        <bean class="org.kuali.student.r2.common.criteria.transform.RenameTransform">
                            <property name="renameAttributes">
                                <map>
                                    <entry key="typeKey" value="type"/>
                                    <entry key="stateKey" value="state"/>
                                    <entry key="resultScaleKey" value="resultScaleId"/>
                                    <entry key="resultValueRange.minValue" value="minValue"/>
                                    <entry key="resultValueRange.maxValue" value="maxValue"/>
                                    <entry key="resultValueRange.increment" value="increment"/>
                                </map>
                            </property>
                        </bean>
                        <ref bean="key2IdTransform"/>
                        <ref bean="descrTransform"/>
                        <ref bean="metaTransform"/>
                        <ref bean="attributeTransform"/>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <bean id="ks.exp.LRCService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="lrcServiceCache" />
                <property name="serviceInterface" value="org.kuali.student.r2.lum.lrc.service.LRCService" />
                <property name="localServiceName" value="LrcService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/lrc" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <bean id="gradeValuesGroupAssembler" class="org.kuali.student.enrollment.class2.grading.assembler.GradeValuesGroupAssembler" />

    <!-- End LPR Service related beans (LRR, LRC) -->

    <!-- course reg service beans -->

    <bean id="courseRegistrationService"
          class="org.kuali.student.enrollment.class2.courseregistration.service.decorators.CourseRegistrationServiceValidationDecorator">
        <property name="validator" ref="validator" />
        <property name="nextDecorator" ref="courseRegistrationImpl" />
    </bean>

    <bean id="courseRegistrationImpl" class="org.kuali.student.enrollment.class2.courseregistration.service.impl.CourseRegistrationServiceImpl">
        <property name="lprService" ref="lprServiceValidation" />
        <property name="courseOfferingService" ref="coServiceValidation" />
    </bean>

    <bean id="ks.exp.courseRegistrationService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="courseRegistrationService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.courseregistration.service.CourseRegistrationService" />
                <property name="localServiceName" value="CourseRegistrationService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/courseRegistrationService" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- End course reg service beans -->

    <!-- Academic record service -->

    <bean id="courseRecordAssembler" class="org.kuali.student.enrollment.class2.academicrecord.service.assembler.StudentCourseRecordAssembler" />
    <bean id="academicRecordService" class="org.kuali.student.enrollment.class2.academicrecord.service.impl.AcademicRecordServiceImpl">
        <property name="courseRegService" ref="courseRegistrationService" />
        <property name="atpService" ref="atpServiceClient" />
        <property name="gradingService" ref="gradingService" />
        <property name="lrcService" ref="lrcServiceCache" />
        <property name="courseRecordAssembler" ref="courseRecordAssembler" />
    </bean>

    <bean id="ks.exp.academicRecordService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="academicRecordService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.academicrecord.service.AcademicRecordService" />
                <property name="localServiceName" value="AcademicRecordService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/academicrecord" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- End Academic record service -->

    <!-- Grading service -->
    <bean id="gradeRosterAssembler" class="org.kuali.student.enrollment.class2.grading.service.assembler.GradeRosterAssembler"></bean>
    <bean id="gradeRosterEntryAssembler" class="org.kuali.student.enrollment.class2.grading.service.assembler.GradeRosterEntryAssembler"></bean>

    <bean id="gradingService" class="org.kuali.student.enrollment.class2.grading.service.impl.GradingServiceImpl"
          scope="singleton">
        <property name="lprService" ref="lprServiceValidation" />
        <property name="courseOfferingService" ref="coService" />
        <property name="gradeRosterAssembler" ref="gradeRosterAssembler" />
        <property name="gradeRosterEntryAssembler" ref="gradeRosterEntryAssembler" />
        <property name="lrrService" ref="lrrPersistenceService" />
        <property name="gradeValuesGroupAssembler" ref="gradeValuesGroupAssembler" />
        <property name="lrcService" ref="lrcServiceCache" />
        <property name="courseRegistrationService" ref="courseRegistrationService" />
    </bean>

    <bean id="ks.exp.gradingService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="gradingService" />
                <property name="serviceInterface" value="org.kuali.student.enrollment.grading.service.GradingService" />
                <property name="localServiceName" value="GradingService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/grading" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- End grading service -->

    <!-- Process Service -->
    <bean id="processService" class="org.kuali.student.r2.core.process.impl.ProcessServiceImpl">
        <property name="processDao" ref="processDao" />
        <property name="checkDao" ref="checkDao" />
        <property name="instructionDao" ref="instructionDao" />
        <property name="stateService" ref="stateServiceCacheDecorator" />
        <property name="criteriaLookupService" ref="enrollCriteriaLookupService"/>
    </bean>

    <bean id="processServiceValidationDecorator"
          class="org.kuali.student.r2.core.process.service.decorators.ProcessServiceValidationDecorator">
        <property name="nextDecorator" ref="processService"/>
        <property name="validator" ref="validator"/>
    </bean>

    <bean id="ks.exp.processService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="processServiceValidationDecorator" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.process.service.ProcessService" />
                <property name="localServiceName" value="ProcessService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/process" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- End Process Service -->

    <!-- Appointment Service -->
    <bean id="appointmentWindowService" class="org.kuali.student.r2.core.class1.appointment.service.impl.AppointmentServiceImpl">
        <property name="appointmentWindowDao" ref="appointmentWindowDao"/>
        <property name="appointmentSlotDao" ref="appointmentSlotDao"/>
        <property name="appointmentDao" ref="appointmentDao"/>
        <property name="populationService" ref="populationServiceMock"/>
    </bean>

    <bean id="ks.exp.appointmentWindowService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="appointmentWindowService" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.appointment.service.AppointmentService" />
                <property name="localServiceName" value="AppointmentService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/appointment" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- End Appointment Service -->

    <!-- Population Mock service (currently used by AppointmentService (see below for PopulationService) -->
    <bean id="populationServiceMock" class="org.kuali.student.r2.core.population.service.impl.mock.PopulationServiceMockImpl">
    </bean>

    <bean id="ks.exp.populationServiceMock" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="populationService" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.population.service.PopulationService" />
                <property name="localServiceName" value="PopulationMockService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/population" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- End Population Mock service -->

    <!--- Population Service -->
    <bean id="populationServiceValidation" class="org.kuali.student.r2.core.population.service.decorators.PopulationServiceValidatorDecorator">
        <property name="nextDecorator" ref="populationService" />
        <property name="validator" ref="validator" />
    </bean>

    <!--<bean id="populationService" class="org.kuali.student.r2.core.population.service.impl.mock.PopulationServiceMockImpl">-->
    <bean id="populationService" class="org.kuali.student.r2.core.population.service.impl.PopulationServiceImpl">
        <property name="populationDao" ref="populationDao" />
        <property name="populationRuleDao" ref="populationRuleDao" />
        <property name="criteriaLookupService" ref="enrollCriteriaLookupService" />
    </bean>

    <!-- Right now the top level is the validation service so the alias points to it -->
    <alias name="populationServiceValidation" alias="PopulationService" />

    <bean id="ks.exp.populationService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="PopulationService" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.population.service.PopulationService" />
                <property name="localServiceName" value="PopulationService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/population" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <!--- End Population Service -->

    <!-- Search service -->
    <bean id="apptWindowCountsSearchImpl" class="org.kuali.student.r2.common.class1.search.ApptWindowCountsSearchImpl">
        <property name="genericEntityDao" ref="searchDao"/>
    </bean>

    <bean id="courseOfferingHistorySearchImpl" class="org.kuali.student.r2.core.class1.search.CourseOfferingHistorySearchImpl">
        <property name="genericEntityDao" ref="searchDao"/>
        <property name="noOfYears" value="5"/>
    </bean>
    <bean id="CourseOfferingManagementSearchImpl" class="org.kuali.student.r2.core.class1.search.CourseOfferingManagementSearchImpl">
        <property name="genericEntityDao" ref="searchDao"/>
    </bean>



    <bean id="searchService" class="org.kuali.student.r2.common.class1.search.SearchServiceDispatcherImpl">
        <property name="searchServices">
            <list>
                <ref bean="apptWindowCountsSearchImpl" />
                <ref bean="courseOfferingHistorySearchImpl"/>
                <ref bean="CourseOfferingManagementSearchImpl"/>
            </list>
        </property>
    </bean>

    <bean id="ks.exp.searchService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="searchService" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.search.service.SearchService" />
                <property name="localServiceName" value="SearchService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/search" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- End Search service -->

    <!-- Hold Service -->
    <bean id="holdService" class="org.kuali.student.enrollment.class1.hold.service.impl.HoldServiceImpl">
        <property name="holdIssueDao" ref="holdIssueDao"/>
        <property name="appliedHoldDao" ref="appliedHoldDao"/>
        <property name="criteriaLookupService" ref="enrollCriteriaLookupService"/>
    </bean>

    <bean id="holdServiceValidation" class="org.kuali.student.enrollment.class1.hold.service.decorators.HoldServiceValidationDecorator">
        <property name="nextDecorator" ref="holdService"/>
        <property name="validator" ref="validator"/>
    </bean>

    <bean id="ks.exp.holdService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="holdServiceValidation" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.hold.service.HoldService" />
                <property name="localServiceName" value="HoldService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/hold" />
                <property name="busSecurity" value="${ks.lum.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- End Hold Service -->

    <!-- Scheduling Service -->

    <bean id="schedulingServiceImpl" class="org.kuali.student.r2.core.scheduling.service.impl.SchedulingServiceImpl">
        <property name="atpService" ref="atpServiceClient"/>
        <property name="typeService" ref="typeService"/>
        <property name="roomService" ref="roomServiceMockImpl"/>
        <property name="scheduleRequestDao" ref="scheduleRequestDao"/>
        <property name="timeSlotDao" ref="timeSlotDao"/>
        <property name="scheduleDao" ref="scheduleDao"/>
        <property name="criteriaLookupService" ref="enrollCriteriaLookupService" />
    </bean>

    <bean id="schedulingServiceValidationDecorator" class="org.kuali.student.r2.core.scheduling.service.decorators.SchedulingServiceValidationDecorator">
        <property name="nextDecorator" ref="schedulingServiceImpl"/>
        <property name="validator" ref="validator"/>
    </bean>

    <bean id="ks.exp.schedulingService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="schedulingServiceValidationDecorator" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.scheduling.service.SchedulingService" />
                <property name="localServiceName" value="SchedulingService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/scheduling" />
                <property name="busSecurity" value="${ks.core.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- End Scheduling Service -->

    <!-- Room Service Mock Impl -->

    <bean id="roomServiceMockImpl" class="org.kuali.student.r2.core.room.service.impl.RoomServiceMockImplM5">
        <property name="buildingMap" ref="buildingMap"/>
        <property name="roomMap" ref="roomMap"/>
    </bean>

    <bean id="ks.exp.roomService" class="org.kuali.rice.ksb.api.bus.support.ServiceBusExporter">
        <property name="serviceDefinition">
            <bean class="org.kuali.rice.ksb.api.bus.support.SoapServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="roomServiceMockImpl" />
                <property name="serviceInterface" value="org.kuali.student.r2.core.room.service.RoomService" />
                <property name="localServiceName" value="RoomService" />
                <property name="serviceNameSpaceURI" value="http://student.kuali.org/wsdl/room" />
                <property name="busSecurity" value="${ks.core.bus.security}" />
            </bean>
        </property>
    </bean>

    <!-- End Room Service Mock Impl -->

</beans>