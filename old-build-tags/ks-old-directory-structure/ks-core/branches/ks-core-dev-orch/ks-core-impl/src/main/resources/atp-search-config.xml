<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:search="http://student.kuali.org/xsd/search-extension"
	xmlns:dict="http://student.kuali.org/xsd/dictionary-extension"
	xsi:schemaLocation="
	http://student.kuali.org/xsd/search-extension http://student.kuali.org/xsd/search-extension/search-extension.xsd
	http://student.kuali.org/xsd/dictionary-extension http://student.kuali.org/xsd/dictionary-extension/dictionary-extension.xsd
	http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
	 ">

    <!-- Search Types -->
    
	<search:searchType id="org.search.atpTypes">
		<search:name>All ATP types</search:name>
		<search:desc>Returns the list of all ATP Types</search:desc>
		<search:searchResultTypeInfo>
			<ref bean="atp.result.atpType" />
		</search:searchResultTypeInfo>
		<search:searchCriteriaTypeInfo>
			<ref bean="atp.criteria.atpType" />
		</search:searchCriteriaTypeInfo>
	</search:searchType>
    	
	<search:searchType id="atp.search.atpByShortName">
		<search:name>ShortName match</search:name>
		<search:desc>Search on shortName only.</search:desc>
		<search:searchResultTypeInfo>
			<ref bean="atp.result.atpQuickView" />
		</search:searchResultTypeInfo>
		<search:searchCriteriaTypeInfo>
			<ref bean="atp.criteria.atpByShortName" />
		</search:searchCriteriaTypeInfo>
	</search:searchType>

	<search:searchType id="atp.search.basicAtpByShortName">
		<search:name>Basic ShortName match</search:name>
		<search:desc>Search on shortName only and show details.</search:desc>
		<search:searchResultTypeInfo>
			<ref bean="atp.result.atpBasicView" />
		</search:searchResultTypeInfo>
		<search:searchCriteriaTypeInfo>
			<ref bean="atp.criteria.atpByShortName" />
		</search:searchCriteriaTypeInfo>
	</search:searchType>
	
	<search:searchType id="atp.search.advancedAtpSearch">
		<search:name>Advanced ATP match</search:name>
		<search:desc>Search by Name, start date, end date, and type</search:desc>
		<search:searchResultTypeInfo>
			<ref bean="atp.result.advancedAtpSearch" />
		</search:searchResultTypeInfo>
		<search:searchCriteriaTypeInfo>
			<ref bean="atp.criteria.advancedAtpSearch" />
		</search:searchCriteriaTypeInfo>
	</search:searchType>

	<search:searchType id="atp.search.atpByDate">
		<search:name>Date match</search:name>
		<search:desc>Search on shortName only.</search:desc>
		<search:searchResultTypeInfo>
			<ref bean="atp.result.atpByDate" />
		</search:searchResultTypeInfo>
		<search:searchCriteriaTypeInfo>
			<ref bean="atp.criteria.atpByDate" />
		</search:searchCriteriaTypeInfo>
	</search:searchType>

	<!-- Search Result Type Infos -->

	<search:searchResultTypeInfo id="atp.result.atpQuickView">
		<search:name>ATP Quick View</search:name>
		<search:desc>Quick view of the ATP</search:desc>
		<search:resultColumns>
			<ref bean="atp.resultColumn.atpId" />
			<ref bean="atp.resultColumn.atpShortName" />
		</search:resultColumns>
	</search:searchResultTypeInfo>

	<search:searchResultTypeInfo id="atp.result.atpType">
		<search:name>ATP Types</search:name>
		<search:desc>ATP Types</search:desc>
		<search:resultColumns>
			<ref bean="atp.resultColumn.atpTypeId" />
			<ref bean="atp.resultColumn.atpTypeName" />
		</search:resultColumns>
	</search:searchResultTypeInfo>

	<search:searchResultTypeInfo id="atp.result.atpBasicView">
		<search:name>ATP Basic View</search:name>
		<search:desc>Basic view of the ATP</search:desc>
		<search:resultColumns>
			<ref bean="atp.resultColumn.atpId" />
			<ref bean="atp.resultColumn.atpSeasonalType" />
			<ref bean="atp.resultColumn.atpDurType" />
			<ref bean="atp.resultColumn.atpTypeName" />
		</search:resultColumns>
	</search:searchResultTypeInfo>
	
	<search:searchResultTypeInfo id="atp.result.advancedAtpSearch">
		<search:name>ATP Advanced Search</search:name>
		<search:desc>Search by Name, start date, end date, and type</search:desc>
		<search:resultColumns>
			<ref bean="atp.resultColumn.atpId" />
			<ref bean="atp.resultColumn.atpSeasonalType" />
			<ref bean="atp.resultColumn.atpDurType" />
			<ref bean="atp.resultColumn.atpStartDate" />
			<ref bean="atp.resultColumn.atpTypeName" />
		</search:resultColumns>
	</search:searchResultTypeInfo>

	<search:searchResultTypeInfo id="atp.result.atpByDate">
		<search:name>ATP By Date</search:name>
		<search:desc>ATP By Date</search:desc>
		<search:resultColumns>
			<ref bean="atp.resultColumn.atpId" />
			<ref bean="atp.resultColumn.atpByDateDisplay" />
		</search:resultColumns>
	</search:searchResultTypeInfo>

	<!-- Result Columns -->

	<search:resultColumn id="atp.resultColumn.atpTypeId">
		<search:name>ATP Type Identifier</search:name>
		<search:desc>Identifier for an ATP Type</search:desc>
		<search:dataType>string</search:dataType>
	</search:resultColumn>

	<search:resultColumn id="atp.resultColumn.atpId">
		<search:name>ATP Identifier</search:name>
		<search:desc>Identifier for the ATP</search:desc>
		<search:dataType>string</search:dataType>
	</search:resultColumn>

	<search:resultColumn id="atp.resultColumn.atpShortName">
		<search:name>ATP Short Name</search:name>
		<search:desc>Short name for the ATP, recorded as the default
				listing.</search:desc>
		<search:dataType>string</search:dataType>
	</search:resultColumn>
	
	<search:resultColumn id="atp.resultColumn.atpSeasonalType">
		<search:name>Season Type</search:name>
		<search:desc>Will return Season Type.</search:desc>
		<search:dataType>string</search:dataType>
	</search:resultColumn>

	<search:resultColumn id="atp.resultColumn.atpDurType">
		<search:name>Duration Type</search:name>
		<search:desc>Will return Duration Type.</search:desc>
		<search:dataType>string</search:dataType>
	</search:resultColumn>

	<search:resultColumn id="atp.resultColumn.atpTypeName">
		<search:name>Type Name</search:name>
		<search:desc>Type of the ATP.</search:desc>
		<search:dataType>string</search:dataType>
	</search:resultColumn>

	<search:resultColumn id="atp.resultColumn.atpStartDate">
		<search:name>Start Date</search:name>
		<search:desc>Start Date of the ATP.</search:desc>
		<search:dataType>date</search:dataType>
	</search:resultColumn>

	<search:resultColumn id="atp.resultColumn.atpByDateDisplay">
		<search:name>Do you mean</search:name>
		<search:desc>Display text of the atp search by date</search:desc>
		<search:dataType>string</search:dataType>
	</search:resultColumn>


	<!-- Search Criteria Types -->
	
	<search:searchCriteriaTypeInfo id="atp.criteria.atpType">
		<search:name>AtpTypesCriteria</search:name>
		<search:desc>Criteria for searching of a list of all ATP Type ids</search:desc>
	</search:searchCriteriaTypeInfo>

	<search:searchCriteriaTypeInfo id="atp.criteria.atpByShortName">
		<search:name>AtpByShortNameCriteria</search:name>
		<search:desc>AtpByShortNameCriteria Description</search:desc>
		<search:queryParams>
			<ref bean="atp.queryParam.atpShortName" />
		</search:queryParams>
	</search:searchCriteriaTypeInfo>
	
	<search:searchCriteriaTypeInfo id="atp.criteria.advancedAtpSearch">
		<search:name>AdvancedAtpSearchCriteria</search:name>
		<search:desc>AdvancedAtpSearchCriteria Description</search:desc>
		<search:queryParams>
			<ref bean="atp.queryParam.atpShortName" />
			<ref bean="atp.queryParam.atpStartDate" />
			<ref bean="atp.queryParam.atpEndDate" />
			<ref bean="atp.queryParam.atpType" />
		</search:queryParams>
	</search:searchCriteriaTypeInfo>
	
	<search:searchCriteriaTypeInfo id="atp.criteria.atpByDate">
		<search:name>Atp by Date criteria</search:name>
		<search:desc>Atp by Date criteria</search:desc>
		<search:queryParams>
			<ref bean="atp.queryParam.searchDate" />
		</search:queryParams>
	</search:searchCriteriaTypeInfo>

	<search:queryParam id="atp.queryParam.atpShortName">
		<dict:fieldDescriptor parent="childFieldDescriptor">
			<dict:name>Name</dict:name>
		</dict:fieldDescriptor>
	</search:queryParam>

	<search:queryParam id="atp.queryParam.atpId">
		<dict:fieldDescriptor parent="childFieldDescriptor">
			<dict:name>ATP Id</dict:name>
		</dict:fieldDescriptor>
	</search:queryParam>

	<search:queryParam id="atp.queryParam.atpStartDate">
		<dict:fieldDescriptor parent="childFieldDescriptor">
			<dict:name>Start Date</dict:name>
			<dict:dataType>date</dict:dataType>
		</dict:fieldDescriptor>
	</search:queryParam>

	<search:queryParam id="atp.queryParam.atpEndDate">
		<dict:fieldDescriptor>
			<dict:name>End Date</dict:name>
			<dict:dataType>date</dict:dataType>
		</dict:fieldDescriptor>
	</search:queryParam>

	<search:queryParam id="atp.queryParam.atpType">
		<dict:fieldDescriptor parent="childFieldDescriptor">
			<dict:name>Type</dict:name>
			<dict:search key="org.search.atpTypes"/>
		</dict:fieldDescriptor>
	</search:queryParam>

	<search:queryParam id="atp.queryParam.searchDate">
		<dict:fieldDescriptor>
			<dict:name>Date</dict:name>
			<dict:dataType>date</dict:dataType>
		</dict:fieldDescriptor>
	</search:queryParam>

	<dict:fieldDescriptor id="parentFieldDescriptor">
		<dict:name>CLU Identifier</dict:name>
		<dict:desc>Unique identifier for a Canonical Learning Unit (CLU).</dict:desc>
		<dict:dataType>string</dict:dataType>
		<dict:readOnly>true</dict:readOnly>
	</dict:fieldDescriptor>
	
	<dict:fieldDescriptor id="list">
		<dict:name>CLU Identifier</dict:name>
		<dict:desc>Unique identifier for a Canonical Learning Unit (CLU).</dict:desc>
		<dict:dataType>complex</dict:dataType>
		<dict:readOnly>true</dict:readOnly>
	</dict:fieldDescriptor>

	<dict:fieldDescriptor id="childFieldDescriptor"
		parent="parentFieldDescriptor">
		<dict:name>Child CLU Identifier</dict:name>
	</dict:fieldDescriptor>

	<bean id="queryMap" class="org.springframework.beans.factory.config.MapFactoryBean">
		<property name="sourceMap">
			<map>
				<entry key="org.search.atpTypes">
					<value>SELECT atptype.id, atptype.name FROM AtpType atptype</value>
				</entry>
				<entry key="atp.search.atpByShortName">
					<value>SELECT atp.id, atp.name FROM Atp atp WHERE atp.name like :atp_queryParam_atpShortName or atp.id = :atp_queryParam_atpId</value>
				</entry>
				<entry key="atp.search.basicAtpByShortName">
					<value>SELECT
                           atp.id,
                           seasonaltype.name,
                           durtype.name,
                           atptype.name
                           FROM Atp atp
                           JOIN atp.type atptype
                           JOIN atptype.seasonalType seasonaltype
                           JOIN atptype.durationType durtype
                           WHERE atp.name like :atp_queryParam_atpShortName</value>
				</entry>
				<entry key="atp.search.advancedAtpSearch">
					<value>SELECT
					       atp.id,
                           seasonaltype.name,
                           durtype.name,
					       atp.effectiveDate,
					       atptype.name
                           FROM Atp atp
                           JOIN atp.type atptype
                           JOIN atptype.seasonalType seasonaltype
                           JOIN atptype.durationType durtype
                           WHERE 1 = 1
                           and (:atp_queryParam_atpShortName is null or atp.name like :atp_queryParam_atpShortName)
                           and (:atp_queryParam_atpStartDate is null or atp.effectiveDate = :atp_queryParam_atpStartDate)
                           and (:atp_queryParam_atpEndDate is null or atp.expirationDate = :atp_queryParam_atpEndDate)
                           and (:atp_queryParam_atpType is null or atp.type like :atp_queryParam_atpType)</value>
				</entry>
				<entry key="atp.search.atpByDate">
					<value>SELECT
                           atp.id,
                           concat(concat(concat(concat(seasonaltype.name, ' '), durtype.name), ', '), atptype.name)
                           FROM Atp atp
                           JOIN atp.type atptype
                           JOIN atptype.seasonalType seasonaltype
                           JOIN atptype.durationType durtype
                           WHERE
                           :atp_queryParam_searchDate BETWEEN atp.effectiveDate AND atp.expirationDate</value>
				</entry>
			</map>
		</property>
	</bean>

</beans>